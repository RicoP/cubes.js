!function(e,t){function Hs(n,r,i){function N(e){return e.touches?e.touches.length:1}function C(n){n=n||t.event;if(!T){var r=e,i=r.body;return[{x:n.pageX||n.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&r.clientLeft||0),y:n.pageY||n.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&r.clientTop||0)}]}var s=[],o,u=n.touches.length>0?n.touches:n.changedTouches;for(var a=0,f=u.length;a<f;a++)o=u[a],s.push({x:o.pageX,y:o.pageY});return s}function k(e,t){return Math.atan2(t.y-e.y,t.x-e.x)*180/Math.PI}function L(e,t){if(e.length==2&&t.length==2){var n,r;n=e[0].x-e[1].x,r=e[0].y-e[1].y;var i=Math.sqrt(n*n+r*r);n=t[0].x-t[1].x,r=t[0].y-t[1].y;var s=Math.sqrt(n*n+r*r);return s/i}return 0}function A(e,t){if(e.length==2&&t.length==2){var n,r;n=e[0].x-e[1].x,r=e[0].y-e[1].y;var i=Math.atan2(r,n)*180/Math.PI;n=t[0].x-t[1].x,r=t[0].y-t[1].y;var s=Math.atan2(r,n)*180/Math.PI;return s-i}return 0}function O(e,t){t.touches=C(t.originalEvent),t.type=e,j(s["on"+e])&&s["on"+e].call(s,t)}function M(e){e=e||t.event,e.preventDefault?(e.preventDefault(),e.stopPropagation()):(e.returnValue=!1,e.cancelBubble=!0)}function _(){l={},h=!1,c=0,u=0,a=0,p=null}function P(i){switch(i.type){case"mousedown":case"touchstart":l.start=C(i),v=(new Date).getTime(),c=N(i),h=!0,E=i;var s=n.getBoundingClientRect(),o=n.clientTop||e.body.clientTop||0,m=n.clientLeft||e.body.clientLeft||0,g=t.pageYOffset||n.scrollTop||e.body.scrollTop,y=t.pageXOffset||n.scrollLeft||e.body.scrollLeft;b={top:s.top+g-o,left:s.left+y-m},w=!0,D.hold(i),r.prevent_default&&M(i);break;case"mousemove":case"touchmove":if(!w)return!1;S=i,l.move=C(i),D.transform(i)||D.drag(i);break;case"mouseup":case"mouseout":case"touchcancel":case"touchend":if(!w||p!="transform"&&i.touches&&i.touches.length>0)return!1;w=!1,x=i;var T=p=="drag";D.swipe(i),T?O("dragend",{originalEvent:i,direction:f,distance:u,angle:a}):p=="transform"?O("transformend",{originalEvent:i,position:l.center,scale:L(l.start,l.move),rotation:A(l.start,l.move)}):D.tap(E),d=p,O("release",{originalEvent:i,gesture:p}),_()}}function H(e,n){!n&&t.event&&t.event.toElement&&(n=t.event.toElement);if(e===n)return!0;if(n){var r=n.parentNode;while(r!==null){if(r===e)return!0;r=r.parentNode}}return!1}function B(e,t){var n={};if(!t)return e;for(var r in e)r in t?n[r]=t[r]:n[r]=e[r];return n}function j(e){return Object.prototype.toString.call(e)=="[object Function]"}function F(t,n,r){n=n.split(" ");for(var i=0,s=n.length;i<s;i++)t.addEventListener?t.addEventListener(n[i],r,!1):e.attachEvent&&t.attachEvent("on"+n[i],r)}var s=this,o={prevent_default:!1,css_hacks:!0,swipe:!0,swipe_time:200,swipe_min_distance:20,drag:!0,drag_vertical:!0,drag_horizontal:!0,drag_min_distance:20,transform:!0,scale_treshold:.1,rotation_treshold:15,tap:!0,tap_double:!0,tap_max_interval:300,tap_max_distance:10,tap_double_distance:20,hold:!0,hold_timeout:500};r=B(o,r),function(){if(!r.css_hacks)return!1;var e=["webkit","moz","ms","o",""],t={userSelect:"none",touchCallout:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"},i="";for(var s=0;s<e.length;s++)for(var o in t)i=o,e[s]&&(i=e[s]+i.substring(0,1).toUpperCase()+i.substring(1)),n.style[i]=t[o]}();var u=0,a=0,f=0,l={},c=0,h=!1,p=null,d=null,v=null,m={x:0,y:0},g=null,y=null,b={},w=!1,E,S,x,T="ontouchstart"in t;this.option=function(e,t){return t!=i&&(r[e]=t),r[e]},this.getDirectionFromAngle=function(e){var t={down:e>=45&&e<135,left:e>=135||e<=-135,up:e<-45&&e>-135,right:e>=-45&&e<=45},n,r;for(r in t)if(t[r]){n=r;break}return n};var D={hold:function(e){r.hold&&(p="hold",clearTimeout(y),y=setTimeout(function(){p=="hold"&&O("hold",{originalEvent:e,position:l.start})},r.hold_timeout))},swipe:function(e){if(!l.move)return;var t=l.move[0].x-l.start[0].x,n=l.move[0].y-l.start[0].y;u=Math.sqrt(t*t+n*n);var i=(new Date).getTime(),o=i-v;if(r.swipe&&r.swipe_time>o&&u>r.swipe_min_distance){a=k(l.start[0],l.move[0]),f=s.getDirectionFromAngle(a),p="swipe";var c={x:l.move[0].x-b.left,y:l.move[0].y-b.top},h={originalEvent:e,position:c,direction:f,distance:u,distanceX:t,distanceY:n,angle:a};O("swipe",h)}},drag:function(e){var t=l.move[0].x-l.start[0].x,n=l.move[0].y-l.start[0].y;u=Math.sqrt(t*t+n*n);if(r.drag&&u>r.drag_min_distance||p=="drag"){a=k(l.start[0],l.move[0]),f=s.getDirectionFromAngle(a);var i=f=="up"||f=="down";if((i&&!r.drag_vertical||!i&&!r.drag_horizontal)&&u>r.drag_min_distance)return;p="drag";var o={x:l.move[0].x-b.left,y:l.move[0].y-b.top},c={originalEvent:e,position:o,direction:f,distance:u,distanceX:t,distanceY:n,angle:a};h&&(O("dragstart",c),h=!1),O("drag",c),M(e)}},transform:function(e){if(r.transform){if(N(e)!=2)return!1;var t=A(l.start,l.move),n=L(l.start,l.move);if(p!="drag"&&(p=="transform"||Math.abs(1-n)>r.scale_treshold||Math.abs(t)>r.rotation_treshold)){p="transform",l.center={x:(l.move[0].x+l.move[1].x)/2-b.left,y:(l.move[0].y+l.move[1].y)/2-b.top};var i={originalEvent:e,position:l.center,scale:n,rotation:t};return h&&(O("transformstart",i),h=!1),O("transform",i),M(e),!0}}return!1},tap:function(e){var t=(new Date).getTime(),n=t-v;if(r.hold&&!(r.hold&&r.hold_timeout>n))return;var i=function(){if(m&&r.tap_double&&d=="tap"&&v-g<r.tap_max_interval){var e=Math.abs(m[0].x-l.start[0].x),t=Math.abs(m[0].y-l.start[0].y);return m&&l.start&&Math.max(e,t)<r.tap_double_distance}return!1}();if(i)p="double_tap",g=null,O("doubletap",{originalEvent:e,position:l.start}),M(e);else{var s=l.move?Math.abs(l.move[0].x-l.start[0].x):0,o=l.move?Math.abs(l.move[0].y-l.start[0].y):0;u=Math.max(s,o),u<r.tap_max_distance&&(p="tap",g=t,m=l.start,r.tap&&(O("tap",{originalEvent:e,position:l.start}),M(e)))}}};T?F(n,"touchstart touchmove touchend touchcancel",P):(F(n,"mouseup mousedown mousemove",P),F(n,"mouseout",function(e){H(n,e.relatedTarget)||P(e)}))}function Fs(e){var t=new js(16);return e&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t}function Is(e){return e||(e=Fs()),e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function qs(e,t,n){n||(n=e);var r=e[0],i=e[1],s=e[2],o=e[3],u=e[4],a=e[5],f=e[6],l=e[7],c=e[8],h=e[9],p=e[10],d=e[11],v=e[12],m=e[13],g=e[14],y=e[15],b=t[0],w=t[1],E=t[2],S=t[3];return n[0]=b*r+w*u+E*c+S*v,n[1]=b*i+w*a+E*h+S*m,n[2]=b*s+w*f+E*p+S*g,n[3]=b*o+w*l+E*d+S*y,b=t[4],w=t[5],E=t[6],S=t[7],n[4]=b*r+w*u+E*c+S*v,n[5]=b*i+w*a+E*h+S*m,n[6]=b*s+w*f+E*p+S*g,n[7]=b*o+w*l+E*d+S*y,b=t[8],w=t[9],E=t[10],S=t[11],n[8]=b*r+w*u+E*c+S*v,n[9]=b*i+w*a+E*h+S*m,n[10]=b*s+w*f+E*p+S*g,n[11]=b*o+w*l+E*d+S*y,b=t[12],w=t[13],E=t[14],S=t[15],n[12]=b*r+w*u+E*c+S*v,n[13]=b*i+w*a+E*h+S*m,n[14]=b*s+w*f+E*p+S*g,n[15]=b*o+w*l+E*d+S*y,n}function Rs(e,t,n){n||(n=t);var r=t[0],i=t[1],s=t[2];return n[0]=e[0]*r+e[4]*i+e[8]*s+e[12],n[1]=e[1]*r+e[5]*i+e[9]*s+e[13],n[2]=e[2]*r+e[6]*i+e[10]*s+e[14],n}function Us(e,t,n){var r=t[0],i=t[1],s=t[2],o,u,a,f,l,c,h,p,d,v,m,g;return!n||e===n?(e[12]=e[0]*r+e[4]*i+e[8]*s+e[12],e[13]=e[1]*r+e[5]*i+e[9]*s+e[13],e[14]=e[2]*r+e[6]*i+e[10]*s+e[14],e[15]=e[3]*r+e[7]*i+e[11]*s+e[15],e):(o=e[0],u=e[1],a=e[2],f=e[3],l=e[4],c=e[5],h=e[6],p=e[7],d=e[8],v=e[9],m=e[10],g=e[11],n[0]=o,n[1]=u,n[2]=a,n[3]=f,n[4]=l,n[5]=c,n[6]=h,n[7]=p,n[8]=d,n[9]=v,n[10]=m,n[11]=g,n[12]=o*r+l*i+d*s+e[12],n[13]=u*r+c*i+v*s+e[13],n[14]=a*r+h*i+m*s+e[14],n[15]=f*r+p*i+g*s+e[15],n)}function zs(e,t,n,r,i,s,o){o||(o=Fs());var u=t-e,a=r-n,f=s-i;return o[0]=i*2/u,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=i*2/a,o[6]=0,o[7]=0,o[8]=(t+e)/u,o[9]=(r+n)/a,o[10]=-(s+i)/f,o[11]=-1,o[12]=0,o[13]=0,o[14]=-(s*i*2)/f,o[15]=0,o}function Ws(e,t,n,r,i){var s=n*Math.tan(e*Math.PI/360),o=s*t;return zs(-o,o,-s,s,n,r,i)}function Xs(e,t,n,r){r||(r=Fs());var i,s,o,u,a,f,l,c,h,p,d=e[0],v=e[1],m=e[2],g=n[0],y=n[1],b=n[2],w=t[0],E=t[1],S=t[2];return d===w&&v===E&&m===S?Is(r):(l=d-w,c=v-E,h=m-S,p=1/Math.sqrt(l*l+c*c+h*h),l*=p,c*=p,h*=p,i=y*h-b*c,s=b*l-g*h,o=g*c-y*l,p=Math.sqrt(i*i+s*s+o*o),p?(p=1/p,i*=p,s*=p,o*=p):(i=0,s=0,o=0),u=c*o-h*s,a=h*i-l*o,f=l*s-c*i,p=Math.sqrt(u*u+a*a+f*f),p?(p=1/p,u*=p,a*=p,f*=p):(u=0,a=0,f=0),r[0]=i,r[1]=u,r[2]=l,r[3]=0,r[4]=s,r[5]=a,r[6]=c,r[7]=0,r[8]=o,r[9]=f,r[10]=h,r[11]=0,r[12]=-(i*d+s*v+o*m),r[13]=-(u*d+a*v+f*m),r[14]=-(l*d+c*v+h*m),r[15]=1,r)}function Vs(e,t,n){return!n||e===n?(e[0]-=t[0],e[1]-=t[1],e[2]-=t[2],e):(n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n)}function $s(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Js(e){var t=new js(3);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2]):t[0]=t[1]=t[2]=0,t}function Ks(e,t,n){return!n||e===n?(e[0]+=t[0],e[1]+=t[1],e[2]+=t[2],e):(n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n)}function Qs(e,t,n){return!n||e===n?(e[0]*=t,e[1]*=t,e[2]*=t,e):(n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n)}function Gs(e,t){t||(t=e);var n=e[0],r=e[1],i=e[2],s=Math.sqrt(n*n+r*r+i*i);return s?s===1?(t[0]=n,t[1]=r,t[2]=i,t):(s=1/s,t[0]=n*s,t[1]=r*s,t[2]=i*s,t):(t[0]=0,t[1]=0,t[2]=0,t)}function Ys(e,t,n){n||(n=e);var r=e[0],i=e[1],s=e[2],o=t[0],u=t[1],a=t[2];return n[0]=i*a-s*u,n[1]=s*o-r*a,n[2]=r*u-i*o,n}function Zs(e){var t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)}function eo(e,t,n){n||(n=t);var r=t[0],i=t[1],s=t[2],o=e[0],u=e[1],a=e[2],f=e[3],l=f*r+u*s-a*i,c=f*i+a*r-o*s,h=f*s+o*i-u*r,p=-o*r-u*i-a*s;return n[0]=l*f+p*-o+c*-a-h*-u,n[1]=c*f+p*-u+h*-o-l*-a,n[2]=h*f+p*-a+l*-u-c*-o,n}function to(e,t,n){n||(n=new js(4));var r=e*.5,i=Math.sin(r);return n[3]=Math.cos(r),n[0]=i*t[0],n[1]=i*t[1],n[2]=i*t[2],n}function ro(e){"use strict";var t=65535,n=new Uint32Array(4096),r=362436,i=2654435769;n[0]=e,n[1]=e+i,n[2]=e+i+i;for(var s=3;s<4096;s++)n[s]=n[s-3]^n[s-2]^i^s;var o=4095;this.next=function(){var e,i=18782,s,u=4294967294;o=o+1&4095,e=i*n[o]+r,r=e>>32,s=e+r,s<r&&(s++,r++);var a=n[o]=u-s;return a<0?-a%t:a%t}}function Vo(){var e=Lo;Ks(No,To,e),Xs(e,No,Co,ko)}function $o(e){var t=to(e,Co);eo(t,To),Vo()}function Jo(e){var t=Lo,n=Gs(Ys(Co,To,t)),r=to(e,n);eo(r,To),Gs(Ys(To,n,Co)),Vo()}function Ko(){So.enable(rt),So.enable(Z),So.lineWidth(4.5),So.clearColor(0,0,0,0),So.viewport(0,0,Eo.width,Eo.height),vo=So.createBuffer(),So.bindBuffer(I,vo),So.bufferData(I,oo.rawData,W),mo=So.createBuffer(),So.bindBuffer(I,mo),So.bufferData(I,uo.rawData,W),go=So.createBuffer(),So.bindBuffer(I,go),So.bufferData(I,fo.rawData,W),co=So.createBuffer(),So.bindBuffer(I,co),So.bufferData(I,lo.rawData,W);var e=new Float32Array(3*bo.path.length),t=0;e[t++]=bo.startingPosition.x,e[t++]=bo.startingPosition.y,e[t++]=bo.startingPosition.z;for(var n=0;n!==bo.path.length;n++)e[t++]=bo.path[n].x,e[t++]=bo.path[n].y,e[t++]=bo.path[n].z;pathBuffer=So.createBuffer(),So.bindBuffer(I,pathBuffer),So.bufferData(I,e,W);var r=new Hs(Eo);r.ontap=function(e){Ro=!0,Uo=e;var t=e.position[0].x,n=Eo.height-e.position[0].y;Xo.x=t,Xo.y=n},r.ondrag=function(e){zo=!0,Wo=e;var t=e.position.x,n=Eo.height-e.position.y;Xo.x=t,Xo.y=n}}function Qo(e){Yo(e),Zo(e),Ps.requestGameFrame(Qo)}function Yo(e){var t=0,n=0,r=0,i=0,s=0,o=0,u=!1,a=!1;if(Ro){var f=Go(To);ao.tap(e,f)}if(zo){var l=Wo.distanceX*2*Math.PI/Eo.width/-20,c=Wo.distanceY*2*Math.PI/Eo.height/20;$o(l),Jo(c)}Ro=!1,zo=!1,ao.tick(e)}function Zo(e){So.disable(rt),ru(ho),So.enable(rt),So.clear(r),eu(ho),tu(ho),nu(ho),iu(po,bo.path)}function eu(e){So.useProgram(e);var t=So.getUniformLocation(e,"uModelviewprojection"),n=So.getUniformLocation(e,"uTexture"),r=So.getAttribLocation(e,"aVertex"),i=So.getAttribLocation(e,"aTextureuv"),s=So.getAttribLocation(e,"aNormal"),o=Lo;So.bindBuffer(I,vo),So.vertexAttribPointer(r,4,wn,!1,oo.stride,oo.voffset),So.enableVertexAttribArray(r),i!==-1&&(So.vertexAttribPointer(i,4,wn,!1,oo.stride,oo.toffset),So.enableVertexAttribArray(i)),s!==-1&&(So.vertexAttribPointer(s,4,wn,!1,oo.stride,oo.noffset),So.enableVertexAttribArray(s)),n&&(So.bindTexture(Y,Ao),So.uniform1i(n,0));for(var u=0;u!=Io.length;u++){var a=Io[u];qs(xo,ko,o),Us(o,a.vector),So.uniformMatrix4fv(t,!1,o),So.drawArrays(l,0,oo.numVertices)}}function tu(e){So.useProgram(e);var t=So.getUniformLocation(e,"uModelviewprojection"),n=So.getUniformLocation(e,"uTexture"),r=So.getAttribLocation(e,"aVertex"),i=So.getAttribLocation(e,"aTextureuv"),s=Lo;So.bindBuffer(I,mo),So.vertexAttribPointer(r,4,wn,!1,uo.stride,uo.voffset),So.enableVertexAttribArray(r),i!==-1&&(So.vertexAttribPointer(i,4,wn,!1,uo.stride,uo.toffset),So.enableVertexAttribArray(i)),n&&(So.bindTexture(Y,Ao),So.uniform1i(n,0)),qs(xo,ko,s),Us(s,ao.position),So.uniformMatrix4fv(t,!1,s),So.drawArrays(l,0,uo.numVertices)}function nu(e){So.useProgram(e);var t=So.getUniformLocation(e,"uModelviewprojection"),n=So.getUniformLocation(e,"uTexture"),r=So.getAttribLocation(e,"aVertex"),i=So.getAttribLocation(e,"aTextureuv"),s=Lo;So.bindBuffer(I,co),So.vertexAttribPointer(r,4,wn,!1,lo.stride,lo.voffset),So.enableVertexAttribArray(r),i!==-1&&(So.vertexAttribPointer(i,4,wn,!1,lo.stride,lo.toffset),So.enableVertexAttribArray(i)),n&&(So.bindTexture(Y,Ao),So.uniform1i(n,0)),qs(xo,ko,s),Us(s,qo),So.uniformMatrix4fv(t,!1,s),So.drawArrays(l,0,lo.numVertices)}function ru(e){So.useProgram(e);var t=So.getUniformLocation(e,"uModelviewprojection"),n=So.getUniformLocation(e,"uTexture"),r=So.getAttribLocation(e,"aVertex"),i=So.getAttribLocation(e,"aTextureuv"),s=Lo;So.bindBuffer(I,go),So.vertexAttribPointer(r,4,wn,!1,fo.stride,fo.voffset),So.enableVertexAttribArray(r),So.vertexAttribPointer(i,4,wn,!1,fo.stride,fo.toffset),So.enableVertexAttribArray(i),So.bindTexture(Y,Oo),So.uniform1i(n,0),qs(xo,ko,s),Us(s,No),Us(s,To),So.uniformMatrix4fv(t,!1,s),So.drawArrays(l,0,fo.numVertices)}function iu(e,t){So.useProgram(e);var n=So.getAttribLocation(e,"aVertex"),r=So.getUniformLocation(e,"uModelviewprojection"),i=Lo;So.bindBuffer(I,pathBuffer),So.vertexAttribPointer(n,3,wn,!1,0,0),So.enableVertexAttribArray(n),qs(xo,ko,i),So.uniformMatrix4fv(r,!1,i);for(var s=0;s!==bo.path.length-1;s++)So.drawArrays(u,s,2)}function su(e,t){So.bindTexture(So.TEXTURE_2D,t),So.pixelStorei(So.UNPACK_FLIP_Y_WEBGL,!0),So.texImage2D(So.TEXTURE_2D,0,So.RGBA,So.RGBA,So.UNSIGNED_BYTE,e),So.texParameteri(So.TEXTURE_2D,So.TEXTURE_MAG_FILTER,So.NEAREST),So.texParameteri(So.TEXTURE_2D,So.TEXTURE_MIN_FILTER,So.NEAREST)}function ou(e){var t=So.createTexture();return su(e,t),So.bindTexture(Y,null),t}var r=256,i=1024,s=16384,o=0,u=1,a=2,f=3,l=4,c=5,h=6,p=0,d=1,v=768,m=769,g=770,y=771,b=772,w=773,E=774,S=775,x=776,T=32774,N=32777,C=32777,k=34877,L=32778,A=32779,O=32968,M=32969,_=32970,D=32971,P=32769,H=32770,B=32771,j=32772,F=32773,I=34962,q=34963,R=34964,U=34965,z=35040,W=35044,X=35048,V=34660,$=34661,J=34342,K=1028,Q=1029,G=1032,Y=3553,Z=2884,et=3042,tt=3024,nt=2960,rt=2929,it=3089,st=32823,ot=32926,ut=32928,at=0,ft=1280,lt=1281,ct=1282,ht=1285,pt=2304,dt=2305,vt=2849,mt=33901,gt=33902,yt=2885,bt=2886,wt=2928,Et=2930,St=2931,xt=2932,Tt=2961,Nt=2962,Ct=2964,kt=2965,Lt=2966,At=2967,Ot=2963,Mt=2968,_t=34816,Dt=34817,Pt=34818,Ht=34819,Bt=36003,jt=36004,Ft=36005,It=2978,qt=3088,Rt=3106,Ut=3107,zt=3317,Wt=3333,Xt=3379,Vt=3386,$t=3408,Jt=3410,Kt=3411,Qt=3412,Gt=3413,Yt=3414,Zt=3415,en=10752,tn=32824,nn=32873,rn=32936,sn=32937,on=32938,un=32939,an=34466,fn=34467,ln=4352,cn=4353,hn=4354,pn=33170,dn=5120,vn=5121,mn=5122,gn=5123,yn=5124,bn=5125,wn=5126,En=6402,Sn=6406,xn=6407,Tn=6408,Nn=6409,Cn=6410,kn=32819,Ln=32820,An=33635,On=35632,Mn=35633,_n=34921,Dn=36347,Pn=36348,Hn=35661,Bn=35660,jn=34930,Fn=36349,In=35663,qn=35712,Rn=35714,Un=35715,zn=35717,Wn=35718,Xn=35719,Vn=35721,$n=35722,Jn=35724,Kn=35725,Qn=512,Gn=513,Yn=514,Zn=515,er=516,tr=517,nr=518,rr=519,ir=7680,sr=7681,or=7682,ur=7683,ar=5386,fr=34055,lr=34056,cr=7936,hr=7937,pr=7938,dr=9728,vr=9729,mr=9984,gr=9985,yr=9986,br=9987,wr=10240,Er=10241,Sr=10242,xr=10243,Tr=5890,Nr=34067,Cr=34068,kr=34069,Lr=34070,Ar=34071,Or=34072,Mr=34073,_r=34074,Dr=34076,Pr=33984,Hr=33985,Br=33986,jr=33987,Fr=33988,Ir=33989,qr=33990,Rr=33991,Ur=33992,zr=33993,Wr=33994,Xr=33995,Vr=33996,$r=33997,Jr=33998,Kr=33999,Qr=34e3,Gr=34001,Yr=34002,Zr=34003,ei=34004,ti=34005,ni=34006,ri=34007,ii=34008,si=34009,oi=34010,ui=34011,ai=34012,fi=34013,li=34014,ci=34015,hi=34016,pi=10497,di=33071,vi=33648,mi=35664,gi=35665,yi=35666,bi=35667,wi=35668,Ei=35669,Si=35670,xi=35671,Ti=35672,Ni=35673,Ci=35674,ki=35675,Li=35676,Ai=35678,Oi=35680,Mi=34338,_i=34339,Di=34340,Pi=34341,Hi=34922,Bi=34373,ji=34975,Fi=35713,Ii=35716,qi=35720,Ri=36336,Ui=36337,zi=36338,Wi=36339,Xi=36340,Vi=36341,$i=36160,Ji=36161,Ki=32854,Qi=32855,Gi=36194,Yi=33189,Zi=6401,es=36168,ts=34041,ns=36162,rs=36163,is=36164,ss=36176,os=36177,us=36178,as=36179,fs=36180,ls=36181,cs=36048,hs=36049,ps=36050,ds=36051,vs=36064,ms=36096,gs=36128,ys=33306,bs=0,ws=36053,Es=36054,Ss=36055,xs=36057,Ts=36061,Ns=36006,Cs=36007,ks=34024,Ls=1286,As=37440,Os=37441,Ms=37442,_s=37443,Ds=37444,Ps={};(function(e){"use strict";function n(e){var n,r,i;for(n=0;r=t[n++];){i=e.getContext(r,{alpha:!1,preserveDrawingBuffer:!0});if(i)return i}return null}var t=["experimental-webgl","webgl","moz-webgl","webkit-3d"];e.createContext=n})(Ps),function(n){"use strict";function o(){for(var e=0;e!==r;e++)s[e]=0,i[e]=0}function u(){for(var e=0;e!==r;e++)s[e]=i[e]}function a(e){return i[e]!==0}function f(e){return i[e]===0}function l(e){return i[e]!==0&&s[e]===0}function c(e){return i[e]===0&&s[e]!==0}var r=256,i=new Uint8Array(r),s=new Uint8Array(r);o(),e.addEventListener("keydown",function(e){var t=e.keyCode;t<r&&(i[t]=1)},!1),e.addEventListener("keyup",function(e){var t=e.keyCode;t<r&&(i[t]=0)},!1),t.addEventListener("blur",function(){o()},!1);var h={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,capslock:20,escape:27,space:32,pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,"delete":46,num0:48,num1:49,num2:50,num3:51,num4:52,num5:53,num6:54,num7:55,num8:56,num9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,windowKeyLeft:91,windowKeyRight:92,select:93,numpad0:96,numpad1:97,numpad2:98,numpad3:99,numpad4:100,numpad5:101,numpad6:102,numpad7:103,numpad8:104,numpad9:105,multiply:106,add:107,subtract:109,decimalPoint:110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numlock:144,scrolllock:145,semicolon:186,equals:187,comma:188,dash:189,period:190,slash:191,graveAccent:192,openBracket:219,backSlash:220,closeBraket:221,quote:222};n.keys={codes:h,update:u,isDown:a,isUp:f,wasPressed:l,wasReleased:c}}(Ps),function(e){"use strict";function u(){i=-1,o.total=0,o.frame=0}function a(t){function n(){var n=Date.now();i===-1&&(s=n,i=n,o.frame=0);var r=(n-s)/1e3;o.delta=r,o.total+=r,t(o),o.frame++,s=n,e.keys.update()}r(n)}var n,r,i,s,o;n=t,r=n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame||n.oRequestAnimationFrame||n.msRequestAnimationFrame||function(e){n.setTimeout(e,16)},i=-1,s=0,o={total:0,delta:0,frame:0,reset:u},e.requestGameFrame=a}(Ps),function(e){"use strict";function u(e){var u=e.split("\n"),a="",f=0,l=[],c=[],h=[],p=[],d=[],v=[],m=0,g={v:function(e){if(!e||e.length!=3)throw new Error("Can't accept Vertic without 3 components. LINE:"+a);var t=Number(e[0]),n=Number(e[1]),r=Number(e[2]);l.push(t,n,r)},vn:function(e){if(!e||e.length!=3)throw new Error("Can't accept Normal without 3 components. LINE:"+f);var t=Number(e[0]),n=Number(e[1]),r=Number(e[2]);c.push(t,n,r)},vt:function(e){if(!e||e.length<2)throw new Error("Can't accept Texture with less than 2 components. LINE:"+f);var t=Number(e[0]),n=Number(e[1]);h.push(t,n)},f:function D(e){if(!e||e.length<3)throw new Error("Can't accept Face with less than 3 components. LINE:"+f);if(e.length>3){for(var t=e.length-1;t!==1;t--)D([e[0],e[t-1],e[t]]);return}m++;for(var n=0;n!==3;n++){var r=e[n].split("/"),i=parseInt(r[0],10)-1,s=parseInt(r[1],10)-1,t=parseInt(r[2],10)-1;p.push(i),isNaN(s)||v.push(s),isNaN(t)||d.push(t)}}};for(f=0;f!=u.length;){a=u[f++].trim();var y=a.split(o),b=y.shift();b in g&&g[b](y)}var w=t;if(h.length!==0||v.length!==0){w|=r;if(p.length!==v.length)throw new Error("Texture indice don't match Vertic indice.")}if(c.length!==0||d.length!==0){w|=n;if(p.length!==d.length)throw new Error("Normal indice don't match Vertic indice.")}var E=0,S=0,x=0,T=0,N=0,C=0;switch(w){case t:N=4;break;case r:N=6,x=4*s;break;case n:N=8,T=4*s;break;case i:N=10,x=4*s,T=6*s;break;default:throw new Error("Schema broken.")}E=m*3*N;var k=new Float32Array(E),L=0,A=0,O=0,M=0;for(var _=0;_!=p.length;_++)A=3*p[_],k[L++]=l[A++],k[L++]=l[A++],k[L++]=l[A],k[L++]=1,w&r&&(O=2*v[_],k[L++]=h[O++],k[L++]=h[O]),w&n&&(M=3*d[_],k[L++]=c[M++],k[L++]=c[M++],k[L++]=c[M],k[L++]=0);return{stride:N*s,schema:w,voffset:S,toffset:x,noffset:T,rawData:k,numVertices:m*3}}var t=0,n=1,r=2,i=n|r,s=4,o=/[\t\r\n ]+/g;e.obj={},e.obj.parse=u,e.obj.SCHEMA_V=t,e.obj.SCHEMA_VN=n,e.obj.SCHEMA_VT=r,e.obj.SCHEMA_VTN=n|r}(Ps),function(e){"use strict";function t(e){return e=e.toLowerCase(),e==="application/json"?2:e==="text/html"?7:e.indexOf("javascript")!==-1?3:e.indexOf("xml")!==-1?4:e.indexOf("image")!==-1?5:1}function n(n,r,i,s){function o(){if(a)return;if(f.readyState===2||f.readyState===3){u=t(f.getResponseHeader("content-type")),r.toLowerCase().lastIndexOf(".json")+5===r.length?u=2:r.toLowerCase().lastIndexOf(".obj")+4===r.length&&(u=6);if(u===5){a=!0,f.abort();var o=new Image;o.onload=function(){i(n,o)},o.onerror=function(){s(r,"Loading image failed.")},o.src=r;return}}if(f.readyState===4){var l=f.status;if(l>=200&&l<=299||l===304||l===0)if(u===4)i(n,f.responseXML);else if(u===2)try{i(n,JSON.parse(f.responseText))}catch(c){s(r,c)}else if(u===6)try{i(n,e.obj.parse(f.responseText))}catch(c){s(r,c)}else i(n,f.responseText);else s(r,l||0)}}var u=0,a=!1,f=new XMLHttpRequest;f.onreadystatechange=o,f.open("GET",r,!0),f.send(null)}function r(){}function i(e){if(!e)throw new Error("Passed nothing in loadFiles");var t=e.files||{},i=e.update||r,s=e.finished||r,o=e.error||r,u=0,a=0,f=Object.create(null),l=function(e,t){a++,f[e]=t,i(e,a/u),a===u&&s(f)},c=function(e,t){l=r,c=r,o(e,t)};if(t instanceof Array){u=t.length;for(var h=0,p;p=t[h++];)n(p,p,l,c)}else{var d=Object.keys(t);u=d.length;for(var h=0,v;v=d[h++];)t.hasOwnProperty(v)&&n(v,t[v],l,c)}}e.loadmanager={},e.loadmanager.loadFiles=i}(Ps),function(e){"use strict";function t(e,t){var n=["#define VERTEX\n","#define FRAGMENT\n"],r="#line 0\n",i=[e.createShader(e.VERTEX_SHADER),e.createShader(e.FRAGMENT_SHADER)],s=e.createProgram(),o=null,u="";for(var a=0;a!=n.length;a++){o=i[a],e.shaderSource(o,n[a]+r+t),e.compileShader(o);if(u=e.getShaderInfoLog(o))throw new Error(u);e.attachShader(s,o)}return e.linkProgram(s),(u=e.getProgramInfoLog(s))&&console.error(u),s}e.shader={},e.shader.compileProgram=t}(Ps);var Bs=function(){function t(){return e}function h(e){e=e||{};for(var t in c)e.hasOwnProperty(t)?this[t]=e[t]:this[t]=c[t]}function p(e){return e*e}function d(e){return e*e*e}function v(e){return e<0?-1:1}function m(e,t){return Math.log(e)/Math.log(t)}function y(){this.oldParams=!0,this.wave_type=s,this.p_env_attack=0,this.p_env_sustain=.3,this.p_env_punch=0,this.p_env_decay=.4,this.p_base_freq=.3,this.p_freq_limit=0,this.p_freq_ramp=0,this.p_freq_dramp=0,this.p_vib_strength=0,this.p_vib_speed=0,this.p_arp_mod=0,this.p_arp_speed=0,this.p_duty=0,this.p_duty_ramp=0,this.p_repeat_speed=0,this.p_pha_offset=0,this.p_pha_ramp=0,this.p_lpf_freq=1,this.p_lpf_ramp=0,this.p_lpf_resonance=0,this.p_hpf_freq=0,this.p_hpf_ramp=0,this.sound_vol=.5,this.sample_rate=44100,this.sample_size=8}function b(e){return Math.random()*e}function w(e,t){return Math.random()*(t-e)+e}function E(e){return Math.floor(Math.random()*(e+1))}function S(e){e.oldParams?this.initFromUI(e):this.init(e)}var e={},r={chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encLookup:[],Init:function(){for(var e=0;e<4096;e++)this.encLookup[e]=this.chars[e>>6]+this.chars[e&63]},Encode:function(e){var t=e.length,r="",i=0;while(t>2)n=e[i]<<16|e[i+1]<<8|e[i+2],r+=this.encLookup[n>>12]+this.encLookup[n&4095],t-=3,i+=3;if(t>0){var s=(e[i]&252)>>2,o=(e[i]&3)<<4;t>1&&(o|=(e[++i]&240)>>4),r+=this.chars[s],r+=this.chars[o];if(t==2){var u=(e[i++]&15)<<2;u|=(e[i]&192)>>6,r+=this.chars[u]}t==1&&(r+="="),r+="="}return r}};r.Init();var i=function(e){function t(e){return[e&255,e>>8&255,e>>16&255,e>>24&255]}function n(e){return[e&255,e>>8&255]}this.data=[],this.wav=[],this.dataURI="",this.header={chunkId:[82,73,70,70],chunkSize:0,format:[87,65,86,69],subChunk1Id:[102,109,116,32],subChunk1Size:16,audioFormat:1,numChannels:1,sampleRate:8e3,byteRate:0,blockAlign:0,bitsPerSample:8,subChunk2Id:[100,97,116,97],subChunk2Size:0},this.Make=function(e){e instanceof Array&&(this.data=e),this.header.byteRate=this.header.sampleRate*this.header.numChannels*this.header.bitsPerSample>>3,this.header.blockAlign=this.header.numChannels*this.header.bitsPerSample>>3,this.header.subChunk2Size=this.data.length,this.header.chunkSize=36+this.header.subChunk2Size,this.wav=this.header.chunkId.concat(t(this.header.chunkSize),this.header.format,this.header.subChunk1Id,t(this.header.subChunk1Size),n(this.header.audioFormat),n(this.header.numChannels),t(this.header.sampleRate),t(this.header.byteRate),n(this.header.blockAlign),n(this.header.bitsPerSample),this.header.subChunk2Id,t(this.header.subChunk2Size),this.data),this.dataURI="data:audio/wav;base64,"+r.Encode(this.wav)},e instanceof Array&&this.Make(e)};typeof e!="undefined"&&(e.RIFFWAVE=i);var s=0,o=1,u=2,a=3,f=1,l=8,c={shape:s,attack:0,sustain:.2,punch:0,decay:.2,frequency:1e3,frequencyMin:0,frequencySlide:0,frequencySlideSlide:0,vibratoDepth:0,vibratoRate:10,arpeggioFactor:1,arpeggioDelay:.1,dutyCycle:.5,dutyCycleSweep:0,retriggerRate:0,flangerOffset:0,flangerSweep:0,lowPassFrequency:44100,lowPassSweep:1,lowPassResonance:.5,highPassFrequency:0,highPassSweep:0,gain:-10,sampleRate:44100,sampleSize:8},g=Math.pow;h.prototype.translate=function(e){function t(e){return e/(1-e)}return this.shape=e.wave_type,this.attack=p(e.p_env_attack)*1e5/44100,this.sustain=p(e.p_env_sustain)*1e5/44100,this.punch=e.p_env_punch,this.decay=p(e.p_env_decay)*1e5/44100,this.frequency=l*441*(p(e.p_base_freq)+.001),e.p_freq_limit>0?this.frequencyMin=l*441*(p(e.p_freq_limit)+.001):this.frequencyMin=0,this.enableFrequencyCutoff=e.p_freq_limit>0,this.frequencySlide=44100*m(1-d(e.p_freq_ramp)/100,.5),this.frequencySlideSlide=-d(e.p_freq_dramp)/1e6*44100*g(2,44101/44100),this.vibratoRate=6890.625*p(e.p_vib_speed)/100,this.vibratoDepth=e.p_vib_strength/2,this.arpeggioFactor=1/(e.p_arp_mod>=0?1-p(e.p_arp_mod)*.9:1+p(e.p_arp_mod)*10),this.arpeggioDelay=e.p_arp_speed===1?0:Math.floor(p(1-e.p_arp_speed)*2e4+32)/44100,this.dutyCycle=(1-e.p_duty)/2,this.dutyCycleSweep=l*44100*-e.p_duty_ramp/2e4,this.retriggerRate=44100/(e.p_repeat_speed===0?0:Math.floor(p(1-e.p_repeat_speed)*2e4)+32),this.flangerOffset=v(e.p_pha_offset)*p(e.p_pha_offset)*1020/44100,this.flangerSweep=v(e.p_pha_ramp)*p(e.p_pha_ramp),this.enableLowPassFilter=e.p_lpf_freq!=1,this.lowPassFrequency=e.p_lpf_freq===1?44100:Math.round(l*44100*t(d(e.p_lpf_freq)/10)),this.lowPassSweep=g(1+e.p_lpf_ramp/1e4,44100),this.lowPassResonance=1-5/(1+p(e.p_lpf_resonance)*20)/9,this.highPassFrequency=Math.round(l*44100*t(p(e.p_hpf_freq)/10)),this.highPassSweep=g(1+e.p_hpf_ramp*3e-4,44100),this.gain=10*m(p(Math.exp(e.sound_vol)-1),10),this.sampleRate=e.sample_rate,this.sampleSize=e.sample_size,this},y.prototype.pickupCoin=function(){return this.p_base_freq=.4+b(.5),this.p_env_attack=0,this.p_env_sustain=b(.1),this.p_env_decay=.1+b(.4),this.p_env_punch=.3+b(.3),E(1)&&(this.p_arp_speed=.5+b(.2),this.p_arp_mod=.2+b(.4)),this},h.prototype.pickupCoin=function(){return this.frequency=w(568,2861),this.attack=0,this.sustain=b(.227),this.decay=w(.227,.567),this.punch=w(.3,.6),E(1)&&(this.arpeggioFactor=w(1.037,1.479),this.arpeggioDelay=w(.042,.114)),this},y.prototype.laserShoot=function(){return this.wave_type=E(2),this.wave_type===u&&E(1)&&(this.wave_type=E(1)),E(2)===0?(this.p_base_freq=.3+b(.6),this.p_freq_limit=b(.1),this.p_freq_ramp=-0.35-b(.3)):(this.p_base_freq=.5+b(.5),this.p_freq_limit=this.p_base_freq-.2-b(.6),this.p_freq_limit<.2&&(this.p_freq_limit=.2),this.p_freq_ramp=-0.15-b(.2)),this.wave_type===o&&(this.p_duty=1),E(1)?(this.p_duty=b(.5),this.p_duty_ramp=b(.2)):(this.p_duty=.4+b(.5),this.p_duty_ramp=-b(.7)),this.p_env_attack=0,this.p_env_sustain=.1+b(.2),this.p_env_decay=b(.4),E(1)&&(this.p_env_punch=b(.3)),E(2)===0&&(this.p_pha_offset=b(.2),this.p_pha_ramp=-b(.2)),this.p_hpf_freq=b(.3),this},h.prototype.laserShoot=function(){return this.shape=E(2),this.shape===u&&E(1)&&(this.shape=E(1)),E(2)===0?(this.frequency=w(321,2861),this.frequencyMin=b(38.8),this.frequencySlide=w(-27.3,-174.5)):(this.frequency=w(321,3532),this.frequencyMin=w(144,2/3*this.frequency),this.frequencySlide=w(-2.15,-27.27)),this.shape===o&&(this.dutyCycle=0),E(1)?(this.dutyCycle=w(.25,.5),this.dutyCycleSweep=w(0,-3.528)):(this.dutyCycle=w(.05,.3),this.dutyCycleSweep=b(12.35)),this.attack=0,this.sustain=w(.02,.2),this.decay=b(.36),E(1)&&(this.punch=b(.3)),E(2)===0&&(this.flangerOffset=b(.001),this.flangerSweep=-b(.04)),E(1)&&(this.highPassFrequency=b(3204)),this},y.prototype.explosion=function(){return this.wave_type=a,E(1)?(this.p_base_freq=p(.1+b(.4)),this.p_freq_ramp=-0.1+b(.4)):(this.p_base_freq=p(.2+b(.7)),this.p_freq_ramp=-0.2-b(.2)),E(4)===0&&(this.p_freq_ramp=0),E(2)===0&&(this.p_repeat_speed=.3+b(.5)),this.p_env_attack=0,this.p_env_sustain=.1+b(.3),this.p_env_decay=b(.5),E(1)&&(this.p_pha_offset=-0.3+b(.9),this.p_pha_ramp=-b(.3)),this.p_env_punch=.2+b(.6),E(1)&&(this.p_vib_strength=b(.7),this.p_vib_speed=b(.6)),E(2)===0&&(this.p_arp_speed=.6+b(.3),this.p_arp_mod=.8-b(1.6)),this},h.prototype.explosion=function(){return this.shape=a,E(1)?(this.frequency=w(4,224),this.frequencySlide=w(-0.623,17.2)):(this.frequency=w(9,2318),this.frequencySlide=w(-5.1,-40.7)),E(4)===0&&(this.frequencySlide=0),E(2)===0&&(this.retriggerRate=w(4.5,53)),this.attack=0,this.sustain=w(.0227,.363),this.decay=b(.567),E(1)&&(this.flangerOffset=w(-0.0021,.0083),this.flangerSweep=-b(.09)),this.punch=.2+b(.6),E(1)&&(this.vibratoDepth=b(.35),this.vibratoRate=b(24.8)),E(2)===0&&(this.arpeggioFactor=w(.135,2.358),this.arpeggioDelay=w(.00526,.0733)),this},y.prototype.powerUp=function(){return E(1)?(this.wave_type=o,this.p_duty=1):this.p_duty=b(.6),this.p_base_freq=.2+b(.3),E(1)?(this.p_freq_ramp=.1+b(.4),this.p_repeat_speed=.4+b(.4)):(this.p_freq_ramp=.05+b(.2),E(1)&&(this.p_vib_strength=b(.7),this.p_vib_speed=b(.6))),this.p_env_attack=0,this.p_env_sustain=b(.4),this.p_env_decay=.1+b(.4),this},h.prototype.powerUp=function(){return E(1)?(this.shape=o,this.dutyCycle=0):this.dutyCycle=w(.2,.5),this.frequency=w(145,886),E(1)?(this.frequencySlide=w(.636,79.6),this.retriggerRate=w(6,53)):(this.frequencySlide=w(.0795,9.94),E(1)&&(this.vibratoDepth=b(.35),this.vibratoRate=b(24.8))),this.attack=0,this.sustain=b(.363),this.decay=w(.023,.57),this},y.prototype.hitHurt=function(){return this.wave_type=E(2),this.wave_type===u&&(this.wave_type=a),this.wave_type===s&&(this.p_duty=b(.6)),this.wave_type===o&&(this.p_duty=1),this.p_base_freq=.2+b(.6),this.p_freq_ramp=-0.3-b(.4),this.p_env_attack=0,this.p_env_sustain=b(.1),this.p_env_decay=.1+b(.2),E(1)&&(this.p_hpf_freq=b(.3)),this},h.prototype.hitHurt=function(){return this.shape=E(2),this.shape===u&&(this.shape=a),this.shape===s&&(this.dutyCycle=w(.2,.5)),this.shape===o&&(this.dutyCycle=0),this.frequency=w(145,2261),this.frequencySlide=w(-17.2,-217.9),this.attack=0,this.sustain=b(.023),this.decay=w(.023,.2),E(1)&&(this.highPassFrequency=b(3204)),this},y.prototype.jump=function(){return this.wave_type=s,this.p_duty=b(.6),this.p_base_freq=.3+b(.3),this.p_freq_ramp=.1+b(.2),this.p_env_attack=0,this.p_env_sustain=.1+b(.3),this.p_env_decay=.1+b(.2),E(1)&&(this.p_hpf_freq=b(.3)),E(1)&&(this.p_lpf_freq=1-b(.6)),this},h.prototype.jump=function(){return this.shape=s,this.dutyCycle=w(.2,.5),this.frequency=w(321,1274),this.frequencySlide=w(.64,17.2),this.attack=0,this.sustain=w(.023,.36),this.decay=w(.023,.2),E(1)&&(this.highPassFrequency=b(3204)),E(1)&&(this.lowPassFrequency=w(2272,44100)),this},y.prototype.blipSelect=function(){return this.wave_type=E(1),this.wave_type===s?this.p_duty=b(.6):this.p_duty=1,this.p_base_freq=.2+b(.4),this.p_env_attack=0,this.p_env_sustain=.1+b(.1),this.p_env_decay=b(.2),this.p_hpf_freq=.1,this},h.prototype.blipSelect=function(){return this.shape=E(1),this.shape===s?this.dutyCycle=w(.2,.5):this.dutyCycle=0,this.frequency=w(145,1274),this.attack=0,this.sustain=w(.023,.09),this.decay=b(.09),this.highPassFrequency=353,this},y.prototype.mutate=function(){E(1)&&(this.p_base_freq+=b(.1)-.05),E(1)&&(this.p_freq_ramp+=b(.1)-.05),E(1)&&(this.p_freq_dramp+=b(.1)-.05),E(1)&&(this.p_duty+=b(.1)-.05),E(1)&&(this.p_duty_ramp+=
b(.1)-.05),E(1)&&(this.p_vib_strength+=b(.1)-.05),E(1)&&(this.p_vib_speed+=b(.1)-.05),E(1)&&(this.p_vib_delay+=b(.1)-.05),E(1)&&(this.p_env_attack+=b(.1)-.05),E(1)&&(this.p_env_sustain+=b(.1)-.05),E(1)&&(this.p_env_decay+=b(.1)-.05),E(1)&&(this.p_env_punch+=b(.1)-.05),E(1)&&(this.p_lpf_resonance+=b(.1)-.05),E(1)&&(this.p_lpf_freq+=b(.1)-.05),E(1)&&(this.p_lpf_ramp+=b(.1)-.05),E(1)&&(this.p_hpf_freq+=b(.1)-.05),E(1)&&(this.p_hpf_ramp+=b(.1)-.05),E(1)&&(this.p_pha_offset+=b(.1)-.05),E(1)&&(this.p_pha_ramp+=b(.1)-.05),E(1)&&(this.p_repeat_speed+=b(.1)-.05),E(1)&&(this.p_arp_speed+=b(.1)-.05),E(1)&&(this.p_arp_mod+=b(.1)-.05)},y.prototype.random=function(){return E(1)?this.p_base_freq=d(b(2)-1)+.5:this.p_base_freq=p(b(1)),this.p_freq_limit=0,this.p_freq_ramp=Math.pow(b(2)-1,5),this.p_base_freq>.7&&this.p_freq_ramp>.2&&(this.p_freq_ramp=-this.p_freq_ramp),this.p_base_freq<.2&&this.p_freq_ramp<-0.05&&(this.p_freq_ramp=-this.p_freq_ramp),this.p_freq_dramp=Math.pow(b(2)-1,3),this.p_duty=b(2)-1,this.p_duty_ramp=Math.pow(b(2)-1,3),this.p_vib_strength=Math.pow(b(2)-1,3),this.p_vib_speed=w(-1,1),this.p_env_attack=d(w(-1,1)),this.p_env_sustain=p(w(-1,1)),this.p_env_decay=w(-1,1),this.p_env_punch=Math.pow(b(.8),2),this.p_env_attack+this.p_env_sustain+this.p_env_decay<.2&&(this.p_env_sustain+=.2+b(.3),this.p_env_decay+=.2+b(.3)),this.p_lpf_resonance=w(-1,1),this.p_lpf_freq=1-Math.pow(b(1),3),this.p_lpf_ramp=Math.pow(b(2)-1,3),this.p_lpf_freq<.1&&this.p_lpf_ramp<-0.05&&(this.p_lpf_ramp=-this.p_lpf_ramp),this.p_hpf_freq=Math.pow(b(1),5),this.p_hpf_ramp=Math.pow(b(2)-1,5),this.p_pha_offset=Math.pow(b(2)-1,3),this.p_pha_ramp=Math.pow(b(2)-1,3),this.p_repeat_speed=b(2)-1,this.p_arp_speed=b(2)-1,this.p_arp_mod=b(2)-1,this},h.prototype.random=function(){return E(1)?this.frequency=w(885.5,7941.5):this.frequency=w(3.5,3532),this.frequencySlide=w(-633,639),this.frequency>1732&&this.frequencySlide>5&&(this.frequencySlide=-this.frequencySlide),this.frequency<145&&this.frequencySlide<-0.088&&(this.frequencySlide=-this.frequencySlide),this.frequencySlideSlide=w(-0.88,.88),this.dutyCycle=b(1),this.dudyCycleSweep=w(-17.64,17.64),this.vibratoDepth=w(-0.5,.5),this.vibratoRate=w(0,69),this.attack=d(b(1))*2.26,this.sustain=p(b(1))*2.26+.09,this.decay=b(1)*2.26,this.punch=p(b(1))*.64,this.attack+this.sustain+this.decay<.45&&(this.sustain+=w(.5,1.25),this.decay+=w(.5,1.25)),this.lowPassResonance=w(.444,.97),this.lowPassFrequency=b(39200),this.lowPassSweep=w(.012,82),this.lowPassFrequency<35&&this.lowPassSweep<.802&&(this.lowPassSweep=1-this.lowPassSweep),this.highPassFrequency=39200*g(b(1),5),this.highPassSweep=555718*g(w(-1,1),5),this.flangerOffset=.023*d(b(2)-1),this.flangerSweep=d(b(2)-1),this.retriggerRate=b(1378),this.arpeggioDelay=b(1.81),this.arpeggioFactor=w(.09,10),this},y.prototype.tone=function(){return this.wave_type=u,this.p_base_freq=.35173364,this.p_env_attack=0,this.p_env_sustain=.6641,this.p_env_decay=0,this.p_env_punch=0,this},S.prototype.initFromUI=function(e){this.initForRepeat=function(){this.elapsedSinceRepeat=0,this.period=100/(e.p_base_freq*e.p_base_freq+.001),this.periodMax=100/(e.p_freq_limit*e.p_freq_limit+.001),this.enableFrequencyCutoff=e.p_freq_limit>0,this.periodMult=1-Math.pow(e.p_freq_ramp,3)*.01,this.periodMultSlide=-Math.pow(e.p_freq_dramp,3)*1e-6,this.dutyCycle=.5-e.p_duty*.5,this.dutyCycleSlide=-e.p_duty_ramp*5e-5,e.p_arp_mod>=0?this.arpeggioMultiplier=1-Math.pow(e.p_arp_mod,2)*.9:this.arpeggioMultiplier=1+Math.pow(e.p_arp_mod,2)*10,this.arpeggioTime=Math.floor(Math.pow(1-e.p_arp_speed,2)*2e4+32),e.p_arp_speed===1&&(this.arpeggioTime=0)},this.initForRepeat(),this.waveShape=parseInt(e.wave_type),this.fltw=Math.pow(e.p_lpf_freq,3)*.1,this.enableLowPassFilter=e.p_lpf_freq!=1,this.fltw_d=1+e.p_lpf_ramp*1e-4,this.fltdmp=5/(1+Math.pow(e.p_lpf_resonance,2)*20)*(.01+this.fltw),this.fltdmp>.8&&(this.fltdmp=.8),this.flthp=Math.pow(e.p_hpf_freq,2)*.1,this.flthp_d=1+e.p_hpf_ramp*3e-4,this.vibratoSpeed=Math.pow(e.p_vib_speed,2)*.01,this.vibratoAmplitude=e.p_vib_strength*.5,this.envelopeLength=[Math.floor(e.p_env_attack*e.p_env_attack*1e5),Math.floor(e.p_env_sustain*e.p_env_sustain*1e5),Math.floor(e.p_env_decay*e.p_env_decay*1e5)],this.envelopePunch=e.p_env_punch,this.flangerOffset=Math.pow(e.p_pha_offset,2)*1020,e.p_pha_offset<0&&(this.flangerOffset=-this.flangerOffset),this.flangerOffsetSlide=Math.pow(e.p_pha_ramp,2)*1,e.p_pha_ramp<0&&(this.flangerOffsetSlide=-this.flangerOffsetSlide),this.repeatTime=Math.floor(Math.pow(1-e.p_repeat_speed,2)*2e4+32),e.p_repeat_speed===0&&(this.repeatTime=0),this.gain=Math.exp(e.sound_vol)-1,this.sampleRate=e.sample_rate,this.bitsPerChannel=e.sample_size;for(var t in this)typeof this[t]!="function"&&console.log(t,this[t])},S.prototype.init=function(e){this.initForRepeat=function(){this.elapsedSinceRepeat=0,this.period=l*44100/e.frequency,this.periodMax=l*44100/e.frequencyMin,this.enableFrequencyCutoff=e.frequencyMin>0,this.periodMult=Math.pow(.5,e.frequencySlide/44100),this.periodMultSlide=e.frequencySlideSlide*Math.pow(2,-44101/44100)/44100,this.dutyCycle=e.dutyCycle,this.dutyCycleSlide=e.dutyCycleSweep/(l*44100),this.arpeggioMultiplier=1/e.arpeggioFactor,this.arpeggioTime=e.arpeggioDelay*44100},this.initForRepeat(),this.waveShape=e.shape,this.fltw=e.lowPassFrequency/(l*44100+e.lowPassFrequency),this.enableLowPassFilter=e.lowPassFrequency<44100,this.fltw_d=Math.pow(e.lowPassSweep,1/44100),this.fltdmp=(1-e.lowPassResonance)*9*(.01+this.fltw),this.flthp=e.highPassFrequency/(l*44100+e.highPassFrequency),this.flthp_d=Math.pow(e.highPassSweep,1/44100),this.vibratoSpeed=e.vibratoRate*64/44100/10,this.vibratoAmplitude=e.vibratoDepth,this.envelopeLength=[Math.floor(e.attack*44100),Math.floor(e.sustain*44100),Math.floor(e.decay*44100)],this.envelopePunch=e.punch,this.flangerOffset=e.flangerOffset*44100,this.flangerOffsetSlide=e.flangerSweep,this.repeatTime=e.retriggerRate?1/(44100*e.retriggerRate):0,this.gain=Math.sqrt(Math.pow(10,e.gain/10)),this.sampleRate=e.sampleRate,this.bitsPerChannel=e.sampleSize},S.prototype.generate=function(){var e=0,t=0,n=0,r=Array(32);for(var c=0;c<32;++c)r[c]=Math.random()*2-1;var h=0,p=0,d=0,v=0,m=0,g=Array(1024);for(var c=0;c<1024;++c)g[c]=0;var y=0,b=[],w=0,E=0,S=Math.floor(44100/this.sampleRate);for(var x=0;;++x){this.repeatTime!=0&&++this.elapsedSinceRepeat>=this.repeatTime&&this.initForRepeat(),this.arpeggioTime!=0&&x>=this.arpeggioTime&&(this.arpeggioTime=0,this.period*=this.arpeggioMultiplier),this.periodMult+=this.periodMultSlide,this.period*=this.periodMult;if(this.period>this.periodMax){this.period=this.periodMax;if(this.enableFrequencyCutoff)break}var T=this.period;this.vibratoAmplitude>0&&(d+=this.vibratoSpeed,T=this.period*(1+Math.sin(d)*this.vibratoAmplitude));var N=Math.floor(T);N<l&&(N=l),this.dutyCycle+=this.dutyCycleSlide,this.dutyCycle<0&&(this.dutyCycle=0),this.dutyCycle>.5&&(this.dutyCycle=.5);if(++p>this.envelopeLength[h]){p=0;if(++h>2)break}var C,k=p/this.envelopeLength[h];h===0?C=k:h===1?C=1+(1-k)*2*this.envelopePunch:C=1-k,this.flangerOffset+=this.flangerOffsetSlide;var L=Math.abs(Math.floor(this.flangerOffset));L>1023&&(L=1023),this.flthp_d!=0&&(this.flthp*=this.flthp_d,this.flthp<1e-5&&(this.flthp=1e-5),this.flthp>.1&&(this.flthp=.1));var A=0;for(var O=0;O<l;++O){var M=0;v++;if(v>=N){v%=N;if(this.waveShape===a)for(var c=0;c<32;++c)r[c]=Math.random()*2-1}var _=v/N;if(this.waveShape===s)_<this.dutyCycle?M=.5:M=-0.5;else if(this.waveShape===o)_<this.dutyCycle?M=-1+2*_/this.dutyCycle:M=1-2*(_-this.dutyCycle)/(1-this.dutyCycle);else if(this.waveShape===u)M=Math.sin(_*2*Math.PI);else{if(this.waveShape!==a)throw"ERROR: Bad wave type: "+this.waveShape;M=r[Math.floor(v*32/N)]}var D=e;this.fltw*=this.fltw_d,this.fltw<0&&(this.fltw=0),this.fltw>.1&&(this.fltw=.1),this.enableLowPassFilter?(t+=(M-e)*this.fltw,t-=t*this.fltdmp):(e=M,t=0),e+=t,n+=e-D,n-=n*this.flthp,M=n,g[m&1023]=M,M+=g[m-L+1024&1023],m=m+1&1023,A+=M*C}w+=A;if(!(++E>=S))continue;E=0,A=w/S,w=0,A=A/l*f,A*=this.gain,this.bitsPerChannel===8?(A=Math.floor((A+1)*128),A>255?(A=255,++y):A<0&&(A=0,++y),b.push(A)):(A=Math.floor(A*32768),A>=32768?(A=32767,++y):A<-32768&&(A=-32768,++y),b.push(A&255),b.push(A>>8&255))}var P=new i;return P.header.sampleRate=this.sampleRate,P.header.bitsPerSample=this.bitsPerChannel,P.Make(b),P.clipping=y,P},h.prototype.tone=function(){return this.shape=u,this.frequency=440,this.attack=0,this.sustain=1,this.decay=0,this};var x="pickupCoin,laserShoot,explosion,powerUp,hitHurt,jump,blipSelect,random,tone".split(",");for(var T=0;T<x.length;++T)(function(e){h.prototype[e]||(h.prototype[e]=function(){return this.translate((new y)[e]())})})(x[T]);if(typeof e!="undefined"){var i=t("./riffwave").RIFFWAVE;e.Params=y,e.Knobs=h,e.SoundEffect=S,e.SQUARE=s,e.SAWTOOTH=o,e.SINE=u,e.NOISE=a}return e}(),js=Float32Array,no=function(){function t(t){"use strict";var n=2,r=0,i=Js(),s=Js(),o=0;this.tick=function(u){switch(r){case 0:break;case 1:Ks(t.position,Qs(i,u.delta*n,e)),o+=u.delta*n,o>=1&&(r=0,$s(Ks(s,i,e),t.position),o=0);break;default:}},this.tap=function(e,n){switch(r){case 1:break;case 0:$s(n,i),$s(t.position,s),o=0,r=1;break;default:}}}var e=Js();return function(e){this.position=Js([e.x,e.y,e.z]);var n=new t(this);this.tap=function(e,t){n.tap(e,t)},this.tick=function(e){n.tick(e)}}}(),io;!function(){"use strict";function t(e,t){this.x=e,this.y=t,this.toString=function(){return"["+e+", "+t+"]"}}io=function(){function i(e,n,r){if(n<0)switch(e){case 0:return i(1,r,-n-1);case 1:return i(5,-n-1,15-r);case 2:return i(1,n+16,r);case 3:return i(2,n+16,r);case 4:return i(1,15-r,16+n);case 5:return i(1,-n-1,15-r);default:throw new RangeError}if(r<0)switch(e){case 0:return i(5,n,16+r);case 1:return i(0,-r-1,n);case 2:return i(0,n,16+r);case 3:return i(0,16+r,15-n);case 4:return i(2,n,16+r);case 5:return i(4,n,16+r);default:throw new RangeError}if(n>=16)switch(e){case 0:return i(3,15-r,n-16);case 1:return i(2,n-16,r);case 2:return i(3,n-16,r);case 3:return i(5,31-n,15-r);case 4:return i(3,r,31-n);case 5:return i(3,31-n,15-r);default:throw new RangeError}if(r>=16)switch(e){case 0:return i(2,n,r-16);case 1:return i(4,r-16,15-n);case 2:return i(4,n,r-16);case 3:return i(4,31-r,n);case 4:return i(5,n,r-16);case 5:return i(0,n,r-16);default:throw new RangeError}switch(e){case 0:return new t(n+16,r);case 1:return new t(n,r+16);case 2:return new t(n+16,r+16);case 3:return new t(n+32,r+16);case 4:return new t(n+16,r+32);case 5:return new t(n+16,r+48);default:throw new RangeError}}var n=e.createElement("canvas");n.width=n.height=64;var r=n.getContext("2d");this.getCanvasCoordinate=i,this.canvas=n,this.ctx=r}}();var so={OUT_OF_BOUNDS:-1,AIR:0,CUBE:1,START:2,GOAL:3};so.create=function(e){"use strict";function p(){f=[];for(var e=l;e--;){f[e]=[];for(var t=l;t--;){f[e][t]=[];for(var n=l;n--;)f[e][t][n]=so.AIR}}}function d(e,t,n,r){f[e][t][n]=r}function v(e,t,n){return e<0||t<0||n<0||e>=l||t>=l||n>=l?so.OUT_OF_BOUNDS:f[e][t][n]}function m(e){return e===-1?-1:[1,0,3,2,5,4][e]}function g(e,t,n){var r=[e.x,e.y,e.z],i=a[t];for(var s=0;s<n;s++)r[0]+=i[0],r[1]+=i[1],r[2]+=i[2];return{x:r[0],y:r[1],z:r[2]}}function y(e,t,n){for(var r=1;r<n;r++){var i=g(e,t,r),s=v(i.x,i.y,i.z);if(s!==so.AIR)return!1}return!0}function b(e,n,r,i,s){var o=r===1?so.GOAL:so.CUBE,u=e.next()%6,a=3+e.next()%(l-3);if(r===0)return!0;if(i>=t)return!1;if(u===s||u===m(s))return b(e,n,r,i,s);if(!y(n,u,a))return b(e,n,r,i+1,s);var f=g(n,u,a),c=v(f.x,f.y,f.z);if(c===so.OUT_OF_BOUNDS)return b(e,n,r,i+1,s);d(f.x,f.y,f.z,o);var p=g(n,u,a-1);return h.push(p),b(e,p,r-1,0,m(u))}function w(e){var t,n=0;do t=new ro(e++),l=(t.next()%8+4)*2,c={x:l/2|0,y:l/2|0,z:l/2|0},p(),d(c.x,c.y,c.z,so.START),n=5+t.next()%8;while(!b(t,c,n,0,-1))}var t=16,n=0,r=1,i=2,s=3,o=4,u=5,a=[];a[n]=[1,0,0],a[r]=[-1,0,0],a[i]=[0,1,0],a[s]=[0,-1,0],a[o]=[0,0,1],a[u]=[0,0,-1];var f,l=0,c=null,h=[];return w(e),{startingPosition:c,getObject:v,path:h}};var oo,uo,ao,fo,lo,co,ho,po,vo,mo,go,yo,bo,wo=new io,Eo=e.getElementsByTagName("canvas")[0],So=Ps.createContext(Eo),xo=Ws(60,Eo.width/Eo.height,.1,1e3),To=Js(),No=Js(),Co=Js([0,1,0]),ko=Is(),Lo=Fs(),Ao=null,Oo=null,Mo=Js([1,0,0]),_o=Js([0,1,0]),Do=Js([0,0,1]),Po=0,Ho=0,Bo=0,jo=[Js([0,0,0]),Js([1,0,0]),Js([0,1,0]),Js([0,0,1]),Js([0,0,-1]),Js([0,-1,0]),Js([-1,0,0])],Fo=[[0,0,0,0],[2,3,4,5],[0,0,0,0],[2,6,1,5],[2,1,6,5],[0,0,0,0],[2,4,3,5]],Io=[],qo=Js(),Ro=!1,Uo=null,zo=!1,Wo=null,Xo={x:0,y:0},Go=function(){var e=Js([-1,0,0]),t=Js([0,-1,0]),n=Js([0,0,-1]),r=[Mo,e,_o,t,Do,n],i=Js(),s=Js();return function(e){$s(e,i),Gs(i);var t=99999,n=-1;for(var o=0;o!==6;o++){var u=r[o];Vs(i,u,s);var a=Zs(s);t>a&&(t=a,n=o)}return r[[1,0,3,2,5,4][n]]}}();Ps.loadmanager.loadFiles({files:["cube.obj","sphere.obj","diffuse.shader","cube.png","skybox.obj","border.shader","goal.obj"],error:function(e,t){},finished:function(e){oo=e["cube.obj"],fo=e["skybox.obj"],uo=e["sphere.obj"],lo=e["goal.obj"],ho=Ps.shader.compileProgram(So,e["diffuse.shader"]),po=Ps.shader.compileProgram(So,e["border.shader"]),Ao=ou(e["cube.png"]),Oo=ou(wo.canvas);var t=10,n=new Int32Array(t),r=new Int32Array(t),i=new Int32Array(t),s=new Int32Array(t);for(var o=0;o!==t;o++)n[o]=Math.random()*16|0,r[o]=Math.random()*16|0,i[o]=Math.random()*2|0,s[o]=Math.random()*6|0;setInterval(function(){wo.ctx.beginPath(),wo.ctx.fillStyle="#000000",wo.ctx.globalAlpha=.2,wo.ctx.rect(0,0,64,64),wo.ctx.fill(),wo.ctx.globalAlpha=1;for(var e=0;e!==t;e++){var o=n[e],u=r[e],a=i[e],f=s[e],l=wo.getCanvasCoordinate(f,o,u);wo.ctx.beginPath(),wo.ctx.fillStyle="#FF0000",wo.ctx.rect(l.x,l.y,1,1),wo.ctx.fill(),a?n[e]++:r[e]++}su(wo.canvas,Oo)},100);var u=65535*Math.random()&65535;bo=so.create(u);for(var a=0;a!==16;a++)for(var f=0;f!==16;f++)for(var l=0;l!==16;l++){var c=bo.getObject(a,f,l);c===so.CUBE?Io.push({vector:Js([a,f,l])}):c===so.GOAL&&(qo[0]=a,qo[1]=f,qo[2]=l)}No[0]=bo.startingPosition.x,No[1]=bo.startingPosition.x,No[2]=bo.startingPosition.x,ao=new no({x:No[0],y:No[1],z:No[2]}),$s(No,To),To[0]=0,To[1]=0,To[2]=20,Ko(),Vo(),Ps.requestGameFrame(Qo)}})}(document,this);