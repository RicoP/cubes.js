!function(e,t){function Fs(e){var t=new js(16);return e&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t}function Is(e){return e||(e=Fs()),e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function qs(e,t,n){n||(n=e);var r=e[0],i=e[1],s=e[2],o=e[3],u=e[4],a=e[5],f=e[6],l=e[7],c=e[8],h=e[9],p=e[10],d=e[11],v=e[12],m=e[13],g=e[14],y=e[15],b=t[0],w=t[1],E=t[2],S=t[3];return n[0]=b*r+w*u+E*c+S*v,n[1]=b*i+w*a+E*h+S*m,n[2]=b*s+w*f+E*p+S*g,n[3]=b*o+w*l+E*d+S*y,b=t[4],w=t[5],E=t[6],S=t[7],n[4]=b*r+w*u+E*c+S*v,n[5]=b*i+w*a+E*h+S*m,n[6]=b*s+w*f+E*p+S*g,n[7]=b*o+w*l+E*d+S*y,b=t[8],w=t[9],E=t[10],S=t[11],n[8]=b*r+w*u+E*c+S*v,n[9]=b*i+w*a+E*h+S*m,n[10]=b*s+w*f+E*p+S*g,n[11]=b*o+w*l+E*d+S*y,b=t[12],w=t[13],E=t[14],S=t[15],n[12]=b*r+w*u+E*c+S*v,n[13]=b*i+w*a+E*h+S*m,n[14]=b*s+w*f+E*p+S*g,n[15]=b*o+w*l+E*d+S*y,n}function Rs(e,t,n){n||(n=t);var r=t[0],i=t[1],s=t[2];return n[0]=e[0]*r+e[4]*i+e[8]*s+e[12],n[1]=e[1]*r+e[5]*i+e[9]*s+e[13],n[2]=e[2]*r+e[6]*i+e[10]*s+e[14],n}function Us(e,t,n){var r=t[0],i=t[1],s=t[2],o,u,a,f,l,c,h,p,d,v,m,g;return!n||e===n?(e[12]=e[0]*r+e[4]*i+e[8]*s+e[12],e[13]=e[1]*r+e[5]*i+e[9]*s+e[13],e[14]=e[2]*r+e[6]*i+e[10]*s+e[14],e[15]=e[3]*r+e[7]*i+e[11]*s+e[15],e):(o=e[0],u=e[1],a=e[2],f=e[3],l=e[4],c=e[5],h=e[6],p=e[7],d=e[8],v=e[9],m=e[10],g=e[11],n[0]=o,n[1]=u,n[2]=a,n[3]=f,n[4]=l,n[5]=c,n[6]=h,n[7]=p,n[8]=d,n[9]=v,n[10]=m,n[11]=g,n[12]=o*r+l*i+d*s+e[12],n[13]=u*r+c*i+v*s+e[13],n[14]=a*r+h*i+m*s+e[14],n[15]=f*r+p*i+g*s+e[15],n)}function zs(e,t,n,r,i,s,o){o||(o=Fs());var u=t-e,a=r-n,f=s-i;return o[0]=i*2/u,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=i*2/a,o[6]=0,o[7]=0,o[8]=(t+e)/u,o[9]=(r+n)/a,o[10]=-(s+i)/f,o[11]=-1,o[12]=0,o[13]=0,o[14]=-(s*i*2)/f,o[15]=0,o}function Ws(e,t,n,r,i){var s=n*Math.tan(e*Math.PI/360),o=s*t;return zs(-o,o,-s,s,n,r,i)}function Xs(e,t,n,r){r||(r=Fs());var i,s,o,u,a,f,l,c,h,p,d=e[0],v=e[1],m=e[2],g=n[0],y=n[1],b=n[2],w=t[0],E=t[1],S=t[2];return d===w&&v===E&&m===S?Is(r):(l=d-w,c=v-E,h=m-S,p=1/Math.sqrt(l*l+c*c+h*h),l*=p,c*=p,h*=p,i=y*h-b*c,s=b*l-g*h,o=g*c-y*l,p=Math.sqrt(i*i+s*s+o*o),p?(p=1/p,i*=p,s*=p,o*=p):(i=0,s=0,o=0),u=c*o-h*s,a=h*i-l*o,f=l*s-c*i,p=Math.sqrt(u*u+a*a+f*f),p?(p=1/p,u*=p,a*=p,f*=p):(u=0,a=0,f=0),r[0]=i,r[1]=u,r[2]=l,r[3]=0,r[4]=s,r[5]=a,r[6]=c,r[7]=0,r[8]=o,r[9]=f,r[10]=h,r[11]=0,r[12]=-(i*d+s*v+o*m),r[13]=-(u*d+a*v+f*m),r[14]=-(l*d+c*v+h*m),r[15]=1,r)}function Vs(e,t,n){return!n||e===n?(e[0]-=t[0],e[1]-=t[1],e[2]-=t[2],e):(n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n)}function $s(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Js(e){var t=new js(3);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2]):t[0]=t[1]=t[2]=0,t}function Ks(e,t,n){return!n||e===n?(e[0]+=t[0],e[1]+=t[1],e[2]+=t[2],e):(n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n)}function Qs(e,t,n){return!n||e===n?(e[0]*=t,e[1]*=t,e[2]*=t,e):(n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n)}function Gs(e,t){t||(t=e);var n=e[0],r=e[1],i=e[2],s=Math.sqrt(n*n+r*r+i*i);return s?s===1?(t[0]=n,t[1]=r,t[2]=i,t):(s=1/s,t[0]=n*s,t[1]=r*s,t[2]=i*s,t):(t[0]=0,t[1]=0,t[2]=0,t)}function Ys(e,t,n){n||(n=e);var r=e[0],i=e[1],s=e[2],o=t[0],u=t[1],a=t[2];return n[0]=i*a-s*u,n[1]=s*o-r*a,n[2]=r*u-i*o,n}function Zs(e){var t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)}function eo(e,t,n){n||(n=t);var r=t[0],i=t[1],s=t[2],o=e[0],u=e[1],a=e[2],f=e[3],l=f*r+u*s-a*i,c=f*i+a*r-o*s,h=f*s+o*i-u*r,p=-o*r-u*i-a*s;return n[0]=l*f+p*-o+c*-a-h*-u,n[1]=c*f+p*-u+h*-o-l*-a,n[2]=h*f+p*-a+l*-u-c*-o,n}function to(e,t,n){n||(n=new js(4));var r=e*.5,i=Math.sin(r);return n[3]=Math.cos(r),n[0]=i*t[0],n[1]=i*t[1],n[2]=i*t[2],n}function no(e){"use strict";var t=65535,n=new Uint32Array(4096),r=362436,i=2654435769;n[0]=e,n[1]=e+i,n[2]=e+i+i;for(var s=3;s<4096;s++)n[s]=n[s-3]^n[s-2]^i^s;var o=4095;this.next=function(){var e,i=18782,s,u=4294967294;o=o+1&4095,e=i*n[o]+r,r=e>>32,s=e+r,s<r&&(s++,r++);var a=n[o]=u-s;return a<0?-a%t:a%t}}function ro(e){"use strict";function f(e){var t=[];for(var n=e;n--;){t[n]=[];for(var r=e;r--;){t[n][r]=[];for(var i=e;i--;)t[n][r][i]=0}}return t}function l(e,t,n){var r=t[0],i=t[1],s=t[2];e[r][i][s]=n}function c(e,t,n){var r=n[0],i=n[1],s=n[2];return r<0||i<0||s<0||r>=t||i>=t||s>=t?-1:e[r][i][s]}function h(e){return e===-1?-1:[1,0,3,2,5,4][e]}function p(e){return e.slice(0)}function d(e,t){var n=a[t],r=p(e);return r[0]+=n[0],r[1]+=n[1],r[2]+=n[2],r}function v(e,t,n){return n===0?e:v(d(e,t),t,n-1)}function m(e,t,n,r,i){if(i<2)return!0;var s=v(n,r,1);return c(e,t,s)!==0?!1:m(e,t,s,r,i-1)}function g(e,n,r,i,s,o,u,a,f){var p=r===1&&f?3:1,d=e.next()%6,y=3+e.next()%(a-3);if(r===0)return!0;if(i>=t)return!1;if(d===s||d===h(s))return g(e,n,r,i,s,o,u,a,f);if(!m(u,a,n,d,y))return g(e,n,r,i+1,s,o,u,a,f);var b=v(n,d,y),w=c(u,a,b);if(w===-1)return g(e,n,r,i+1,s,o,u,a,f);l(u,b,p);var E=v(n,d,y-1);return o.push(E),g(e,E,r-1,0,h(d),o,u,a,f)}function y(e){var t=16,n=new no(e),r=5+n.next()%4,i=[t/2|0,t/2|0,t/2|0],s=f(t);l(s,i,2);var o=[],u=g(n,i,r,0,-1,o,s,t,!0),a=[],h=u&&g(n,o[n.next()%o.length],r,0,-1,a,s,t,!1);return u?{startingPosition:{x:i[0],y:i[0],z:i[0]},getObject:function(e,n,r){return c(s,t,[e,n,r])},path:o}:y(e+1)}var t=16,n=0,r=1,i=2,s=3,o=4,u=5,a=[];return a[n]=[1,0,0],a[r]=[-1,0,0],a[i]=[0,1,0],a[s]=[0,-1,0],a[o]=[0,0,1],a[u]=[0,0,-1],y(e)}function Su(){var e=su;Ks(nu,tu,e),Xs(e,nu,ru,iu)}function xu(e){var t=to(e,ru);eo(t,tu),Su()}function Tu(e){var t=su,n=Gs(Ys(ru,tu,t)),r=to(e,n);eo(r,tu),Gs(Ys(tu,n,ru)),Su()}function Nu(){Bo(rt),Bo(Z),Uo(4.5),Lo(0,0,0,0),Yo(0,0,Eo.width,Eo.height),vo=Oo(),To(I,vo),Co(I,oo.rawData,W),mo=Oo(),To(I,mo),Co(I,uo.rawData,W),go=Oo(),To(I,go),Co(I,fo.rawData,W),co=Oo(),To(I,co),Co(I,lo.rawData,W);var e=new Float32Array(3*bo.path.length),t=0;e[t++]=bo.startingPosition.x,e[t++]=bo.startingPosition.y,e[t++]=bo.startingPosition.z;for(var n=0;n!==bo.path.length;n++)e[t++]=bo.path[n][0],e[t++]=bo.path[n][1],e[t++]=bo.path[n][2];pathBuffer=Oo(),To(I,pathBuffer),Co(I,e,W)}function Cu(e){Lu(e),Au(e),Ps.requestGameFrame(Cu)}function Lu(e){if(Zo.poke){var t=ku(tu);ao.tap(e,t)}if(Zo.drag){var n=Zo.dragDirection.x*2*Math.PI/Eo.width,r=Zo.dragDirection.y*2*Math.PI/Eo.height;xu(n),Tu(r)}Zo.update(),ao.tick(e)}function Au(e){Po(rt),Du(ho),Bo(rt),ko(r),Ou(ho),Mu(ho),_u(ho),Pu(po,bo.path)}function Ou(e){Qo(e);var t=Ro(e,"uModelviewprojection"),n=Ro(e,"uTexture"),r=Fo(e,"aVertex"),i=Fo(e,"aTextureuv"),s=Fo(e,"aNormal"),o=su;To(I,vo),Go(r,4,wn,!1,oo.stride,oo.voffset),jo(r),i!==-1&&(Go(i,4,wn,!1,oo.stride,oo.toffset),jo(i)),s!==-1&&(Go(s,4,wn,!1,oo.stride,oo.noffset),jo(s)),n&&(No(Y,ou),Jo(n,0));for(var u=0;u!=vu.length;u++){var a=vu[u];qs(eu,iu,o),Us(o,a.vector),Ko(t,!1,o),Ho(l,0,oo.numVertices)}}function Mu(e){Qo(e);var t=Ro(e,"uModelviewprojection"),n=Ro(e,"uTexture"),r=Fo(e,"aVertex"),i=Fo(e,"aTextureuv"),s=su;To(I,mo),Go(r,4,wn,!1,uo.stride,uo.voffset),jo(r),i!==-1&&(Go(i,4,wn,!1,uo.stride,uo.toffset),jo(i)),n&&(No(Y,ou),Jo(n,0)),qs(eu,iu,s),Us(s,ao.position),Ko(t,!1,s),Ho(l,0,uo.numVertices)}function _u(e){Qo(e);var t=Ro(e,"uModelviewprojection"),n=Ro(e,"uTexture"),r=Fo(e,"aVertex"),i=Fo(e,"aTextureuv"),s=su;To(I,co),Go(r,4,wn,!1,lo.stride,lo.voffset),jo(r),i!==-1&&(Go(i,4,wn,!1,lo.stride,lo.toffset),jo(i)),n&&(No(Y,ou),Jo(n,0)),qs(eu,iu,s),Us(s,mu),Ko(t,!1,s),Ho(l,0,lo.numVertices)}function Du(e){Qo(e);var t=Ro(e,"uModelviewprojection"),n=Ro(e,"uTexture"),r=Fo(e,"aVertex"),i=Fo(e,"aTextureuv"),s=su;To(I,go),Go(r,4,wn,!1,fo.stride,fo.voffset),jo(r),Go(i,4,wn,!1,fo.stride,fo.toffset),jo(i),No(Y,uu),Jo(n,0),qs(eu,iu,s),Us(s,nu),Us(s,tu),Ko(t,!1,s),Ho(l,0,fo.numVertices)}function Pu(e,t){Qo(e);var n=Fo(e,"aVertex"),r=Ro(e,"uModelviewprojection"),i=su;To(I,pathBuffer),Go(n,3,wn,!1,0,0),jo(n),qs(eu,iu,i),Ko(r,!1,i);for(var s=0;s!==bo.path.length-1;s++)Ho(u,s,2)}function Hu(e,t){No(Y,t),Wo(As,!0),Vo(Y,0,Tn,Tn,vn,e),$o(Y,wr,dr),$o(Y,Er,dr)}function Bu(e){var t=Do();return Hu(e,t),No(Y,null),t}var r=256,i=1024,s=16384,o=0,u=1,a=2,f=3,l=4,c=5,h=6,p=0,d=1,v=768,m=769,g=770,y=771,b=772,w=773,E=774,S=775,x=776,T=32774,N=32777,C=32777,k=34877,L=32778,A=32779,O=32968,M=32969,_=32970,D=32971,P=32769,H=32770,B=32771,j=32772,F=32773,I=34962,q=34963,R=34964,U=34965,z=35040,W=35044,X=35048,V=34660,$=34661,J=34342,K=1028,Q=1029,G=1032,Y=3553,Z=2884,et=3042,tt=3024,nt=2960,rt=2929,it=3089,st=32823,ot=32926,ut=32928,at=0,ft=1280,lt=1281,ct=1282,ht=1285,pt=2304,dt=2305,vt=2849,mt=33901,gt=33902,yt=2885,bt=2886,wt=2928,Et=2930,St=2931,xt=2932,Tt=2961,Nt=2962,Ct=2964,kt=2965,Lt=2966,At=2967,Ot=2963,Mt=2968,_t=34816,Dt=34817,Pt=34818,Ht=34819,Bt=36003,jt=36004,Ft=36005,It=2978,qt=3088,Rt=3106,Ut=3107,zt=3317,Wt=3333,Xt=3379,Vt=3386,$t=3408,Jt=3410,Kt=3411,Qt=3412,Gt=3413,Yt=3414,Zt=3415,en=10752,tn=32824,nn=32873,rn=32936,sn=32937,on=32938,un=32939,an=34466,fn=34467,ln=4352,cn=4353,hn=4354,pn=33170,dn=5120,vn=5121,mn=5122,gn=5123,yn=5124,bn=5125,wn=5126,En=6402,Sn=6406,xn=6407,Tn=6408,Nn=6409,Cn=6410,kn=32819,Ln=32820,An=33635,On=35632,Mn=35633,_n=34921,Dn=36347,Pn=36348,Hn=35661,Bn=35660,jn=34930,Fn=36349,In=35663,qn=35712,Rn=35714,Un=35715,zn=35717,Wn=35718,Xn=35719,Vn=35721,$n=35722,Jn=35724,Kn=35725,Qn=512,Gn=513,Yn=514,Zn=515,er=516,tr=517,nr=518,rr=519,ir=7680,sr=7681,or=7682,ur=7683,ar=5386,fr=34055,lr=34056,cr=7936,hr=7937,pr=7938,dr=9728,vr=9729,mr=9984,gr=9985,yr=9986,br=9987,wr=10240,Er=10241,Sr=10242,xr=10243,Tr=5890,Nr=34067,Cr=34068,kr=34069,Lr=34070,Ar=34071,Or=34072,Mr=34073,_r=34074,Dr=34076,Pr=33984,Hr=33985,Br=33986,jr=33987,Fr=33988,Ir=33989,qr=33990,Rr=33991,Ur=33992,zr=33993,Wr=33994,Xr=33995,Vr=33996,$r=33997,Jr=33998,Kr=33999,Qr=34e3,Gr=34001,Yr=34002,Zr=34003,ei=34004,ti=34005,ni=34006,ri=34007,ii=34008,si=34009,oi=34010,ui=34011,ai=34012,fi=34013,li=34014,ci=34015,hi=34016,pi=10497,di=33071,vi=33648,mi=35664,gi=35665,yi=35666,bi=35667,wi=35668,Ei=35669,Si=35670,xi=35671,Ti=35672,Ni=35673,Ci=35674,ki=35675,Li=35676,Ai=35678,Oi=35680,Mi=34338,_i=34339,Di=34340,Pi=34341,Hi=34922,Bi=34373,ji=34975,Fi=35713,Ii=35716,qi=35720,Ri=36336,Ui=36337,zi=36338,Wi=36339,Xi=36340,Vi=36341,$i=36160,Ji=36161,Ki=32854,Qi=32855,Gi=36194,Yi=33189,Zi=6401,es=36168,ts=34041,ns=36162,rs=36163,is=36164,ss=36176,os=36177,us=36178,as=36179,fs=36180,ls=36181,cs=36048,hs=36049,ps=36050,ds=36051,vs=36064,ms=36096,gs=36128,ys=33306,bs=0,ws=36053,Es=36054,Ss=36055,xs=36057,Ts=36061,Ns=36006,Cs=36007,ks=34024,Ls=1286,As=37440,Os=37441,Ms=37442,_s=37443,Ds=37444,Ps={};(function(e){"use strict";function n(e){var n,r,i;for(n=0;r=t[n++];){i=e.getContext(r,{alpha:!1,preserveDrawingBuffer:!0});if(i)return i}return null}var t=["experimental-webgl","webgl","moz-webgl","webkit-3d"];e.createContext=n})(Ps),function(n){"use strict";function u(){for(var e=0;e!==r;e++)o[e]=0,s[e]=0}function a(){for(var e=0;e!==r;e++)o[e]=s[e]}function f(e){return s[e]!==0}function l(e){return s[e]===0}function c(e){return s[e]!==0&&o[e]===0}function h(e){return s[e]===0&&o[e]!==0}var r=256,i=Uint8Array||Array,s=new i(r),o=new i(r);u(),e.addEventListener("keydown",function(e){var t=e.keyCode;t<r&&(s[t]=1)},!1),e.addEventListener("keyup",function(e){var t=e.keyCode;t<r&&(s[t]=0)},!1),t.addEventListener("blur",function(){u()},!1);var p={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,capslock:20,escape:27,space:32,pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,"delete":46,num0:48,num1:49,num2:50,num3:51,num4:52,num5:53,num6:54,num7:55,num8:56,num9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,windowKeyLeft:91,windowKeyRight:92,select:93,numpad0:96,numpad1:97,numpad2:98,numpad3:99,numpad4:100,numpad5:101,numpad6:102,numpad7:103,numpad8:104,numpad9:105,multiply:106,add:107,subtract:109,decimalPoint:110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numlock:144,scrolllock:145,semicolon:186,equals:187,comma:188,dash:189,period:190,slash:191,graveAccent:192,openBracket:219,backSlash:220,closeBraket:221,quote:222};n.keys={codes:p,update:a,isDown:f,isUp:l,wasPressed:c,wasReleased:h}}(Ps),function(n){"use strict";function a(){s=-1,u.total=0,u.frame=0}function f(t){function r(){try{var r=Date.now();s===-1&&(o=r,s=r,u.frame=0);var i=(r-o)/1e3;u.delta=i,u.total+=i,t(u),u.frame++,o=r,n.keys.update()}catch(a){var f=a.message||a;e.body.innerHTML=f+"",alert(f)}}i(r)}var r,i,s,o,u;r=t,i=r.requestAnimationFrame||r.webkitRequestAnimationFrame||r.mozRequestAnimationFrame||r.oRequestAnimationFrame||r.msRequestAnimationFrame||function(e){r.setTimeout(e,16)},s=-1,o=0,u={total:0,delta:0,frame:0,reset:a},n.requestGameFrame=f}(Ps),function(e){"use strict";function u(e){var u=e.split("\n"),a="",f=0,l=[],c=[],h=[],p=[],d=[],v=[],m=0,g={v:function(e){if(!e||e.length!=3)throw new Error("Can't accept Vertic without 3 components. LINE:"+a);var t=Number(e[0]),n=Number(e[1]),r=Number(e[2]);l.push(t,n,r)},vn:function(e){if(!e||e.length!=3)throw new Error("Can't accept Normal without 3 components. LINE:"+f);var t=Number(e[0]),n=Number(e[1]),r=Number(e[2]);c.push(t,n,r)},vt:function(e){if(!e||e.length<2)throw new Error("Can't accept Texture with less than 2 components. LINE:"+f);var t=Number(e[0]),n=Number(e[1]);h.push(t,n)},f:function D(e){if(!e||e.length<3)throw new Error("Can't accept Face with less than 3 components. LINE:"+f);if(e.length>3){for(var t=e.length-1;t!==1;t--)D([e[0],e[t-1],e[t]]);return}m++;for(var n=0;n!==3;n++){var r=e[n].split("/"),i=parseInt(r[0],10)-1,s=parseInt(r[1],10)-1,t=parseInt(r[2],10)-1;p.push(i),isNaN(s)||v.push(s),isNaN(t)||d.push(t)}}};for(f=0;f!=u.length;){a=u[f++].trim();var y=a.split(o),b=y.shift();b in g&&g[b](y)}var w=t;if(h.length!==0||v.length!==0){w|=r;if(p.length!==v.length)throw new Error("Texture indice don't match Vertic indice.")}if(c.length!==0||d.length!==0){w|=n;if(p.length!==d.length)throw new Error("Normal indice don't match Vertic indice.")}var E=0,S=0,x=0,T=0,N=0,C=0;switch(w){case t:N=4;break;case r:N=6,x=4*s;break;case n:N=8,T=4*s;break;case i:N=10,x=4*s,T=6*s;break;default:throw new Error("Schema broken.")}E=m*3*N;var k=new Float32Array(E),L=0,A=0,O=0,M=0;for(var _=0;_!=p.length;_++)A=3*p[_],k[L++]=l[A++],k[L++]=l[A++],k[L++]=l[A],k[L++]=1,w&r&&(O=2*v[_],k[L++]=h[O++],k[L++]=h[O]),w&n&&(M=3*d[_],k[L++]=c[M++],k[L++]=c[M++],k[L++]=c[M],k[L++]=0);return{stride:N*s,schema:w,voffset:S,toffset:x,noffset:T,rawData:k,numVertices:m*3}}var t=0,n=1,r=2,i=n|r,s=4,o=/[\t\r\n ]+/g;e.obj={},e.obj.parse=u,e.obj.SCHEMA_V=t,e.obj.SCHEMA_VN=n,e.obj.SCHEMA_VT=r,e.obj.SCHEMA_VTN=n|r}(Ps),function(e){"use strict";function t(e){return e=e.toLowerCase(),e==="application/json"?2:e==="text/html"?7:e.indexOf("javascript")!==-1?3:e.indexOf("xml")!==-1?4:e.indexOf("image")!==-1?5:1}function n(n,r,i,s){function o(){if(a)return;if(f.readyState===2||f.readyState===3){u=t(f.getResponseHeader("content-type")),r.toLowerCase().lastIndexOf(".json")+5===r.length?u=2:r.toLowerCase().lastIndexOf(".obj")+4===r.length&&(u=6);if(u===5){a=!0,f.abort();var o=new Image;o.onload=function(){i(n,o)},o.onerror=function(){s(r,"Loading image failed.")},o.src=r;return}}if(f.readyState===4){var l=f.status;if(l>=200&&l<=299||l===304||l===0)if(u===4)i(n,f.responseXML);else if(u===2)try{i(n,JSON.parse(f.responseText))}catch(c){s(r,c)}else if(u===6)try{i(n,e.obj.parse(f.responseText))}catch(c){s(r,c)}else i(n,f.responseText);else s(r,l||0)}}var u=0,a=!1,f=new XMLHttpRequest;f.onreadystatechange=o,f.open("GET",r,!0),f.send(null)}function r(){}function i(e){if(!e)throw new Error("Passed nothing in loadFiles");var t=e.files||{},i=e.update||r,s=e.finished||r,o=e.error||r,u=0,a=0,f=Object.create(null),l=function(e,t){a++,f[e]=t,i(e,a/u),a===u&&s(f)},c=function(e,t){l=r,c=r,o(e,t)};if(t instanceof Array){u=t.length;for(var h=0,p;p=t[h++];)n(p,p,l,c)}else{var d=Object.keys(t);u=d.length;for(var h=0,v;v=d[h++];)t.hasOwnProperty(v)&&n(v,t[v],l,c)}}e.loadmanager={},e.loadmanager.loadFiles=i}(Ps),function(e){"use strict";function t(e,t){var n=["#define VERTEX\n","#define FRAGMENT\n"],r="#line 0\n",i=[e.createShader(e.VERTEX_SHADER),e.createShader(e.FRAGMENT_SHADER)],s=e.createProgram(),o=null,u="";for(var a=0;a!=n.length;a++){o=i[a],e.shaderSource(o,n[a]+r+t),e.compileShader(o);if(u=e.getShaderInfoLog(o))throw new Error(u);e.attachShader(s,o)}return e.linkProgram(s),(u=e.getProgramInfoLog(s))&&console.error(u),s}e.shader={},e.shader.compileProgram=t}(Ps);var Hs=function(){function t(){return e}var e={};return!function(){var t={chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encLookup:[],Init:function(){for(var e=0;e<4096;e++)this.encLookup[e]=this.chars[e>>6]+this.chars[e&63]},Encode:function(e){var t=e.length,r="",i=0;while(t>2)n=e[i]<<16|e[i+1]<<8|e[i+2],r+=this.encLookup[n>>12]+this.encLookup[n&4095],t-=3,i+=3;if(t>0){var s=(e[i]&252)>>2,o=(e[i]&3)<<4;t>1&&(o|=(e[++i]&240)>>4),r+=this.chars[s],r+=this.chars[o];if(t==2){var u=(e[i++]&15)<<2;u|=(e[i]&192)>>6,r+=this.chars[u]}t==1&&(r+="="),r+="="}return r}};t.Init();var r=function(e){function n(e){return[e&255,e>>8&255,e>>16&255,e>>24&255]}function r(e){return[e&255,e>>8&255]}this.data=[],this.wav=[],this.dataURI="",this.header={chunkId:[82,73,70,70],chunkSize:0,format:[87,65,86,69],subChunk1Id:[102,109,116,32],subChunk1Size:16,audioFormat:1,numChannels:1,sampleRate:8e3,byteRate:0,blockAlign:0,bitsPerSample:8,subChunk2Id:[100,97,116,97],subChunk2Size:0},this.Make=function(e){e instanceof Array&&(this.data=e),this.header.byteRate=this.header.sampleRate*this.header.numChannels*this.header.bitsPerSample>>3,this.header.blockAlign=this.header.numChannels*this.header.bitsPerSample>>3,this.header.subChunk2Size=this.data.length,this.header.chunkSize=36+this.header.subChunk2Size,this.wav=this.header.chunkId.concat(n(this.header.chunkSize),this.header.format,this.header.subChunk1Id,n(this.header.subChunk1Size),r(this.header.audioFormat),r(this.header.numChannels),n(this.header.sampleRate),n(this.header.byteRate),r(this.header.blockAlign),r(this.header.bitsPerSample),this.header.subChunk2Id,n(this.header.subChunk2Size),this.data),this.dataURI="data:audio/wav;base64,"+t.Encode(this.wav)},e instanceof Array&&this.Make(e)};typeof e!="undefined"&&(e.RIFFWAVE=r)}(),!function(){function f(e){e=e||{};for(var t in a)e.hasOwnProperty(t)?this[t]=e[t]:this[t]=a[t]}function l(e){return e*e}function c(e){return e*e*e}function h(e){return e<0?-1:1}function p(e,t){return Math.log(e)/Math.log(t)}function v(){this.oldParams=!0,this.wave_type=n,this.p_env_attack=0,this.p_env_sustain=.3,this.p_env_punch=0,this.p_env_decay=.4,this.p_base_freq=.3,this.p_freq_limit=0,this.p_freq_ramp=0,this.p_freq_dramp=0,this.p_vib_strength=0,this.p_vib_speed=0,this.p_arp_mod=0,this.p_arp_speed=0,this.p_duty=0,this.p_duty_ramp=0,this.p_repeat_speed=0,this.p_pha_offset=0,this.p_pha_ramp=0,this.p_lpf_freq=1,this.p_lpf_ramp=0,this.p_lpf_resonance=0,this.p_hpf_freq=0,this.p_hpf_ramp=0,this.sound_vol=.5,this.sample_rate=44100,this.sample_size=8}function m(e){return Math.random()*e}function g(e,t){return Math.random()*(t-e)+e}function y(e){return Math.floor(Math.random()*(e+1))}function b(e){e.oldParams?this.initFromUI(e):this.init(e)}var n=0,r=1,i=2,s=3,o=1,u=8,a={shape:n,attack:0,sustain:.2,punch:0,decay:.2,frequency:1e3,frequencyMin:0,frequencySlide:0,frequencySlideSlide:0,vibratoDepth:0,vibratoRate:10,arpeggioFactor:1,arpeggioDelay:.1,dutyCycle:.5,dutyCycleSweep:0,retriggerRate:0,flangerOffset:0,flangerSweep:0,lowPassFrequency:44100,lowPassSweep:1,lowPassResonance:.5,highPassFrequency:0,highPassSweep:0,gain:-10,sampleRate:44100,sampleSize:8},d=Math.pow;f.prototype.translate=function(e){function t(e){return e/(1-e)}return this.shape=e.wave_type,this.attack=l(e.p_env_attack)*1e5/44100,this.sustain=l(e.p_env_sustain)*1e5/44100,this.punch=e.p_env_punch,this.decay=l(e.p_env_decay)*1e5/44100,this.frequency=u*441*(l(e.p_base_freq)+.001),e.p_freq_limit>0?this.frequencyMin=u*441*(l(e.p_freq_limit)+.001):this.frequencyMin=0,this.enableFrequencyCutoff=e.p_freq_limit>0,this.frequencySlide=44100*p(1-c(e.p_freq_ramp)/100,.5),this.frequencySlideSlide=-c(e.p_freq_dramp)/1e6*44100*d(2,44101/44100),this.vibratoRate=6890.625*l(e.p_vib_speed)/100,this.vibratoDepth=e.p_vib_strength/2,this.arpeggioFactor=1/(e.p_arp_mod>=0?1-l(e.p_arp_mod)*.9:1+l(e.p_arp_mod)*10),this.arpeggioDelay=e.p_arp_speed===1?0:Math.floor(l(1-e.p_arp_speed)*2e4+32)/44100,this.dutyCycle=(1-e.p_duty)/2,this.dutyCycleSweep=u*44100*-e.p_duty_ramp/2e4,this.retriggerRate=44100/(e.p_repeat_speed===0?0:Math.floor(l(1-e.p_repeat_speed)*2e4)+32),this.flangerOffset=h(e.p_pha_offset)*l(e.p_pha_offset)*1020/44100,this.flangerSweep=h(e.p_pha_ramp)*l(e.p_pha_ramp),this.enableLowPassFilter=e.p_lpf_freq!=1,this.lowPassFrequency=e.p_lpf_freq===1?44100:Math.round(u*44100*t(c(e.p_lpf_freq)/10)),this.lowPassSweep=d(1+e.p_lpf_ramp/1e4,44100),this.lowPassResonance=1-5/(1+l(e.p_lpf_resonance)*20)/9,this.highPassFrequency=Math.round(u*44100*t(l(e.p_hpf_freq)/10)),this.highPassSweep=d(1+e.p_hpf_ramp*3e-4,44100),this.gain=10*p(l(Math.exp(e.sound_vol)-1),10),this.sampleRate=e.sample_rate,this.sampleSize=e.sample_size,this},v.prototype.pickupCoin=function(){return this.p_base_freq=.4+m(.5),this.p_env_attack=0,this.p_env_sustain=m(.1),this.p_env_decay=.1+m(.4),this.p_env_punch=.3+m(.3),y(1)&&(this.p_arp_speed=.5+m(.2),this.p_arp_mod=.2+m(.4)),this},f.prototype.pickupCoin=function(){return this.frequency=g(568,2861),this.attack=0,this.sustain=m(.227),this.decay=g(.227,.567),this.punch=g(.3,.6),y(1)&&(this.arpeggioFactor=g(1.037,1.479),this.arpeggioDelay=g(.042,.114)),this},v.prototype.laserShoot=function(){return this.wave_type=y(2),this.wave_type===i&&y(1)&&(this.wave_type=y(1)),y(2)===0?(this.p_base_freq=.3+m(.6),this.p_freq_limit=m(.1),this.p_freq_ramp=-0.35-m(.3)):(this.p_base_freq=.5+m(.5),this.p_freq_limit=this.p_base_freq-.2-m(.6),this.p_freq_limit<.2&&(this.p_freq_limit=.2),this.p_freq_ramp=-0.15-m(.2)),this.wave_type===r&&(this.p_duty=1),y(1)?(this.p_duty=m(.5),this.p_duty_ramp=m(.2)):(this.p_duty=.4+m(.5),this.p_duty_ramp=-m(.7)),this.p_env_attack=0,this.p_env_sustain=.1+m(.2),this.p_env_decay=m(.4),y(1)&&(this.p_env_punch=m(.3)),y(2)===0&&(this.p_pha_offset=m(.2),this.p_pha_ramp=-m(.2)),this.p_hpf_freq=m(.3),this},f.prototype.laserShoot=function(){return this.shape=y(2),this.shape===i&&y(1)&&(this.shape=y(1)),y(2)===0?(this.frequency=g(321,2861),this.frequencyMin=m(38.8),this.frequencySlide=g(-27.3,-174.5)):(this.frequency=g(321,3532),this.frequencyMin=g(144,2/3*this.frequency),this.frequencySlide=g(-2.15,-27.27)),this.shape===r&&(this.dutyCycle=0),y(1)?(this.dutyCycle=g(.25,.5),this.dutyCycleSweep=g(0,-3.528)):(this.dutyCycle=g(.05,.3),this.dutyCycleSweep=m(12.35)),this.attack=0,this.sustain=g(.02,.2),this.decay=m(.36),y(1)&&(this.punch=m(.3)),y(2)===0&&(this.flangerOffset=m(.001),this.flangerSweep=-m(.04)),y(1)&&(this.highPassFrequency=m(3204)),this},v.prototype.explosion=function(){return this.wave_type=s,y(1)?(this.p_base_freq=l(.1+m(.4)),this.p_freq_ramp=-0.1+m(.4)):(this.p_base_freq=l(.2+m(.7)),this.p_freq_ramp=-0.2-m(.2)),y(4)===0&&(this.p_freq_ramp=0),y(2)===0&&(this.p_repeat_speed=.3+m(.5)),this.p_env_attack=0,this.p_env_sustain=.1+m(.3),this.p_env_decay=m(.5),y(1)&&(this.p_pha_offset=-0.3+m(.9),this.p_pha_ramp=-m(.3)),this.p_env_punch=.2+m(.6),y(1)&&(this.p_vib_strength=m(.7),this.p_vib_speed=m(.6)),y(2)===0&&(this.p_arp_speed=.6+m(.3),this.p_arp_mod=.8-m(1.6)),this},f.prototype.explosion=function(){return this.shape=s,y(1)?(this.frequency=g(4,224),this.frequencySlide=g(-0.623,17.2)):(this.frequency=g(9,2318),this.frequencySlide=g(-5.1,-40.7)),y(4)===0&&(this.frequencySlide=0),y(2)===0&&(this.retriggerRate=g(4.5,53)),this.attack=0,this.sustain=g(.0227,.363),this.decay=m(.567),y(1)&&(this.flangerOffset=g(-0.0021,.0083),this.flangerSweep=-m(.09)),this.punch=.2+m(.6),y(1)&&(this.vibratoDepth=m(.35),this.vibratoRate=m(24.8)),y(2)===0&&(this.arpeggioFactor=g(.135,2.358),this.arpeggioDelay=g(.00526,.0733)),this},v.prototype.powerUp=function(){return y(1)?(this.wave_type=r,this.p_duty=1):this.p_duty=m(.6),this.p_base_freq=.2+m(.3),y(1)?(this.p_freq_ramp=.1+m(.4),this.p_repeat_speed=.4+m(.4)):(this.p_freq_ramp=.05+m(.2),y(1)&&(this.p_vib_strength=m(.7),this.p_vib_speed=m(.6))),this.p_env_attack=0,this.p_env_sustain=m(.4),this.p_env_decay=.1+m(.4),this},f.prototype.powerUp=function(){return y(1)?(this.shape=r,this.dutyCycle=0):this.dutyCycle=g(.2,.5),this.frequency=g(145,886),y(1)?(this.frequencySlide=g(.636,79.6),this.retriggerRate=g(6,53)):(this.frequencySlide=g(.0795,9.94),y(1)&&(this.vibratoDepth=m(.35),this.vibratoRate=m(24.8))),this.attack=0,this.sustain=m(.363),this.decay=g(.023,.57),this},v.prototype.hitHurt=function(){return this.wave_type=y(2),this.wave_type===i&&(this.wave_type=s),this.wave_type===n&&(this.p_duty=m(.6)),this.wave_type===r&&(this.p_duty=1),this.p_base_freq=.2+m(.6),this.p_freq_ramp=-0.3-m(.4),this.p_env_attack=0,this.p_env_sustain=m(.1),this.p_env_decay=.1+m(.2),y(1)&&(this.p_hpf_freq=m(.3)),this},f.prototype.hitHurt=function(){return this.shape=y(2),this.shape===i&&(this.shape=s),this.shape===n&&(this.dutyCycle=g(.2,.5)),this.shape===r&&(this.dutyCycle=0),this.frequency=g(145,2261),this.frequencySlide=g(-17.2,-217.9),this.attack=0,this.sustain=m(.023),this.decay=g(.023,.2),y(1)&&(this.highPassFrequency=m(3204)),this},v.prototype.jump=function(){return this.wave_type=n,this.p_duty=m(.6),this.p_base_freq=.3+m(.3),this.p_freq_ramp=.1+m(.2),this.p_env_attack=0,this.p_env_sustain=.1+m(.3),this.p_env_decay=.1+m(.2),y(1)&&(this.p_hpf_freq=m(.3)),y(1)&&(this.p_lpf_freq=1-m(.6)),this},f.prototype.jump=function(){return this.shape=n,this.dutyCycle=g(.2,.5),this.frequency=g(321,1274),this.frequencySlide=g(.64,17.2),this.attack=0,this.sustain=g(.023,.36),this.decay=g(.023,.2),y(1)&&(this.highPassFrequency=m(3204)),y(1)&&(this.lowPassFrequency=g(2272,44100)),this},v.prototype.blipSelect=function(){return this.wave_type=y(1),this.wave_type===n?this.p_duty=m(.6):this.p_duty=1,this.p_base_freq=.2+m(.4),this.p_env_attack=0,this.p_env_sustain=.1+m(.1),this.p_env_decay=m(.2),this.p_hpf_freq=.1,this},f.prototype.blipSelect=function(){return this.shape=y(1),this.shape===n?this.dutyCycle=g(.2,.5):this.dutyCycle=0,this.frequency=g(145,1274),this.attack=0,this.sustain=g(.023,.09),this.decay=m(.09),this.highPassFrequency=353,this},v.prototype.mutate=function(){y(1)&&(this.p_base_freq+=m(.1)-.05),y(1)&&(this.p_freq_ramp+=m(.1)-.05),y(1)&&(this.p_freq_dramp+=m(.1)-.05),y(1)&&(this.p_duty+=m(.1)-.05),y(1)&&(this.p_duty_ramp+=m(.1)-.05),y(1)&&(this.p_vib_strength+=m(.1)-.05),y(1)&&(this.p_vib_speed+=m(.1)-.05),y(1)&&(this.p_vib_delay+=m(.1)-.05),y(1)&&(this.p_env_attack+=m(.1)-.05),y(1)&&(this.p_env_sustain+=m(.1)-.05),y(1)&&(this.p_env_decay+=m(.1)-.05),y(1)&&(this.p_env_punch+=m(.1)-.05),y(1)&&(this.p_lpf_resonance+=m(.1)-.05),y(1)&&(this.p_lpf_freq+=m(.1)-.05),y(1)&&(this.p_lpf_ramp+=m(.1)-.05),y(1)&&(this.p_hpf_freq+=m(.1)-.05),y(1)&&(this.p_hpf_ramp+=m(.1)-.05),y(1)&&(this.p_pha_offset+=m(.1)-.05),y(1)&&(this.p_pha_ramp+=m(.1)-.05),y(1)&&(this.p_repeat_speed+=m(.1)-.05),y(1)&&(this.p_arp_speed+=m(.1)-.05),y(1)&&(this.p_arp_mod+=m(.1)-.05)},v.prototype.random=function(){return y(1)?this.p_base_freq=c(m(2)-1)+.5:this.p_base_freq=l(m(1)),this.p_freq_limit=0,this.p_freq_ramp=Math.pow(m(2)-1,5),this.p_base_freq>.7&&this.p_freq_ramp>.2&&(this.p_freq_ramp=-this.p_freq_ramp),this.p_base_freq<.2&&this.p_freq_ramp<-0.05&&(this.p_freq_ramp=-this.p_freq_ramp),this.p_freq_dramp=Math.pow(m(2)-1,3),this.p_duty=m(2)-1,this.p_duty_ramp=Math.pow(m(2)-1,3),this.p_vib_strength=Math.pow(m(2)-1,3),this.p_vib_speed=g(-1,1),this.p_env_attack=c(g(-1,1)),this.p_env_sustain=l(g(-1,1)),this.p_env_decay=g(-1,1),this.p_env_punch=Math.pow(m(.8),2),this.p_env_attack+this.p_env_sustain+this.p_env_decay<.2&&(this.p_env_sustain+=.2+m(.3),this.p_env_decay+=.2+m(.3)),this.p_lpf_resonance=g(-1,1),this.p_lpf_freq=1-Math.pow(m(1),3),this.p_lpf_ramp=Math.pow(m(2)-1,3),this.p_lpf_freq<.1&&this.p_lpf_ramp<-0.05&&(this.p_lpf_ramp=-this.p_lpf_ramp),this.p_hpf_freq=Math.pow(m(1),5),this.p_hpf_ramp=Math.pow(m(2)-1,5),this.p_pha_offset=Math.pow(m(2)-1,3),this.p_pha_ramp=Math.pow(m(2)-1,3),this.p_repeat_speed=m(2)-1,this.p_arp_speed=m(2)-1,this.p_arp_mod=m(2)-1,this},f.prototype.random=function(){return y(1)?this.frequency=g(885.5,7941.5):this.frequency=g(3.5,3532),this.frequencySlide=g(-633,639),this.frequency>1732&&this.frequencySlide>5&&(this.frequencySlide=-this.frequencySlide),this.frequency<145&&this.frequencySlide<-0.088&&(this.frequencySlide=-this.frequencySlide),this.frequencySlideSlide=g(-0.88,.88),this.dutyCycle=m(1),this.dudyCycleSweep=g(-17.64,17.64),this.vibratoDepth=g(-0.5,.5),this.vibratoRate=g(0,69),this.attack=c(m(1))*2.26,this.sustain=l(m(1))*2.26+.09,this.decay=m(1)*2.26,this.punch=l(m(1))*.64,this.attack+this.sustain+this.decay<.45&&(this.sustain+=g(.5,1.25),this.decay+=g(.5,1.25)),this.lowPassResonance=g(.444,.97),this.lowPassFrequency=m(39200),this.lowPassSweep=g(.012,82),this.lowPassFrequency<35&&this.lowPassSweep<.802&&(this.lowPassSweep=1-this.lowPassSweep),this.highPassFrequency=39200*d(m(1),5),this.highPassSweep=555718*d(g(-1,1),5),this.flangerOffset=.023*c(m(2)-1),this.flangerSweep=c(m(2)-1),this.retriggerRate=m(1378),this.arpeggioDelay=m(1.81),this.arpeggioFactor=g(.09,10),this},v.prototype.tone=function(){return this.wave_type=i,this.p_base_freq=.35173364,this.p_env_attack=0,this.p_env_sustain=.6641,this.p_env_decay=0,this.p_env_punch=0,this},b.prototype.initFromUI=function(e){this.initForRepeat=function(){this.elapsedSinceRepeat=0,this.period=100/(e.p_base_freq*e.p_base_freq+.001),this.periodMax=100/(e.p_freq_limit*e.p_freq_limit+.001),this.enableFrequencyCutoff=e.p_freq_limit>0,this.periodMult=1-Math.pow(e.p_freq_ramp,3)*.01,this.periodMultSlide=-Math.pow(e.p_freq_dramp,3)*1e-6,this.dutyCycle=.5-e.p_duty*.5,this.dutyCycleSlide=-e.p_duty_ramp*5e-5,e.p_arp_mod>=0?this.arpeggioMultiplier=1-Math.pow(e.p_arp_mod,2)*.9:this.arpeggioMultiplier=1+Math.pow(e.p_arp_mod,2)*10,this.arpeggioTime=Math.floor(Math.pow(1-e.p_arp_speed,2)*2e4+32),e.p_arp_speed===1&&(this.arpeggioTime=0)},this.initForRepeat(),this.waveShape=parseInt(e.wave_type),this.fltw=Math.pow(e.p_lpf_freq,3)*.1,this.enableLowPassFilter=e.p_lpf_freq!=1,this.fltw_d=1+e.p_lpf_ramp*1e-4,this.fltdmp=5/(1+Math.pow(e.p_lpf_resonance,2)*20)*(.01+this.fltw),this.fltdmp>.8&&(this.fltdmp=.8),this.flthp=Math.pow(e.p_hpf_freq,2)*.1,this.flthp_d=1+e.p_hpf_ramp*3e-4,this.vibratoSpeed=Math.pow(e.p_vib_speed,2)*.01,this.vibratoAmplitude=e.p_vib_strength*.5,this.envelopeLength=[Math.floor(e.p_env_attack*e.p_env_attack*1e5),Math.floor(e.p_env_sustain*e.p_env_sustain*1e5),Math.floor(e.p_env_decay*e.p_env_decay*1e5)],this.envelopePunch=e.p_env_punch,this.flangerOffset=Math.pow(e.p_pha_offset,2)*1020,e.p_pha_offset<0&&(this.flangerOffset=-this.flangerOffset),this.flangerOffsetSlide=Math.pow(e.p_pha_ramp,2)*1,e.p_pha_ramp<0&&(this.flangerOffsetSlide=-this.flangerOffsetSlide),this.repeatTime=Math.floor(Math.pow(1-e.p_repeat_speed,2)*2e4+32),e.p_repeat_speed===0&&(this.repeatTime=0),this.gain=Math.exp(e.sound_vol)-1,this.sampleRate=e.sample_rate,this.bitsPerChannel=e.sample_size;for(var t in this)typeof this[t]!="function"&&console.log(t,this[t])},b.prototype.init=function(e){this.initForRepeat=function(){this.elapsedSinceRepeat=0,this.period=u*44100/e.frequency,this.periodMax=u*44100/e.frequencyMin,this.enableFrequencyCutoff=e.frequencyMin>0,this.periodMult=Math.pow(.5,e.frequencySlide/44100),this.periodMultSlide=e.frequencySlideSlide*Math.pow(2,-44101/44100)/44100,this.dutyCycle=e.dutyCycle,this.dutyCycleSlide=e.dutyCycleSweep/(u*44100),this.arpeggioMultiplier=1/e.arpeggioFactor,this.arpeggioTime=e.arpeggioDelay*44100},this.initForRepeat(),this.waveShape=e.shape,this.fltw=e.lowPassFrequency/(u*44100+e.lowPassFrequency),this.enableLowPassFilter=e.lowPassFrequency<44100,this.fltw_d=Math.pow(e.lowPassSweep,1/44100),this.fltdmp=(1-e.lowPassResonance)*9*(.01+this.fltw),this.flthp=e.highPassFrequency/(u*44100+e.highPassFrequency),this.flthp_d=Math.pow(e.highPassSweep,1/44100),this.vibratoSpeed=e.vibratoRate*64/44100/10,this.vibratoAmplitude=e.vibratoDepth,this.envelopeLength=[Math.floor(e.attack*44100),Math.floor(e.sustain*44100),Math.floor(e.decay*44100)],this.envelopePunch=e.punch,this.flangerOffset=e.flangerOffset*44100,this.flangerOffsetSlide=e.flangerSweep,this.repeatTime=e.retriggerRate?1/(44100*e.retriggerRate):0,this.gain=Math.sqrt(Math.pow(10,e.gain/10)),this.sampleRate=e.sampleRate,this.bitsPerChannel=e.sampleSize},b.prototype.generate=function(){var e=0,t=0,a=0,f=Array(32);for(var l=0;l<32;++l)f[l]=Math.random
()*2-1;var c=0,h=0,p=0,d=0,v=0,m=Array(1024);for(var l=0;l<1024;++l)m[l]=0;var g=0,y=[],b=0,w=0,E=Math.floor(44100/this.sampleRate);for(var x=0;;++x){this.repeatTime!=0&&++this.elapsedSinceRepeat>=this.repeatTime&&this.initForRepeat(),this.arpeggioTime!=0&&x>=this.arpeggioTime&&(this.arpeggioTime=0,this.period*=this.arpeggioMultiplier),this.periodMult+=this.periodMultSlide,this.period*=this.periodMult;if(this.period>this.periodMax){this.period=this.periodMax;if(this.enableFrequencyCutoff)break}var T=this.period;this.vibratoAmplitude>0&&(p+=this.vibratoSpeed,T=this.period*(1+Math.sin(p)*this.vibratoAmplitude));var N=Math.floor(T);N<u&&(N=u),this.dutyCycle+=this.dutyCycleSlide,this.dutyCycle<0&&(this.dutyCycle=0),this.dutyCycle>.5&&(this.dutyCycle=.5);if(++h>this.envelopeLength[c]){h=0;if(++c>2)break}var C,k=h/this.envelopeLength[c];c===0?C=k:c===1?C=1+(1-k)*2*this.envelopePunch:C=1-k,this.flangerOffset+=this.flangerOffsetSlide;var L=Math.abs(Math.floor(this.flangerOffset));L>1023&&(L=1023),this.flthp_d!=0&&(this.flthp*=this.flthp_d,this.flthp<1e-5&&(this.flthp=1e-5),this.flthp>.1&&(this.flthp=.1));var A=0;for(var O=0;O<u;++O){var M=0;d++;if(d>=N){d%=N;if(this.waveShape===s)for(var l=0;l<32;++l)f[l]=Math.random()*2-1}var _=d/N;if(this.waveShape===n)_<this.dutyCycle?M=.5:M=-0.5;else if(this.waveShape===r)_<this.dutyCycle?M=-1+2*_/this.dutyCycle:M=1-2*(_-this.dutyCycle)/(1-this.dutyCycle);else if(this.waveShape===i)M=Math.sin(_*2*Math.PI);else{if(this.waveShape!==s)throw"ERROR: Bad wave type: "+this.waveShape;M=f[Math.floor(d*32/N)]}var D=e;this.fltw*=this.fltw_d,this.fltw<0&&(this.fltw=0),this.fltw>.1&&(this.fltw=.1),this.enableLowPassFilter?(t+=(M-e)*this.fltw,t-=t*this.fltdmp):(e=M,t=0),e+=t,a+=e-D,a-=a*this.flthp,M=a,m[v&1023]=M,M+=m[v-L+1024&1023],v=v+1&1023,A+=M*C}b+=A;if(!(++w>=E))continue;w=0,A=b/E,b=0,A=A/u*o,A*=this.gain,this.bitsPerChannel===8?(A=Math.floor((A+1)*128),A>255?(A=255,++g):A<0&&(A=0,++g),y.push(A)):(A=Math.floor(A*32768),A>=32768?(A=32767,++g):A<-32768&&(A=-32768,++g),y.push(A&255),y.push(A>>8&255))}var P=new S;return P.header.sampleRate=this.sampleRate,P.header.bitsPerSample=this.bitsPerChannel,P.Make(y),P.clipping=g,P},f.prototype.tone=function(){return this.shape=i,this.frequency=440,this.attack=0,this.sustain=1,this.decay=0,this};var w="pickupCoin,laserShoot,explosion,powerUp,hitHurt,jump,blipSelect,random,tone".split(",");for(var E=0;E<w.length;++E)(function(e){f.prototype[e]||(f.prototype[e]=function(){return this.translate((new v)[e]())})})(w[E]);if(typeof e!="undefined"){var S=t("./riffwave").RIFFWAVE;e.Params=v,e.Knobs=f,e.SoundEffect=b,e.SQUARE=n,e.SAWTOOTH=r,e.SINE=i,e.NOISE=s}}(),e}(),Bs=function(e){"use strict";function r(){switch(u){case 0:u=1;break;case 1:break;case 2:n.poke=!1,u=0;break;case 3:break;default:}}function i(){switch(u){case 0:break;case 1:n.poke=!0,u=2;break;case 2:case 3:n.drag=n.poke=!1,u=0;break;default:}}function s(){switch(u){case 0:break;case 1:break;case 2:n.poke=!1,u=0;break;case 3:break;default:}}function o(){switch(u){case 0:break;case 1:var e=f-c,t=l-h;Math.sqrt(e*e+t*t)>3&&(n.dragDirection.x=e,n.dragDirection.y=t,n.drag=!0,u=3);break;case 2:n.poke=!1,u=0;break;case 3:var e=f-c,t=l-h;n.dragDirection.x=e,n.dragDirection.y=t;break;default:}}var n=this,u=0,a=!1,f=0,l=0,c=0,h=0;e.onmousedown=r,e.onmouseup=e.onmouseout=t.onblur=i,e.onmousemove=function(e){f=c,l=h,c=e.x,h=e.y,o()},n.update=s,n.drag=!1,n.poke=!1,n.dragDirection={x:0,y:0}},js=Float32Array,io=function(){function t(t,n){"use strict";var r=8,i=0,s=Js(),o=Js(),u=0;this.tick=function(n){switch(i){case 0:break;case 1:Ks(t.position,Qs(s,n.delta*r,e)),u+=n.delta*r,u>=1&&($s(Ks(o,s,e),t.position),i=0,u=0,this.tap(n,s));break;default:}},this.tap=function(e,r){switch(i){case 1:break;case 0:var a=Math.round(t.position[0]+r[0]),f=Math.round(t.position[1]+r[1]),l=Math.round(t.position[2]+r[2]),c=n.getObject(a,f,l);if(c===0){$s(r,s),$s(t.position,o),u=0,i=1;break}c!==-1,c!==3;break;default:}}}var e=Js();return function(e,n){this.position=Js([e.x,e.y,e.z]);var r=new t(this,n);this.tap=function(e,t){r.tap(e,t)},this.tick=function(e){r.tick(e,n)}}}(),so;!function(){"use strict";function t(e,t){this.x=e,this.y=t,this.toString=function(){return"["+e+", "+t+"]"}}so=function(){function i(e,n,r){if(n<0)switch(e){case 0:return i(1,r,-n-1);case 1:return i(5,-n-1,15-r);case 2:return i(1,n+16,r);case 3:return i(2,n+16,r);case 4:return i(1,15-r,16+n);case 5:return i(1,-n-1,15-r);default:throw new RangeError}if(r<0)switch(e){case 0:return i(5,n,16+r);case 1:return i(0,-r-1,n);case 2:return i(0,n,16+r);case 3:return i(0,16+r,15-n);case 4:return i(2,n,16+r);case 5:return i(4,n,16+r);default:throw new RangeError}if(n>=16)switch(e){case 0:return i(3,15-r,n-16);case 1:return i(2,n-16,r);case 2:return i(3,n-16,r);case 3:return i(5,31-n,15-r);case 4:return i(3,r,31-n);case 5:return i(3,31-n,15-r);default:throw new RangeError}if(r>=16)switch(e){case 0:return i(2,n,r-16);case 1:return i(4,r-16,15-n);case 2:return i(4,n,r-16);case 3:return i(4,31-r,n);case 4:return i(5,n,r-16);case 5:return i(0,n,r-16);default:throw new RangeError}switch(e){case 0:return new t(n+16,r);case 1:return new t(n,r+16);case 2:return new t(n+16,r+16);case 3:return new t(n+32,r+16);case 4:return new t(n+16,r+32);case 5:return new t(n+16,r+48);default:throw new RangeError}}var n=e.createElement("canvas");n.width=n.height=64;var r=n.getContext("2d");this.getCanvasCoordinate=i,this.canvas=n,this.ctx=r}}();var oo,uo,ao,fo,lo,co,ho,po,vo,mo,go,yo,bo,wo=new so,Eo=e.getElementsByTagName("canvas")[0],So=Ps.createContext(Eo),xo=So.attachShader.bind(So),To=So.bindBuffer.bind(So),No=So.bindTexture.bind(So),Co=So.bufferData.bind(So),ko=So.clear.bind(So),Lo=So.clearColor.bind(So),Ao=So.compileShader.bind(So),Oo=So.createBuffer.bind(So),Mo=So.createProgram.bind(So),_o=So.createShader.bind(So),Do=So.createTexture.bind(So),Po=So.disable.bind(So),Ho=So.drawArrays.bind(So),Bo=So.enable.bind(So),jo=So.enableVertexAttribArray.bind(So),Fo=So.getAttribLocation.bind(So),Io=So.getProgramInfoLog.bind(So),qo=So.getShaderInfoLog.bind(So),Ro=So.getUniformLocation.bind(So),Uo=So.lineWidth.bind(So),zo=So.linkProgram.bind(So),Wo=So.pixelStorei.bind(So),Xo=So.shaderSource.bind(So),Vo=So.texImage2D.bind(So),$o=So.texParameteri.bind(So),Jo=So.uniform1i.bind(So),Ko=So.uniformMatrix4fv.bind(So),Qo=So.useProgram.bind(So),Go=So.vertexAttribPointer.bind(So),Yo=So.viewport.bind(So),Zo=new Bs(Eo),eu=Ws(60,Eo.width/Eo.height,.1,1e3),tu=Js(),nu=Js(),ru=Js([0,1,0]),iu=Is(),su=Fs(),ou=null,uu=null,au=Js([1,0,0]),fu=Js([0,1,0]),lu=Js([0,0,1]),cu=0,hu=0,pu=0,du=[Js([0,0,0]),Js([1,0,0]),Js([0,1,0]),Js([0,0,1]),Js([0,0,-1]),Js([0,-1,0]),Js([-1,0,0])],vu=[],mu=Js(),gu=!1,yu=null,bu=!1,wu=null,Eu={x:0,y:0},ku=function(){var e=Js([-1,0,0]),t=Js([0,-1,0]),n=Js([0,0,-1]),r=[au,e,fu,t,lu,n],i=Js(),s=Js();return function(e){$s(e,i),Gs(i);var t=99999,n=-1;for(var o=0;o!==6;o++){var u=r[o];Vs(i,u,s);var a=Zs(s);t>a&&(t=a,n=o)}return r[[1,0,3,2,5,4][n]]}}();Ps.loadmanager.loadFiles({files:["cube.obj","sphere.obj","diffuse.shader","cube.png","skybox.obj","border.shader","goal.obj"],update:function(e,t){},error:function(e,t){},finished:function(e){oo=e["cube.obj"],fo=e["skybox.obj"],uo=e["sphere.obj"],lo=e["goal.obj"],ho=Ps.shader.compileProgram(So,e["diffuse.shader"]),po=Ps.shader.compileProgram(So,e["border.shader"]),ou=Bu(e["cube.png"]),uu=Bu(wo.canvas);var t=10,n=new Int32Array(t),r=new Int32Array(t),i=new Int32Array(t),s=new Int32Array(t);for(var o=0;o!==t;o++)n[o]=Math.random()*16|0,r[o]=Math.random()*16|0,i[o]=Math.random()*2|0,s[o]=Math.random()*6|0;setInterval(function(){wo.ctx.beginPath(),wo.ctx.fillStyle="#000000",wo.ctx.globalAlpha=.2,wo.ctx.rect(0,0,64,64),wo.ctx.fill(),wo.ctx.globalAlpha=1;for(var e=0;e!==t;e++){var o=n[e],u=r[e],a=i[e],f=s[e],l=wo.getCanvasCoordinate(f,o,u);wo.ctx.beginPath(),wo.ctx.fillStyle="#FF0000",wo.ctx.rect(l.x,l.y,1,1),wo.ctx.fill(),a?n[e]++:r[e]++}Hu(wo.canvas,uu)},100);var u=65535*Math.random()&65535;bo=ro(u);for(var a=0;a!==16;a++)for(var f=0;f!==16;f++)for(var l=0;l!==16;l++){var c=bo.getObject(a,f,l);c===1?vu.push({vector:Js([a,f,l])}):c===3&&(mu[0]=a,mu[1]=f,mu[2]=l)}nu[0]=bo.startingPosition.x,nu[1]=bo.startingPosition.x,nu[2]=bo.startingPosition.x,ao=new io({x:nu[0],y:nu[1],z:nu[2]},bo),$s(nu,tu),tu[0]=0,tu[1]=0,tu[2]=20,Nu(),Su(),Ps.requestGameFrame(Cu);var h={oldParams:!0,wave_type:3,p_env_attack:0,p_env_sustain:.3507373180706054,p_env_punch:.7507036675233394,p_env_decay:.1148287485120818,p_base_freq:.030365511453751274,p_freq_limit:0,p_freq_ramp:0,p_freq_dramp:0,p_vib_strength:0,p_vib_speed:0,p_arp_mod:0,p_arp_speed:0,p_duty:0,p_duty_ramp:0,p_repeat_speed:.7296395279234276,p_pha_offset:-0.2251016782131046,p_pha_ramp:-0.2945099702104926,p_lpf_freq:1,p_lpf_ramp:0,p_lpf_resonance:0,p_hpf_freq:0,p_hpf_ramp:0,sound_vol:.25,sample_rate:44100,sample_size:8},p={oldParams:!0,wave_type:0,p_env_attack:-0.031099240445367497,p_env_sustain:.7635753833033847,p_env_punch:.2816417110611466,p_env_decay:-0.6867234703619033,p_base_freq:-0.05417757730129136,p_freq_limit:0,p_freq_ramp:.366020674391696,p_freq_dramp:.061304970543220046,p_vib_strength:-0.13391388831049597,p_vib_speed:-0.08958338294178247,p_arp_mod:.7950661345385015,p_arp_speed:.5519341775216162,p_duty:.6044134241528809,p_duty_ramp:.8909097971481785,p_repeat_speed:.2607004144228995,p_pha_offset:-0.00018430166566930404,p_pha_ramp:.8547329901213455,p_lpf_freq:.9224470124042238,p_lpf_ramp:.007261712532774577,p_lpf_resonance:.8195562218315899,p_hpf_freq:2.3264287110167006e-7,p_hpf_ramp:-0.6950668630055059,sound_vol:.25,sample_rate:44100,sample_size:8},d={oldParams:!0,wave_type:0,p_env_attack:-0.018341900495896277,p_env_sustain:.3757311985941444,p_env_punch:-0.003057873247569856,p_env_decay:.06331000293139369,p_base_freq:.1656650181731793,p_freq_limit:0,p_freq_ramp:-0.0589514924457087,p_freq_dramp:.030146547487526147,p_vib_strength:-0.019250509277321262,p_vib_speed:.5508432540111242,p_arp_mod:.8034108052030207,p_arp_speed:.16075012690853327,p_duty:-0.04733387050218882,p_duty_ramp:.46016203196294625,p_repeat_speed:-0.17416390222497286,p_pha_offset:.14307537902977768,p_pha_ramp:-0.421786501233935,p_lpf_freq:.41369926108195854,p_lpf_ramp:-0.2612435719273578,p_lpf_resonance:-0.9390350750647485,p_hpf_freq:.16551226912858946,p_hpf_ramp:-0.10125760095251089,sound_vol:.25,sample_rate:44100,sample_size:8,p_vib_delay:null},v={oldParams:!0,wave_type:0,p_env_attack:-0.004527911166038838,p_env_sustain:.840333883056117,p_env_punch:.32125634341977,p_env_decay:.8337062487844378,p_base_freq:.9230462823158505,p_freq_limit:0,p_freq_ramp:.054141002534628405,p_freq_dramp:.028436068801879585,p_vib_strength:.05286053257716272,p_vib_speed:.7490090135484934,p_arp_mod:.002945324592292308,p_arp_speed:-0.2514595840359107,p_duty:-0.538211698899977,p_duty_ramp:-0.02350955880296343,p_repeat_speed:-0.3621571579016745,p_pha_offset:.05005980333720715,p_pha_ramp:.03782556013502259,p_lpf_freq:.9357535395725334,p_lpf_ramp:-0.7541079941455712,p_lpf_resonance:.6400827742181718,p_hpf_freq:1.0007283491126555,p_hpf_ramp:.42763103001397496,sound_vol:.25,sample_rate:44100,sample_size:8,p_vib_delay:null},m=(new Hs.SoundEffect(p)).generate(),g=new Audio;g.src=m.dataURI}})}(document,this);