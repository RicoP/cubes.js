function Hammer(e,t,n){function x(e){return e.touches?e.touches.length:1}function T(e){e=e||window.event;if(!S){var t=document,n=t.body;return[{x:e.pageX||e.clientX+(t&&t.scrollLeft||n&&n.scrollLeft||0)-(t&&t.clientLeft||n&&t.clientLeft||0),y:e.pageY||e.clientY+(t&&t.scrollTop||n&&n.scrollTop||0)-(t&&t.clientTop||n&&t.clientTop||0)}]}var r=[],i,s=e.touches.length>0?e.touches:e.changedTouches;for(var o=0,u=s.length;o<u;o++)i=s[o],r.push({x:i.pageX,y:i.pageY});return r}function N(e,t){return Math.atan2(t.y-e.y,t.x-e.x)*180/Math.PI}function C(e,t){if(e.length==2&&t.length==2){var n,r;n=e[0].x-e[1].x,r=e[0].y-e[1].y;var i=Math.sqrt(n*n+r*r);n=t[0].x-t[1].x,r=t[0].y-t[1].y;var s=Math.sqrt(n*n+r*r);return s/i}return 0}function k(e,t){if(e.length==2&&t.length==2){var n,r;n=e[0].x-e[1].x,r=e[0].y-e[1].y;var i=Math.atan2(r,n)*180/Math.PI;n=t[0].x-t[1].x,r=t[0].y-t[1].y;var s=Math.atan2(r,n)*180/Math.PI;return s-i}return 0}function L(e,t){t.touches=T(t.originalEvent),t.type=e,H(r["on"+e])&&r["on"+e].call(r,t)}function A(e){e=e||window.event,e.preventDefault?(e.preventDefault(),e.stopPropagation()):(e.returnValue=!1,e.cancelBubble=!0)}function O(){a={},l=!1,f=0,s=0,o=0,c=null}function _(n){switch(n.type){case"mousedown":case"touchstart":a.start=T(n),p=(new Date).getTime(),f=x(n),l=!0,b=n;var r=e.getBoundingClientRect(),i=e.clientTop||document.body.clientTop||0,d=e.clientLeft||document.body.clientLeft||0,v=window.pageYOffset||e.scrollTop||document.body.scrollTop,m=window.pageXOffset||e.scrollLeft||document.body.scrollLeft;g={top:r.top+v-i,left:r.left+m-d},y=!0,M.hold(n),t.prevent_default&&A(n);break;case"mousemove":case"touchmove":if(!y)return!1;w=n,a.move=T(n),M.transform(n)||M.drag(n);break;case"mouseup":case"mouseout":case"touchcancel":case"touchend":if(!y||c!="transform"&&n.touches&&n.touches.length>0)return!1;y=!1,E=n;var S=c=="drag";M.swipe(n),S?L("dragend",{originalEvent:n,direction:u,distance:s,angle:o}):c=="transform"?L("transformend",{originalEvent:n,position:a.center,scale:C(a.start,a.move),rotation:k(a.start,a.move)}):M.tap(b),h=c,L("release",{originalEvent:n,gesture:c}),O()}}function D(e,t){!t&&window.event&&window.event.toElement&&(t=window.event.toElement);if(e===t)return!0;if(t){var n=t.parentNode;while(n!==null){if(n===e)return!0;n=n.parentNode}}return!1}function P(e,t){var n={};if(!t)return e;for(var r in e)r in t?n[r]=t[r]:n[r]=e[r];return n}function H(e){return Object.prototype.toString.call(e)=="[object Function]"}function B(e,t,n){t=t.split(" ");for(var r=0,i=t.length;r<i;r++)e.addEventListener?e.addEventListener(t[r],n,!1):document.attachEvent&&e.attachEvent("on"+t[r],n)}var r=this,i={prevent_default:!1,css_hacks:!0,swipe:!0,swipe_time:200,swipe_min_distance:20,drag:!0,drag_vertical:!0,drag_horizontal:!0,drag_min_distance:20,transform:!0,scale_treshold:.1,rotation_treshold:15,tap:!0,tap_double:!0,tap_max_interval:300,tap_max_distance:10,tap_double_distance:20,hold:!0,hold_timeout:500};t=P(i,t),function(){if(!t.css_hacks)return!1;var n=["webkit","moz","ms","o",""],r={userSelect:"none",touchCallout:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"},i="";for(var s=0;s<n.length;s++)for(var o in r)i=o,n[s]&&(i=n[s]+i.substring(0,1).toUpperCase()+i.substring(1)),e.style[i]=r[o]}();var s=0,o=0,u=0,a={},f=0,l=!1,c=null,h=null,p=null,d={x:0,y:0},v=null,m=null,g={},y=!1,b,w,E,S="ontouchstart"in window;this.option=function(e,r){return r!=n&&(t[e]=r),t[e]},this.getDirectionFromAngle=function(e){var t={down:e>=45&&e<135,left:e>=135||e<=-135,up:e<-45&&e>-135,right:e>=-45&&e<=45},n,r;for(r in t)if(t[r]){n=r;break}return n};var M={hold:function(e){t.hold&&(c="hold",clearTimeout(m),m=setTimeout(function(){c=="hold"&&L("hold",{originalEvent:e,position:a.start})},t.hold_timeout))},swipe:function(e){if(!a.move)return;var n=a.move[0].x-a.start[0].x,i=a.move[0].y-a.start[0].y;s=Math.sqrt(n*n+i*i);var f=(new Date).getTime(),l=f-p;if(t.swipe&&t.swipe_time>l&&s>t.swipe_min_distance){o=N(a.start[0],a.move[0]),u=r.getDirectionFromAngle(o),c="swipe";var h={x:a.move[0].x-g.left,y:a.move[0].y-g.top},d={originalEvent:e,position:h,direction:u,distance:s,distanceX:n,distanceY:i,angle:o};L("swipe",d)}},drag:function(e){var n=a.move[0].x-a.start[0].x,i=a.move[0].y-a.start[0].y;s=Math.sqrt(n*n+i*i);if(t.drag&&s>t.drag_min_distance||c=="drag"){o=N(a.start[0],a.move[0]),u=r.getDirectionFromAngle(o);var f=u=="up"||u=="down";if((f&&!t.drag_vertical||!f&&!t.drag_horizontal)&&s>t.drag_min_distance)return;c="drag";var h={x:a.move[0].x-g.left,y:a.move[0].y-g.top},p={originalEvent:e,position:h,direction:u,distance:s,distanceX:n,distanceY:i,angle:o};l&&(L("dragstart",p),l=!1),L("drag",p),A(e)}},transform:function(e){if(t.transform){if(x(e)!=2)return!1;var n=k(a.start,a.move),r=C(a.start,a.move);if(c!="drag"&&(c=="transform"||Math.abs(1-r)>t.scale_treshold||Math.abs(n)>t.rotation_treshold)){c="transform",a.center={x:(a.move[0].x+a.move[1].x)/2-g.left,y:(a.move[0].y+a.move[1].y)/2-g.top};var i={originalEvent:e,position:a.center,scale:r,rotation:n};return l&&(L("transformstart",i),l=!1),L("transform",i),A(e),!0}}return!1},tap:function(e){var n=(new Date).getTime(),r=n-p;if(t.hold&&!(t.hold&&t.hold_timeout>r))return;var i=function(){if(d&&t.tap_double&&h=="tap"&&p-v<t.tap_max_interval){var e=Math.abs(d[0].x-a.start[0].x),n=Math.abs(d[0].y-a.start[0].y);return d&&a.start&&Math.max(e,n)<t.tap_double_distance}return!1}();if(i)c="double_tap",v=null,L("doubletap",{originalEvent:e,position:a.start}),A(e);else{var o=a.move?Math.abs(a.move[0].x-a.start[0].x):0,u=a.move?Math.abs(a.move[0].y-a.start[0].y):0;s=Math.max(o,u),s<t.tap_max_distance&&(c="tap",v=n,d=a.start,t.tap&&(L("tap",{originalEvent:e,position:a.start}),A(e)))}}};S?B(e,"touchstart touchmove touchend touchcancel",_):(B(e,"mouseup mousedown mousemove",_),B(e,"mouseout",function(t){D(e,t.relatedTarget)||_(t)}))}function __error(e,t,n){throw new Error(e+"("+t+":"+n+")")}function Id(e){"use strict";this.asNumber=function(){return e},this.asColor=function(){var t,n,r;return r=e%128/128,n=(e>>7)%128/128,t=(e>>14)%128/128,[t,n,r]}}var GL_DEPTH_BUFFER_BIT=256,GL_STENCIL_BUFFER_BIT=1024,GL_COLOR_BUFFER_BIT=16384,GL_POINTS=0,GL_LINES=1,GL_LINE_LOOP=2,GL_LINE_STRIP=3,GL_TRIANGLES=4,GL_TRIANGLE_STRIP=5,GL_TRIANGLE_FAN=6,GL_ZERO=0,GL_ONE=1,GL_SRC_COLOR=768,GL_ONE_MINUS_SRC_COLOR=769,GL_SRC_ALPHA=770,GL_ONE_MINUS_SRC_ALPHA=771,GL_DST_ALPHA=772,GL_ONE_MINUS_DST_ALPHA=773,GL_DST_COLOR=774,GL_ONE_MINUS_DST_COLOR=775,GL_SRC_ALPHA_SATURATE=776,GL_FUNC_ADD=32774,GL_BLEND_EQUATION=32777,GL_BLEND_EQUATION_RGB=32777,GL_BLEND_EQUATION_ALPHA=34877,GL_FUNC_SUBTRACT=32778,GL_FUNC_REVERSE_SUBTRACT=32779,GL_BLEND_DST_RGB=32968,GL_BLEND_SRC_RGB=32969,GL_BLEND_DST_ALPHA=32970,GL_BLEND_SRC_ALPHA=32971,GL_CONSTANT_COLOR=32769,GL_ONE_MINUS_CONSTANT_COLOR=32770,GL_CONSTANT_ALPHA=32771,GL_ONE_MINUS_CONSTANT_ALPHA=32772,GL_BLEND_COLOR=32773,GL_ARRAY_BUFFER=34962,GL_ELEMENT_ARRAY_BUFFER=34963,GL_ARRAY_BUFFER_BINDING=34964,GL_ELEMENT_ARRAY_BUFFER_BINDING=34965,GL_STREAM_DRAW=35040,GL_STATIC_DRAW=35044,GL_DYNAMIC_DRAW=35048,GL_BUFFER_SIZE=34660,GL_BUFFER_USAGE=34661,GL_CURRENT_VERTEX_ATTRIB=34342,GL_FRONT=1028,GL_BACK=1029,GL_FRONT_AND_BACK=1032,GL_TEXTURE_2D=3553,GL_CULL_FACE=2884,GL_BLEND=3042,GL_DITHER=3024,GL_STENCIL_TEST=2960,GL_DEPTH_TEST=2929,GL_SCISSOR_TEST=3089,GL_POLYGON_OFFSET_FILL=32823,GL_SAMPLE_ALPHA_TO_COVERAGE=32926,GL_SAMPLE_COVERAGE=32928,GL_NO_ERROR=0,GL_INVALID_ENUM=1280,GL_INVALID_VALUE=1281,GL_INVALID_OPERATION=1282,GL_OUT_OF_MEMORY=1285,GL_CW=2304,GL_CCW=2305,GL_LINE_WIDTH=2849,GL_ALIASED_POINT_SIZE_RANGE=33901,GL_ALIASED_LINE_WIDTH_RANGE=33902,GL_CULL_FACE_MODE=2885,GL_FRONT_FACE=2886,GL_DEPTH_RANGE=2928,GL_DEPTH_WRITEMASK=2930,GL_DEPTH_CLEAR_VALUE=2931,GL_DEPTH_FUNC=2932,GL_STENCIL_CLEAR_VALUE=2961,GL_STENCIL_FUNC=2962,GL_STENCIL_FAIL=2964,GL_STENCIL_PASS_DEPTH_FAIL=2965,GL_STENCIL_PASS_DEPTH_PASS=2966,GL_STENCIL_REF=2967,GL_STENCIL_VALUE_MASK=2963,GL_STENCIL_WRITEMASK=2968,GL_STENCIL_BACK_FUNC=34816,GL_STENCIL_BACK_FAIL=34817,GL_STENCIL_BACK_PASS_DEPTH_FAIL=34818,GL_STENCIL_BACK_PASS_DEPTH_PASS=34819,GL_STENCIL_BACK_REF=36003,GL_STENCIL_BACK_VALUE_MASK=36004,GL_STENCIL_BACK_WRITEMASK=36005,GL_VIEWPORT=2978,GL_SCISSOR_BOX=3088,GL_COLOR_CLEAR_VALUE=3106,GL_COLOR_WRITEMASK=3107,GL_UNPACK_ALIGNMENT=3317,GL_PACK_ALIGNMENT=3333,GL_MAX_TEXTURE_SIZE=3379,GL_MAX_VIEWPORT_DIMS=3386,GL_SUBPIXEL_BITS=3408,GL_RED_BITS=3410,GL_GREEN_BITS=3411,GL_BLUE_BITS=3412,GL_ALPHA_BITS=3413,GL_DEPTH_BITS=3414,GL_STENCIL_BITS=3415,GL_POLYGON_OFFSET_UNITS=10752,GL_POLYGON_OFFSET_FACTOR=32824,GL_TEXTURE_BINDING_2D=32873,GL_SAMPLE_BUFFERS=32936,GL_SAMPLES=32937,GL_SAMPLE_COVERAGE_VALUE=32938,GL_SAMPLE_COVERAGE_INVERT=32939,GL_NUM_COMPRESSED_TEXTURE_FORMATS=34466,GL_COMPRESSED_TEXTURE_FORMATS=34467,GL_DONT_CARE=4352,GL_FASTEST=4353,GL_NICEST=4354,GL_GENERATE_MIPMAP_HINT=33170,GL_BYTE=5120,GL_UNSIGNED_BYTE=5121,GL_SHORT=5122,GL_UNSIGNED_SHORT=5123,GL_INT=5124,GL_UNSIGNED_INT=5125,GL_FLOAT=5126,GL_DEPTH_COMPONENT=6402,GL_ALPHA=6406,GL_RGB=6407,GL_RGBA=6408,GL_LUMINANCE=6409,GL_LUMINANCE_ALPHA=6410,GL_UNSIGNED_SHORT_4_4_4_4=32819,GL_UNSIGNED_SHORT_5_5_5_1=32820,GL_UNSIGNED_SHORT_5_6_5=33635,GL_FRAGMENT_SHADER=35632,GL_VERTEX_SHADER=35633,GL_MAX_VERTEX_ATTRIBS=34921,GL_MAX_VERTEX_UNIFORM_VECTORS=36347,GL_MAX_VARYING_VECTORS=36348,GL_MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,GL_MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,GL_MAX_TEXTURE_IMAGE_UNITS=34930,GL_MAX_FRAGMENT_UNIFORM_VECTORS=36349,GL_SHADER_TYPE=35663,GL_DELETE_STATUS=35712,GL_LINK_STATUS=35714,GL_VALIDATE_STATUS=35715,GL_ATTACHED_SHADERS=35717,GL_ACTIVE_UNIFORMS=35718,GL_ACTIVE_UNIFORM_MAX_LENGTH=35719,GL_ACTIVE_ATTRIBUTES=35721,GL_ACTIVE_ATTRIBUTE_MAX_LENGTH=35722,GL_SHADING_LANGUAGE_VERSION=35724,GL_CURRENT_PROGRAM=35725,GL_NEVER=512,GL_LESS=513,GL_EQUAL=514,GL_LEQUAL=515,GL_GREATER=516,GL_NOTEQUAL=517,GL_GEQUAL=518,GL_ALWAYS=519,GL_KEEP=7680,GL_REPLACE=7681,GL_INCR=7682,GL_DECR=7683,GL_INVERT=5386,GL_INCR_WRAP=34055,GL_DECR_WRAP=34056,GL_VENDOR=7936,GL_RENDERER=7937,GL_VERSION=7938,GL_NEAREST=9728,GL_LINEAR=9729,GL_NEAREST_MIPMAP_NEAREST=9984,GL_LINEAR_MIPMAP_NEAREST=9985,GL_NEAREST_MIPMAP_LINEAR=9986,GL_LINEAR_MIPMAP_LINEAR=9987,GL_TEXTURE_MAG_FILTER=10240,GL_TEXTURE_MIN_FILTER=10241,GL_TEXTURE_WRAP_S=10242,GL_TEXTURE_WRAP_T=10243,GL_TEXTURE=5890,GL_TEXTURE_CUBE_MAP=34067,GL_TEXTURE_BINDING_CUBE_MAP=34068,GL_TEXTURE_CUBE_MAP_POSITIVE_X=34069,GL_TEXTURE_CUBE_MAP_NEGATIVE_X=34070,GL_TEXTURE_CUBE_MAP_POSITIVE_Y=34071,GL_TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,GL_TEXTURE_CUBE_MAP_POSITIVE_Z=34073,GL_TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,GL_MAX_CUBE_MAP_TEXTURE_SIZE=34076,GL_TEXTURE0=33984,GL_TEXTURE1=33985,GL_TEXTURE2=33986,GL_TEXTURE3=33987,GL_TEXTURE4=33988,GL_TEXTURE5=33989,GL_TEXTURE6=33990,GL_TEXTURE7=33991,GL_TEXTURE8=33992,GL_TEXTURE9=33993,GL_TEXTURE10=33994,GL_TEXTURE11=33995,GL_TEXTURE12=33996,GL_TEXTURE13=33997,GL_TEXTURE14=33998,GL_TEXTURE15=33999,GL_TEXTURE16=34e3,GL_TEXTURE17=34001,GL_TEXTURE18=34002,GL_TEXTURE19=34003,GL_TEXTURE20=34004,GL_TEXTURE21=34005,GL_TEXTURE22=34006,GL_TEXTURE23=34007,GL_TEXTURE24=34008,GL_TEXTURE25=34009,GL_TEXTURE26=34010,GL_TEXTURE27=34011,GL_TEXTURE28=34012,GL_TEXTURE29=34013,GL_TEXTURE30=34014,GL_TEXTURE31=34015,GL_ACTIVE_TEXTURE=34016,GL_REPEAT=10497,GL_CLAMP_TO_EDGE=33071,GL_MIRRORED_REPEAT=33648,GL_FLOAT_VEC2=35664,GL_FLOAT_VEC3=35665,GL_FLOAT_VEC4=35666,GL_INT_VEC2=35667,GL_INT_VEC3=35668,GL_INT_VEC4=35669,GL_BOOL=35670,GL_BOOL_VEC2=35671,GL_BOOL_VEC3=35672,GL_BOOL_VEC4=35673,GL_FLOAT_MAT2=35674,GL_FLOAT_MAT3=35675,GL_FLOAT_MAT4=35676,GL_SAMPLER_2D=35678,GL_SAMPLER_CUBE=35680,GL_VERTEX_ATTRIB_ARRAY_ENABLED=34338,GL_VERTEX_ATTRIB_ARRAY_SIZE=34339,GL_VERTEX_ATTRIB_ARRAY_STRIDE=34340,GL_VERTEX_ATTRIB_ARRAY_TYPE=34341,GL_VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,GL_VERTEX_ATTRIB_ARRAY_POINTER=34373,GL_VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,GL_COMPILE_STATUS=35713,GL_INFO_LOG_LENGTH=35716,GL_SHADER_SOURCE_LENGTH=35720,GL_LOW_FLOAT=36336,GL_MEDIUM_FLOAT=36337,GL_HIGH_FLOAT=36338,GL_LOW_INT=36339,GL_MEDIUM_INT=36340,GL_HIGH_INT=36341,GL_FRAMEBUFFER=36160,GL_RENDERBUFFER=36161,GL_RGBA4=32854,GL_RGB5_A1=32855,GL_RGB565=36194,GL_DEPTH_COMPONENT16=33189,GL_STENCIL_INDEX=6401,GL_STENCIL_INDEX8=36168,GL_DEPTH_STENCIL=34041,GL_RENDERBUFFER_WIDTH=36162,GL_RENDERBUFFER_HEIGHT=36163,GL_RENDERBUFFER_INTERNAL_FORMAT=36164,GL_RENDERBUFFER_RED_SIZE=36176,GL_RENDERBUFFER_GREEN_SIZE=36177,GL_RENDERBUFFER_BLUE_SIZE=36178,GL_RENDERBUFFER_ALPHA_SIZE=36179,GL_RENDERBUFFER_DEPTH_SIZE=36180,GL_RENDERBUFFER_STENCIL_SIZE=36181,GL_FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,GL_FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,GL_FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,GL_FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,GL_COLOR_ATTACHMENT0=36064,GL_DEPTH_ATTACHMENT=36096,GL_STENCIL_ATTACHMENT=36128,GL_DEPTH_STENCIL_ATTACHMENT=33306,GL_NONE=0,GL_FRAMEBUFFER_COMPLETE=36053,GL_FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,GL_FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,GL_FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,GL_FRAMEBUFFER_UNSUPPORTED=36061,GL_FRAMEBUFFER_BINDING=36006,GL_RENDERBUFFER_BINDING=36007,GL_MAX_RENDERBUFFER_SIZE=34024,GL_INVALID_FRAMEBUFFER_OPERATION=1286,GL_UNPACK_FLIP_Y_WEBGL=37440,GL_UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,GL_CONTEXT_LOST_WEBGL=37442,GL_UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,GL_BROWSER_DEFAULT_WEBGL=37444;(function(e,t){typeof exports=="object"?module.exports=t(global):typeof define=="function"&&define.amd?define([],function(){return t(e)}):t(e)})(this,function(e){"use strict";function i(e){return r=e,r}function s(){return r=typeof Float32Array!="undefined"?Float32Array:Array,r}var t=1e-6,n={};(function(){if(typeof Float32Array!="undefined"){var e=new Float32Array(1),t=new Int32Array(e.buffer);n.invsqrt=function(n){var r=n*.5;e[0]=n;var i=1.5;t[0]=1597463007-(t[0]>>1);var s=e[0];return s*(i-r*s*s)}}else n.invsqrt=function(e){return 1/Math.sqrt(e)}})();var r=null;s();var o={};o.create=function(e){var t=new r(3);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2]):t[0]=t[1]=t[2]=0,t},o.createFrom=function(e,t,n){var i=new r(3);return i[0]=e,i[1]=t,i[2]=n,i},o.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},o.equal=function(e,n){return e===n||Math.abs(e[0]-n[0])<t&&Math.abs(e[1]-n[1])<t&&Math.abs(e[2]-n[2])<t},o.add=function(e,t,n){return!n||e===n?(e[0]+=t[0],e[1]+=t[1],e[2]+=t[2],e):(n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n)},o.subtract=function(e,t,n){return!n||e===n?(e[0]-=t[0],e[1]-=t[1],e[2]-=t[2],e):(n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n)},o.multiply=function(e,t,n){return!n||e===n?(e[0]*=t[0],e[1]*=t[1],e[2]*=t[2],e):(n[0]=e[0]*t[0],n[1]=e[1]*t[1],n[2]=e[2]*t[2],n)},o.negate=function(e,t){return t||(t=e),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},o.scale=function(e,t,n){return!n||e===n?(e[0]*=t,e[1]*=t,e[2]*=t,e):(n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n)},o.normalize=function(e,t){t||(t=e);var n=e[0],r=e[1],i=e[2],s=Math.sqrt(n*n+r*r+i*i);return s?s===1?(t[0]=n,t[1]=r,t[2]=i,t):(s=1/s,t[0]=n*s,t[1]=r*s,t[2]=i*s,t):(t[0]=0,t[1]=0,t[2]=0,t)},o.cross=function(e,t,n){n||(n=e);var r=e[0],i=e[1],s=e[2],o=t[0],u=t[1],a=t[2];return n[0]=i*a-s*u,n[1]=s*o-r*a,n[2]=r*u-i*o,n},o.length=function(e){var t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)},o.squaredLength=function(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r},o.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},o.direction=function(e,t,n){n||(n=e);var r=e[0]-t[0],i=e[1]-t[1],s=e[2]-t[2],o=Math.sqrt(r*r+i*i+s*s);return o?(o=1/o,n[0]=r*o,n[1]=i*o,n[2]=s*o,n):(n[0]=0,n[1]=0,n[2]=0,n)},o.lerp=function(e,t,n,r){return r||(r=e),r[0]=e[0]+n*(t[0]-e[0]),r[1]=e[1]+n*(t[1]-e[1]),r[2]=e[2]+n*(t[2]-e[2]),r},o.dist=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(n*n+r*r+i*i)};var u=null,a=new r(4);o.unproject=function(e,t,n,r,i){i||(i=e),u||(u=d.create());var s=u,o=a;return o[0]=(e[0]-r[0])*2/r[2]-1,o[1]=(e[1]-r[1])*2/r[3]-1,o[2]=2*e[2]-1,o[3]=1,d.multiply(n,t,s),d.inverse(s)?(d.multiplyVec4(s,o),o[3]===0?null:(i[0]=o[0]/o[3],i[1]=o[1]/o[3],i[2]=o[2]/o[3],i)):null};var f=o.createFrom(1,0,0),l=o.createFrom(0,1,0),c=o.createFrom(0,0,1),h=o.create();o.rotationTo=function(e,t,n){n||(n=v.create());var r=o.dot(e,t),i=h;if(r>=1)v.set(m,n);else if(r<1e-6-1)o.cross(f,e,i),o.length(i)<1e-6&&o.cross(l,e,i),o.length(i)<1e-6&&o.cross(c,e,i),o.normalize(i),v.fromAngleAxis(Math.PI,i,n);else{var s=Math.sqrt((1+r)*2),u=1/s;o.cross(e,t,i),n[0]=i[0]*u,n[1]=i[1]*u,n[2]=i[2]*u,n[3]=s*.5,v.normalize(n)}return n[3]>1?n[3]=1:n[3]<-1&&(n[3]=-1),n},o.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+"]"};var p={};p.create=function(e){var t=new r(9);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8]):t[0]=t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=0,t},p.createFrom=function(e,t,n,i,s,o,u,a,f){var l=new r(9);return l[0]=e,l[1]=t,l[2]=n,l[3]=i,l[4]=s,l[5]=o,l[6]=u,l[7]=a,l[8]=f,l},p.determinant=function(e){var t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],o=e[5],u=e[6],a=e[7],f=e[8];return t*(f*s-o*a)+n*(-f*i+o*u)+r*(a*i-s*u)},p.inverse=function(e,t){var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],u=e[5],a=e[6],f=e[7],l=e[8],c=l*o-u*f,h=-l*s+u*a,d=f*s-o*a,v=n*c+r*h+i*d,m;return v?(m=1/v,t||(t=p.create()),t[0]=c*m,t[1]=(-l*r+i*f)*m,t[2]=(u*r-i*o)*m,t[3]=h*m,t[4]=(l*n-i*a)*m,t[5]=(-u*n+i*s)*m,t[6]=d*m,t[7]=(-f*n+r*a)*m,t[8]=(o*n-r*s)*m,t):null},p.multiply=function(e,t,n){n||(n=e);var r=e[0],i=e[1],s=e[2],o=e[3],u=e[4],a=e[5],f=e[6],l=e[7],c=e[8],h=t[0],p=t[1],d=t[2],v=t[3],m=t[4],g=t[5],y=t[6],b=t[7],w=t[8];return n[0]=h*r+p*o+d*f,n[1]=h*i+p*u+d*l,n[2]=h*s+p*a+d*c,n[3]=v*r+m*o+g*f,n[4]=v*i+m*u+g*l,n[5]=v*s+m*a+g*c,n[6]=y*r+b*o+w*f,n[7]=y*i+b*u+w*l,n[8]=y*s+b*a+w*c,n},p.multiplyVec2=function(e,t,n){n||(n=t);var r=t[0],i=t[1];return n[0]=r*e[0]+i*e[3]+e[6],n[1]=r*e[1]+i*e[4]+e[7],n},p.multiplyVec3=function(e,t,n){n||(n=t);var r=t[0],i=t[1],s=t[2];return n[0]=r*e[0]+i*e[3]+s*e[6],n[1]=r*e[1]+i*e[4]+s*e[7],n[2]=r*e[2]+i*e[5]+s*e[8],n},p.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},p.equal=function(e,n){return e===n||Math.abs(e[0]-n[0])<t&&Math.abs(e[1]-n[1])<t&&Math.abs(e[2]-n[2])<t&&Math.abs(e[3]-n[3])<t&&Math.abs(e[4]-n[4])<t&&Math.abs(e[5]-n[5])<t&&Math.abs(e[6]-n[6])<t&&Math.abs(e[7]-n[7])<t&&Math.abs(e[8]-n[8])<t},p.identity=function(e){return e||(e=p.create()),e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},p.transpose=function(e,t){if(!t||e===t){var n=e[1],r=e[2],i=e[5];return e[1]=e[3],e[2]=e[6],e[3]=n,e[5]=e[7],e[6]=r,e[7]=i,e}return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],t},p.toMat4=function(e,t){return t||(t=d.create()),t[15]=1,t[14]=0,t[13]=0,t[12]=0,t[11]=0,t[10]=e[8],t[9]=e[7],t[8]=e[6],t[7]=0,t[6]=e[5],t[5]=e[4],t[4]=e[3],t[3]=0,t[2]=e[2],t[1]=e[1],t[0]=e[0],t},p.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+"]"};var d={};d.create=function(e){var t=new r(16);return e&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t},d.createFrom=function(e,t,n,i,s,o,u,a,f,l,c,h,p,d,v,m){var g=new r(16);return g[0]=e,g[1]=t,g[2]=n,g[3]=i,g[4]=s,g[5]=o,g[6]=u,g[7]=a,g[8]=f,g[9]=l,g[10]=c,g[11]=h,g[12]=p,g[13]=d,g[14]=v,g[15]=m,g},d.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},d.equal=function(e,n){return e===n||Math.abs(e[0]-n[0])<t&&Math.abs(e[1]-n[1])<t&&Math.abs(e[2]-n[2])<t&&Math.abs(e[3]-n[3])<t&&Math.abs(e[4]-n[4])<t&&Math.abs(e[5]-n[5])<t&&Math.abs(e[6]-n[6])<t&&Math.abs(e[7]-n[7])<t&&Math.abs(e[8]-n[8])<t&&Math.abs(e[9]-n[9])<t&&Math.abs(e[10]-n[10])<t&&Math.abs(e[11]-n[11])<t&&Math.abs(e[12]-n[12])<t&&Math.abs(e[13]-n[13])<t&&Math.abs(e[14]-n[14])<t&&Math.abs(e[15]-n[15])<t},d.identity=function(e){return e||(e=d.create()),e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},d.transpose=function(e,t){if(!t||e===t){var n=e[1],r=e[2],i=e[3],s=e[6],o=e[7],u=e[11];return e[1]=e[4],e[2]=e[8],e[3]=e[12],e[4]=n,e[6]=e[9],e[7]=e[13],e[8]=r,e[9]=s,e[11]=e[14],e[12]=i,e[13]=o,e[14]=u,e}return t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15],t},d.determinant=function(e){var t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],o=e[5],u=e[6],a=e[7],f=e[8],l=e[9],c=e[10],h=e[11],p=e[12],d=e[13],v=e[14],m=e[15];return p*l*u*i-f*d*u*i-p*o*c*i+s*d*c*i+f*o*v*i-s*l*v*i-p*l*r*a+f*d*r*a+p*n*c*a-t*d*c*a-f*n*v*a+t*l*v*a+p*o*r*h-s*d*r*h-p*n*u*h+t*d*u*h+s*n*v*h-t*o*v*h-f*o*r*m+s*l*r*m+f*n*u*m-t*l*u*m-s*n*c*m+t*o*c*m},d.inverse=function(e,t){t||(t=e);var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],u=e[5],a=e[6],f=e[7],l=e[8],c=e[9],h=e[10],p=e[11],d=e[12],v=e[13],m=e[14],g=e[15],y=n*u-r*o,b=n*a-i*o,w=n*f-s*o,E=r*a-i*u,S=r*f-s*u,x=i*f-s*a,T=l*v-c*d,N=l*m-h*d,C=l*g-p*d,k=c*m-h*v,L=c*g-p*v,A=h*g-p*m,O=y*A-b*L+w*k+E*C-S*N+x*T,M;return O?(M=1/O,t[0]=(u*A-a*L+f*k)*M,t[1]=(-r*A+i*L-s*k)*M,t[2]=(v*x-m*S+g*E)*M,t[3]=(-c*x+h*S-p*E)*M,t[4]=(-o*A+a*C-f*N)*M,t[5]=(n*A-i*C+s*N)*M,t[6]=(-d*x+m*w-g*b)*M,t[7]=(l*x-h*w+p*b)*M,t[8]=(o*L-u*C+f*T)*M,t[9]=(-n*L+r*C-s*T)*M,t[10]=(d*S-v*w+g*y)*M,t[11]=(-l*S+c*w-p*y)*M,t[12]=(-o*k+u*N-a*T)*M,t[13]=(n*k-r*N+i*T)*M,t[14]=(-d*E+v*b-m*y)*M,t[15]=(l*E-c*b+h*y)*M,t):null},d.toRotationMat=function(e,t){return t||(t=d.create()),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},d.toMat3=function(e,t){return t||(t=p.create()),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},d.toInverseMat3=function(e,t){var n=e[0],r=e[1],i=e[2],s=e[4],o=e[5],u=e[6],a=e[8],f=e[9],l=e[10],c=l*o-u*f,h=-l*s+u*a,d=f*s-o*a,v=n*c+r*h+i*d,m;return v?(m=1/v,t||(t=p.create()),t[0]=c*m,t[1]=(-l*r+i*f)*m,t[2]=(u*r-i*o)*m,t[3]=h*m,t[4]=(l*n-i*a)*m,t[5]=(-u*n+i*s)*m,t[6]=d*m,t[7]=(-f*n+r*a)*m,t[8]=(o*n-r*s)*m,t):null},d.multiply=function(e,t,n){n||(n=e);var r=e[0],i=e[1],s=e[2],o=e[3],u=e[4],a=e[5],f=e[6],l=e[7],c=e[8],h=e[9],p=e[10],d=e[11],v=e[12],m=e[13],g=e[14],y=e[15],b=t[0],w=t[1],E=t[2],S=t[3];return n[0]=b*r+w*u+E*c+S*v,n[1]=b*i+w*a+E*h+S*m,n[2]=b*s+w*f+E*p+S*g,n[3]=b*o+w*l+E*d+S*y,b=t[4],w=t[5],E=t[6],S=t[7],n[4]=b*r+w*u+E*c+S*v,n[5]=b*i+w*a+E*h+S*m,n[6]=b*s+w*f+E*p+S*g,n[7]=b*o+w*l+E*d+S*y,b=t[8],w=t[9],E=t[10],S=t[11],n[8]=b*r+w*u+E*c+S*v,n[9]=b*i+w*a+E*h+S*m,n[10]=b*s+w*f+E*p+S*g,n[11]=b*o+w*l+E*d+S*y,b=t[12],w=t[13],E=t[14],S=t[15],n[12]=b*r+w*u+E*c+S*v,n[13]=b*i+w*a+E*h+S*m,n[14]=b*s+w*f+E*p+S*g,n[15]=b*o+w*l+E*d+S*y,n},d.multiplyVec3=function(e,t,n){n||(n=t);var r=t[0],i=t[1],s=t[2];return n[0]=e[0]*r+e[4]*i+e[8]*s+e[12],n[1]=e[1]*r+e[5]*i+e[9]*s+e[13],n[2]=e[2]*r+e[6]*i+e[10]*s+e[14],n},d.multiplyVec4=function(e,t,n){n||(n=t);var r=t[0],i=t[1],s=t[2],o=t[3];return n[0]=e[0]*r+e[4]*i+e[8]*s+e[12]*o,n[1]=e[1]*r+e[5]*i+e[9]*s+e[13]*o,n[2]=e[2]*r+e[6]*i+e[10]*s+e[14]*o,n[3]=e[3]*r+e[7]*i+e[11]*s+e[15]*o,n},d.translate=function(e,t,n){var r=t[0],i=t[1],s=t[2],o,u,a,f,l,c,h,p,d,v,m,g;return!n||e===n?(e[12]=e[0]*r+e[4]*i+e[8]*s+e[12],e[13]=e[1]*r+e[5]*i+e[9]*s+e[13],e[14]=e[2]*r+e[6]*i+e[10]*s+e[14],e[15]=e[3]*r+e[7]*i+e[11]*s+e[15],e):(o=e[0],u=e[1],a=e[2],f=e[3],l=e[4],c=e[5],h=e[6],p=e[7],d=e[8],v=e[9],m=e[10],g=e[11],n[0]=o,n[1]=u,n[2]=a,n[3]=f,n[4]=l,n[5]=c,n[6]=h,n[7]=p,n[8]=d,n[9]=v,n[10]=m,n[11]=g,n[12]=o*r+l*i+d*s+e[12],n[13]=u*r+c*i+v*s+e[13],n[14]=a*r+h*i+m*s+e[14],n[15]=f*r+p*i+g*s+e[15],n)},d.scale=function(e,t,n){var r=t[0],i=t[1],s=t[2];return!n||e===n?(e[0]*=r,e[1]*=r,e[2]*=r,e[3]*=r,e[4]*=i,e[5]*=i,e[6]*=i,e[7]*=i,e[8]*=s,e[9]*=s,e[10]*=s,e[11]*=s,e):(n[0]=e[0]*r,n[1]=e[1]*r,n[2]=e[2]*r,n[3]=e[3]*r,n[4]=e[4]*i,n[5]=e[5]*i,n[6]=e[6]*i,n[7]=e[7]*i,n[8]=e[8]*s,n[9]=e[9]*s,n[10]=e[10]*s,n[11]=e[11]*s,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n)},d.rotate=function(e,t,n,r){var i=n[0],s=n[1],o=n[2],u=Math.sqrt(i*i+s*s+o*o),a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M;return u?(u!==1&&(u=1/u,i*=u,s*=u,o*=u),a=Math.sin(t),f=Math.cos(t),l=1-f,c=e[0],h=e[1],p=e[2],d=e[3],v=e[4],m=e[5],g=e[6],y=e[7],b=e[8],w=e[9],E=e[10],S=e[11],x=i*i*l+f,T=s*i*l+o*a,N=o*i*l-s*a,C=i*s*l-o*a,k=s*s*l+f,L=o*s*l+i*a,A=i*o*l+s*a,O=s*o*l-i*a,M=o*o*l+f,r?e!==r&&(r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]):r=e,r[0]=c*x+v*T+b*N,r[1]=h*x+m*T+w*N,r[2]=p*x+g*T+E*N,r[3]=d*x+y*T+S*N,r[4]=c*C+v*k+b*L,r[5]=h*C+m*k+w*L,r[6]=p*C+g*k+E*L,r[7]=d*C+y*k+S*L,r[8]=c*A+v*O+b*M,r[9]=h*A+m*O+w*M,r[10]=p*A+g*O+E*M,r[11]=d*A+y*O+S*M,r):null},d.rotateX=function(e,t,n){var r=Math.sin(t),i=Math.cos(t),s=e[4],o=e[5],u=e[6],a=e[7],f=e[8],l=e[9],c=e[10],h=e[11];return n?e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]):n=e,n[4]=s*i+f*r,n[5]=o*i+l*r,n[6]=u*i+c*r,n[7]=a*i+h*r,n[8]=s*-r+f*i,n[9]=o*-r+l*i,n[10]=u*-r+c*i,n[11]=a*-r+h*i,n},d.rotateY=function(e,t,n){var r=Math.sin(t),i=Math.cos(t),s=e[0],o=e[1],u=e[2],a=e[3],f=e[8],l=e[9],c=e[10],h=e[11];return n?e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]):n=e,n[0]=s*i+f*-r,n[1]=o*i+l*-r,n[2]=u*i+c*-r,n[3]=a*i+h*-r,n[8]=s*r+f*i,n[9]=o*r+l*i,n[10]=u*r+c*i,n[11]=a*r+h*i,n},d.rotateZ=function(e,t,n){var r=Math.sin(t),i=Math.cos(t),s=e[0],o=e[1],u=e[2],a=e[3],f=e[4],l=e[5],c=e[6],h=e[7];return n?e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]):n=e,n[0]=s*i+f*r,n[1]=o*i+l*r,n[2]=u*i+c*r,n[3]=a*i+h*r,n[4]=s*-r+f*i,n[5]=o*-r+l*i,n[6]=u*-r+c*i,n[7]=a*-r+h*i,n},d.frustum=function(e,t,n,r,i,s,o){o||(o=d.create());var u=t-e,a=r-n,f=s-i;return o[0]=i*2/u,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=i*2/a,o[6]=0,o[7]=0,o[8]=(t+e)/u,o[9]=(r+n)/a,o[10]=-(s+i)/f,o[11]=-1,o[12]=0,o[13]=0,o[14]=-(s*i*2)/f,o[15]=0,o},d.perspective=function(e,t,n,r,i){var s=n*Math.tan(e*Math.PI/360),o=s*t;return d.frustum(-o,o,-s,s,n,r,i)},d.ortho=function(e,t,n,r,i,s,o){o||(o=d.create());var u=t-e,a=r-n,f=s-i;return o[0]=2/u,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2/a,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=-2/f,o[11]=0,o[12]=-(e+t)/u,o[13]=-(r+n)/a,o[14]=-(s+i)/f,o[15]=1,o},d.lookAt=function(e,t,n,r){r||(r=d.create());var i,s,o,u,a,f,l,c,h,p,v=e[0],m=e[1],g=e[2],y=n[0],b=n[1],w=n[2],E=t[0],S=t[1],x=t[2];return v===E&&m===S&&g===x?d.identity(r):(l=v-E,c=m-S,h=g-x,p=1/Math.sqrt(l*l+c*c+h*h),l*=p,c*=p,h*=p,i=b*h-w*c,s=w*l-y*h,o=y*c-b*l,p=Math.sqrt(i*i+s*s+o*o),p?(p=1/p,i*=p,s*=p,o*=p):(i=0,s=0,o=0),u=c*o-h*s,a=h*i-l*o,f=l*s-c*i,p=Math.sqrt(u*u+a*a+f*f),p?(p=1/p,u*=p,a*=p,f*=p):(u=0,a=0,f=0),r[0]=i,r[1]=u,r[2]=l,r[3]=0,r[4]=s,r[5]=a,r[6]=c,r[7]=0,r[8]=o,r[9]=f,r[10]=h,r[11]=0,r[12]=-(i*v+s*m+o*g),r[13]=-(u*v+a*m+f*g),r[14]=-(l*v+c*m+h*g),r[15]=1,r)},d.fromRotationTranslation=function(e,t,n){n||(n=d.create());var r=e[0],i=e[1],s=e[2],o=e[3],u=r+r,a=i+i,f=s+s,l=r*u,c=r*a,h=r*f,p=i*a,v=i*f,m=s*f,g=o*u,y=o*a,b=o*f;return n[0]=1-(p+m),n[1]=c+b,n[2]=h-y,n[3]=0,n[4]=c-b,n[5]=1-(l+m),n[6]=v+g,n[7]=0,n[8]=h+y,n[9]=v-g,n[10]=1-(l+p),n[11]=0,n[12]=t[0],n[13]=t[1],n[14]=t[2],n[15]=1,n},d.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+"]"};var v={};v.create=function(e){var t=new r(4);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]):t[0]=t[1]=t[2]=t[3]=0,t},v.createFrom=function(e,t,n,i){var s=new r(4);return s[0]=e,s[1]=t,s[2]=n,s[3]=i,s},v.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},v.equal=function(e,n){return e===n||Math.abs(e[0]-n[0])<t&&Math.abs(e[1]-n[1])<t&&Math.abs(e[2]-n[2])<t&&Math.abs(e[3]-n[3])<t},v.identity=function(e){return e||(e=v.create()),e[0]=0,e[1]=0,e[2]=0,e[3]=1,e};var m=v.identity();v.calculateW=function(e,t){var n=e[0],r=e[1],i=e[2];return!t||e===t?(e[3]=-Math.sqrt(Math.abs(1-n*n-r*r-i*i)),e):(t[0]=n,t[1]=r,t[2]=i,t[3]=-Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t)},v.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},v.inverse=function(e,t){var n=e[0],r=e[1],i=e[2],s=e[3],o=n*n+r*r+i*i+s*s,u=o?1/o:0;return!t||e===t?(e[0]*=-u,e[1]*=-u,e[2]*=-u,e[3]*=u,e):(t[0]=-e[0]*u,t[1]=-e[1]*u,t[2]=-e[2]*u,t[3]=e[3]*u,t)},v.conjugate=function(e,t){return!t||e===t?(e[0]*=-1,e[1]*=-1,e[2]*=-1,e):(t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t)},v.length=function(e){var t=e[0],n=e[1],r=e[2],i=e[3];return Math.sqrt(t*t+n*n+r*r+i*i)},v.normalize=function(e,t){t||(t=e);var n=e[0],r=e[1],i=e[2],s=e[3],o=Math.sqrt(n*n+r*r+i*i+s*s);return o===0?(t[0]=0,t[1]=0,t[2]=0,t[3]=0,t):(o=1/o,t[0]=n*o,t[1]=r*o,t[2]=i*o,t[3]=s*o,t)},v.add=function(e,t,n){return!n||e===n?(e[0]+=t[0],e[1]+=t[1],e[2]+=t[2],e[3]+=t[3],e):(n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n)},v.multiply=function(e,t,n){n||(n=e);var r=e[0],i=e[1],s=e[2],o=e[3],u=t[0],a=t[1],f=t[2],l=t[3];return n[0]=r*l+o*u+i*f-s*a,n[1]=i*l+o*a+s*u-r*f,n[2]=s*l+o*f+r*a-i*u,n[3]=o*l-r*u-i*a-s*f,n},v.multiplyVec3=function(e,t,n){n||(n=t);var r=t[0],i=t[1],s=t[2],o=e[0],u=e[1],a=e[2],f=e[3],l=f*r+u*s-a*i,c=f*i+a*r-o*s,h=f*s+o*i-u*r,p=-o*r-u*i-a*s;return n[0]=l*f+p*-o+c*-a-h*-u,n[1]=c*f+p*-u+h*-o-l*-a,n[2]=h*f+p*-a+l*-u-c*-o,n},v.scale=function(e,t,n){return!n||e===n?(e[0]*=t,e[1]*=t,e[2]*=t,e[3]*=t,e):(n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n)},v.toMat3=function(e,t){t||(t=p.create());var n=e[0],r=e[1],i=e[2],s=e[3],o=n+n,u=r+r,a=i+i,f=n*o,l=n*u,c=n*a,h=r*u,d=r*a,v=i*a,m=s*o,g=s*u,y=s*a;return t[0]=1-(h+v),t[1]=l+y,t[2]=c-g,t[3]=l-y,t[4]=1-(f+v),t[5]=d+m,t[6]=c+g,t[7]=d-m,t[8]=1-(f+h),t},v.toMat4=function(e,t){t||(t=d.create());var n=e[0],r=e[1],i=e[2],s=e[3],o=n+n,u=r+r,a=i+i,f=n*o,l=n*u,c=n*a,h=r*u,p=r*a,v=i*a,m=s*o,g=s*u,y=s*a;return t[0]=1-(h+v),t[1]=l+y,t[2]=c-g,t[3]=0,t[4]=l-y,t[5]=1-(f+v),t[6]=p+m,t[7]=0,t[8]=c+g,t[9]=p-m,t[10]=1-(f+h),t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},v.slerp=function(e,t,n,r){r||(r=e);var i=e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3],s,o,u,a;return Math.abs(i)>=1?(r!==e&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3]),r):(s=Math.acos(i),o=Math.sqrt(1-i*i),Math.abs(o)<.001?(r[0]=e[0]*.5+t[0]*.5,r[1]=e[1]*.5+t[1]*.5,r[2]=e[2]*.5+t[2]*.5,r[3]=e[3]*.5+t[3]*.5,r):(u=Math.sin((1-n)*s)/o,a=Math.sin(n*s)/o,r[0]=e[0]*u+t[0]*a,r[1]=e[1]*u+t[1]*a,r[2]=e[2]*u+t[2]*a,r[3]=e[3]*u+t[3]*a,r))},v.fromRotationMatrix=function(e,t){t||(t=v.create());var n=e[0]+e[4]+e[8],r;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[7]-e[5])*r,t[1]=(e[2]-e[6])*r,t[2]=(e[3]-e[1])*r;else{var i=v.fromRotationMatrix.s_iNext=v.fromRotationMatrix.s_iNext||[1,2,0],s=0;e[4]>e[0]&&(s=1),e[8]>e[s*3+s]&&(s=2);var o=i[s],u=i[o];r=Math.sqrt(e[s*3+s]-e[o*3+o]-e[u*3+u]+1),t[s]=.5*r,r=.5/r,t[3]=(e[u*3+o]-e[o*3+u])*r,t[o]=(e[o*3+s]+e[s*3+o])*r,t[u]=(e[u*3+s]+e[s*3+u])*r}return t},p.toQuat4=v.fromRotationMatrix,function(){var e=p.create();v.fromAxes=function(t,n,r,i){return e[0]=n[0],e[3]=n[1],e[6]=n[2],e[1]=r[0],e[4]=r[1],e[7]=r[2],e[2]=t[0],e[5]=t[1],e[8]=t[2],v.fromRotationMatrix(e,i)}}(),v.identity=function(e){return e||(e=v.create()),e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},v.fromAngleAxis=function(e,t,n){n||(n=v.create());var r=e*.5,i=Math.sin(r);return n[3]=Math.cos(r),n[0]=i*t[0],n[1]=i*t[1],n[2]=i*t[2],n},v.toAngleAxis=function(e,t){t||(t=e);var r=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];if(r>0){t[3]=2*Math.acos(e[3]);var i=n.invsqrt(r);t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i}else t[3]=0,t[0]=1,t[1]=0,t[2]=0;return t},v.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+"]"};var g={};g.create=function(e){var t=new r(2);return e?(t[0]=e[0],t[1]=e[1]):(t[0]=0,t[1]=0),t},g.createFrom=function(e,t){var n=new r(2);return n[0]=e,n[1]=t,n},g.add=function(e,t,n){return n||(n=t),n[0]=e[0]+t[0],n[1]=e[1]+t[1],n},g.subtract=function(e,t,n){return n||(n=t),n[0]=e[0]-t[0],n[1]=e[1]-t[1],n},g.multiply=function(e,t,n){return n||(n=t),n[0]=e[0]*t[0],n[1]=e[1]*t[1],n},g.divide=function(e,t,n){return n||(n=t),n[0]=e[0]/t[0],n[1]=e[1]/t[1],n},g.scale=function(e,t,n){return n||(n=e),n[0]=e[0]*t,n[1]=e[1]*t,n},g.dist=function(e,t){var n=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(n*n+r*r)},g.set=function(e,t){return t[0]=e[0],t[1]=e[1],t},g.equal=function(e,n){return e===n||Math.abs(e[0]-n[0])<t&&Math.abs(e[1]-n[1])<t},g.negate=function(e,t){return t||(t=e),t[0]=-e[0],t[1]=-e[1],t},g.normalize=function(e,t){t||(t=e);var n=e[0]*e[0]+e[1]*e[1];return n>0?(n=Math.sqrt(n),t[0]=e[0]/n,t[1]=e[1]/n):t[0]=t[1]=0,t},g.cross=function(e,t,n){var r=e[0]*t[1]-e[1]*t[0];return n?(n[0]=n[1]=0,n[2]=r,n):r},g.length=function(e){var t=e[0],n=e[1];return Math.sqrt(t*t+n*n)},g.squaredLength=function(e){var t=
e[0],n=e[1];return t*t+n*n},g.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},g.direction=function(e,t,n){n||(n=e);var r=e[0]-t[0],i=e[1]-t[1],s=r*r+i*i;return s?(s=1/Math.sqrt(s),n[0]=r*s,n[1]=i*s,n):(n[0]=0,n[1]=0,n[2]=0,n)},g.lerp=function(e,t,n,r){return r||(r=e),r[0]=e[0]+n*(t[0]-e[0]),r[1]=e[1]+n*(t[1]-e[1]),r},g.str=function(e){return"["+e[0]+", "+e[1]+"]"};var y={};y.create=function(e){var t=new r(4);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]):t[0]=t[1]=t[2]=t[3]=0,t},y.createFrom=function(e,t,n,i){var s=new r(4);return s[0]=e,s[1]=t,s[2]=n,s[3]=i,s},y.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},y.equal=function(e,n){return e===n||Math.abs(e[0]-n[0])<t&&Math.abs(e[1]-n[1])<t&&Math.abs(e[2]-n[2])<t&&Math.abs(e[3]-n[3])<t},y.identity=function(e){return e||(e=y.create()),e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},y.transpose=function(e,t){if(!t||e===t){var n=e[1];return e[1]=e[2],e[2]=n,e}return t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3],t},y.determinant=function(e){return e[0]*e[3]-e[2]*e[1]},y.inverse=function(e,t){t||(t=e);var n=e[0],r=e[1],i=e[2],s=e[3],o=n*s-i*r;return o?(o=1/o,t[0]=s*o,t[1]=-r*o,t[2]=-i*o,t[3]=n*o,t):null},y.multiply=function(e,t,n){n||(n=e);var r=e[0],i=e[1],s=e[2],o=e[3];return n[0]=r*t[0]+i*t[2],n[1]=r*t[1]+i*t[3],n[2]=s*t[0]+o*t[2],n[3]=s*t[1]+o*t[3],n},y.rotate=function(e,t,n){n||(n=e);var r=e[0],i=e[1],s=e[2],o=e[3],u=Math.sin(t),a=Math.cos(t);return n[0]=r*a+i*u,n[1]=r*-u+i*a,n[2]=s*a+o*u,n[3]=s*-u+o*a,n},y.multiplyVec2=function(e,t,n){n||(n=t);var r=t[0],i=t[1];return n[0]=r*e[0]+i*e[1],n[1]=r*e[2]+i*e[3],n},y.scale=function(e,t,n){n||(n=e);var r=e[0],i=e[1],s=e[2],o=e[3],u=t[0],a=t[1];return n[0]=r*u,n[1]=i*a,n[2]=s*u,n[3]=o*a,n},y.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+"]"};var b={};return b.create=function(e){var t=new r(4);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]):(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t},b.createFrom=function(e,t,n,i){var s=new r(4);return s[0]=e,s[1]=t,s[2]=n,s[3]=i,s},b.add=function(e,t,n){return n||(n=t),n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n},b.subtract=function(e,t,n){return n||(n=t),n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n},b.multiply=function(e,t,n){return n||(n=t),n[0]=e[0]*t[0],n[1]=e[1]*t[1],n[2]=e[2]*t[2],n[3]=e[3]*t[3],n},b.divide=function(e,t,n){return n||(n=t),n[0]=e[0]/t[0],n[1]=e[1]/t[1],n[2]=e[2]/t[2],n[3]=e[3]/t[3],n},b.scale=function(e,t,n){return n||(n=e),n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n},b.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},b.equal=function(e,n){return e===n||Math.abs(e[0]-n[0])<t&&Math.abs(e[1]-n[1])<t&&Math.abs(e[2]-n[2])<t&&Math.abs(e[3]-n[3])<t},b.negate=function(e,t){return t||(t=e),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},b.length=function(e){var t=e[0],n=e[1],r=e[2],i=e[3];return Math.sqrt(t*t+n*n+r*r+i*i)},b.squaredLength=function(e){var t=e[0],n=e[1],r=e[2],i=e[3];return t*t+n*n+r*r+i*i},b.lerp=function(e,t,n,r){return r||(r=e),r[0]=e[0]+n*(t[0]-e[0]),r[1]=e[1]+n*(t[1]-e[1]),r[2]=e[2]+n*(t[2]-e[2]),r[3]=e[3]+n*(t[3]-e[3]),r},b.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+"]"},e&&(e.glMatrixArrayType=r,e.MatrixArray=r,e.setMatrixArrayType=i,e.determineMatrixArrayType=s,e.glMath=n,e.vec2=g,e.vec3=o,e.vec4=b,e.mat2=y,e.mat3=p,e.mat4=d,e.quat4=v),{glMatrixArrayType:r,MatrixArray:r,setMatrixArrayType:i,determineMatrixArrayType:s,glMath:n,vec2:g,vec3:o,vec4:b,mat2:y,mat3:p,mat4:d,quat4:v}});var GLT={};(function(e){"use strict";function n(e){var n,r,i;for(n=0;r=t[n++];){i=e.getContext(r,{alpha:!1,preserveDrawingBuffer:!0});if(i)return i}return null}var t=["experimental-webgl","webgl","moz-webgl","webkit-3d"];e.createContext=n})(GLT),function(e){"use strict";function i(){for(var e=0;e!==t;e++)r[e]=0,n[e]=0}function s(){for(var e=0;e!==t;e++)r[e]=n[e]}function o(e){return n[e]!==0}function u(e){return n[e]===0}function a(e){return n[e]!==0&&r[e]===0}function f(e){return n[e]===0&&r[e]!==0}var t=256,n=new Uint8Array(t),r=new Uint8Array(t);i(),document.addEventListener("keydown",function(e){var r=e.keyCode;r<t&&(n[r]=1)},!1),document.addEventListener("keyup",function(e){var r=e.keyCode;r<t&&(n[r]=0)},!1),window.addEventListener("blur",function(){i()},!1);var l={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,capslock:20,escape:27,space:32,pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,"delete":46,num0:48,num1:49,num2:50,num3:51,num4:52,num5:53,num6:54,num7:55,num8:56,num9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,windowKeyLeft:91,windowKeyRight:92,select:93,numpad0:96,numpad1:97,numpad2:98,numpad3:99,numpad4:100,numpad5:101,numpad6:102,numpad7:103,numpad8:104,numpad9:105,multiply:106,add:107,subtract:109,decimalPoint:110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numlock:144,scrolllock:145,semicolon:186,equals:187,comma:188,dash:189,period:190,slash:191,graveAccent:192,openBracket:219,backSlash:220,closeBraket:221,quote:222};e.keys={codes:l,update:s,isDown:o,isUp:u,wasPressed:a,wasReleased:f}}(GLT),function(e){"use strict";function o(){r=-1,s.total=0,s.frame=0}function u(t){function o(){var n=Date.now();r===-1&&(i=n,r=n,s.frame=0);var o=(n-i)/1e3;s.delta=o,s.total+=o,t(s),s.frame++,i=n,e.keys.update()}n(o)}var t,n,r,i,s;t=window,n=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame||function(e){t.setTimeout(e,16)},r=-1,i=0,s={total:0,delta:0,frame:0,reset:o},e.requestGameFrame=u}(GLT),function(e){"use strict";function u(e){var u=e.split("\n"),a="",f=0,l=[],c=[],h=[],p=[],d=[],v=[],m=0,g={v:function(e){if(!e||e.length!=3)throw new Error("Can't accept Vertic without 3 components. LINE:"+a);var t=Number(e[0]),n=Number(e[1]),r=Number(e[2]);l.push(t,n,r)},vn:function(e){if(!e||e.length!=3)throw new Error("Can't accept Normal without 3 components. LINE:"+f);var t=Number(e[0]),n=Number(e[1]),r=Number(e[2]);c.push(t,n,r)},vt:function(e){if(!e||e.length<2)throw new Error("Can't accept Texture with less than 2 components. LINE:"+f);var t=Number(e[0]),n=Number(e[1]);h.push(t,n)},f:function D(e){if(!e||e.length<3)throw new Error("Can't accept Face with less than 3 components. LINE:"+f);if(e.length>3){for(var t=e.length-1;t!==1;t--)D([e[0],e[t-1],e[t]]);return}m++;for(var n=0;n!==3;n++){var r=e[n].split("/"),i=parseInt(r[0],10)-1,s=parseInt(r[1],10)-1,t=parseInt(r[2],10)-1;p.push(i),isNaN(s)||v.push(s),isNaN(t)||d.push(t)}}};for(f=0;f!=u.length;){a=u[f++].trim();var y=a.split(o),b=y.shift();b in g&&g[b](y)}var w=t;if(h.length!==0||v.length!==0){w|=r;if(p.length!==v.length)throw new Error("Texture indice don't match Vertic indice.")}if(c.length!==0||d.length!==0){w|=n;if(p.length!==d.length)throw new Error("Normal indice don't match Vertic indice.")}var E=0,S=0,x=0,T=0,N=0,C=0;switch(w){case t:N=4;break;case r:N=6,x=4*s;break;case n:N=8,T=4*s;break;case i:N=10,x=4*s,T=6*s;break;default:throw new Error("Schema broken.")}E=m*3*N;var k=new Float32Array(E),L=0,A=0,O=0,M=0;for(var _=0;_!=p.length;_++)A=3*p[_],k[L++]=l[A++],k[L++]=l[A++],k[L++]=l[A],k[L++]=1,w&r&&(O=2*v[_],k[L++]=h[O++],k[L++]=h[O]),w&n&&(M=3*d[_],k[L++]=c[M++],k[L++]=c[M++],k[L++]=c[M],k[L++]=0);return{stride:N*s,schema:w,voffset:S,toffset:x,noffset:T,rawData:k,numVertices:m*3}}var t=0,n=1,r=2,i=n|r,s=4,o=/[\t\r\n ]+/g;e.obj={},e.obj.parse=u,e.obj.SCHEMA_V=t,e.obj.SCHEMA_VN=n,e.obj.SCHEMA_VT=r,e.obj.SCHEMA_VTN=n|r}(GLT),function(e){"use strict";function t(e){return e=e.toLowerCase(),e==="application/json"?2:e==="text/html"?7:e.indexOf("javascript")!==-1?3:e.indexOf("xml")!==-1?4:e.indexOf("image")!==-1?5:1}function n(n,r,i,s){function o(){if(a)return;if(f.readyState===2||f.readyState===3){u=t(f.getResponseHeader("content-type")),r.toLowerCase().lastIndexOf(".json")+5===r.length?u=2:r.toLowerCase().lastIndexOf(".obj")+4===r.length&&(u=6);if(u===5){a=!0,f.abort();var o=new Image;o.onload=function(){i(n,o)},o.onerror=function(){s(r,"Loading image failed.")},o.src=r;return}}if(f.readyState===4){var l=f.status;if(l>=200&&l<=299||l===304||l===0)if(u===4)i(n,f.responseXML);else if(u===2)try{i(n,JSON.parse(f.responseText))}catch(c){s(r,c)}else if(u===6)try{i(n,e.obj.parse(f.responseText))}catch(c){s(r,c)}else i(n,f.responseText);else s(r,l||0)}}var u=0,a=!1,f=new XMLHttpRequest;f.onreadystatechange=o,f.open("GET",r,!0),f.send(null)}function r(){}function i(e){if(!e)throw new Error("Passed nothing in loadFiles");var t=e.files||{},i=e.update||r,s=e.finished||r,o=e.error||r,u=0,a=0,f=Object.create(null),l=function(e,t){a++,f[e]=t,i(e,a/u),a===u&&s(f)},c=function(e,t){l=r,c=r,o(e,t)};if(t instanceof Array){u=t.length;for(var h=0,p;p=t[h++];)n(p,p,l,c)}else{var d=Object.keys(t);u=d.length;for(var h=0,v;v=d[h++];)t.hasOwnProperty(v)&&n(v,t[v],l,c)}}e.loadmanager={},e.loadmanager.loadFiles=i}(GLT),function(e){"use strict";function t(e,t){var n=["#define VERTEX\n","#define FRAGMENT\n"],r="#line 0\n",i=[e.createShader(e.VERTEX_SHADER),e.createShader(e.FRAGMENT_SHADER)],s=e.createProgram(),o=null,u="";for(var a=0;a!=n.length;a++){o=i[a],e.shaderSource(o,n[a]+r+t),e.compileShader(o);if(u=e.getShaderInfoLog(o))throw new Error(u);e.attachShader(s,o)}return e.linkProgram(s),(u=e.getProgramInfoLog(s))&&console.error(u),s}e.shader={},e.shader.compileProgram=t}(GLT),Id.fromColor=function(e,t,n){"use strict";var r=0;return r+=n>>1,r+=(t>>1)*128,r+=(e>>1)*16384,new Id(r)},Id.Generator=function(){"use strict";var e=1;this.reset=function(){e=1},this.next=function(){return new Id(e++)}};var Cube=function(){function t(t){"use strict";var n=2,r=0,i=t.grid,s=vec3.create(),o=vec3.create(),u=0,a=0;this.tick=function(i){switch(r){case 0:break;case 2:t.bling=.618*Math.sin(2*Math.PI*(i.total-u));break;case 1:vec3.add(t.vector,vec3.scale(s,i.delta*n,e)),a+=i.delta*n,a>=1&&(r=0,vec3.set(vec3.add(o,s,e),t.vector),a=0,t.bling=0);break;default:console.error("ERROR (src/cube.js:51)","unknow state.",r)}},this.tap=function(e,n){do!(e.delta instanceof Number)&&"Number".toLowerCase()!==typeof e.delta&&__error("Objct time.delta is not from type Number","src/cube.js",57);while(!1);do!(n instanceof Float32Array)&&"Float32Array".toLowerCase()!==typeof n&&__error("Objct dir is not from type Float32Array","src/cube.js",58);while(!1);do Math.abs(vec3.length(n)-1)<1e-4||__error("assertion failed: Math.abs((vec3.length(dir) - 1.0)) < 0.0001 = "+(Math.abs(vec3.length(n)-1)<1e-4),"src/cube.js",59);while(!1);switch(r){case 0:r=2;break;case 1:break;case 2:u=e.total,s=n,vec3.set(t.vector,o),t.bling=0,a=0,r=1;break;default:console.error("ERROR (src/cube.js:79)","unknow state.",r)}}}var e=vec3.create();return function(e,n){do typeof e.x=="undefined"&&__error("No property x in position","src/cube.js",86);while(!1);do typeof e.y=="undefined"&&__error("No property y in position","src/cube.js",87);while(!1);do typeof e.z=="undefined"&&__error("No property z in position","src/cube.js",88);while(!1);do!(n instanceof Id)&&"Id".toLowerCase()!==typeof n&&__error("Objct id is not from type Id","src/cube.js",89);while(!1);var r=vec3.create([e.x,e.y,e.z]);this.grid=[e.x,e.y,e.z],this.id=n,this.vector=r,this.bling=0;var i=new t(this);this.tap=function(e,t){i.tap(e,t)},this.tick=function(e){i.tick(e)}}}();(function(){"use strict";function e(e){function i(){return n=r*n&t}var t=65535,n=e|0,r=n;for(var s=8;s--;)i();this.next=i}})(),function(){"use strict";function e(e,t,n){function p(e){do typeof e.cube=="undefined"&&__error("No property cube in obj","src/statemachine.js",39);while(!1);if(e.cube!==null){do!(e.cube instanceof Cube)&&"Cube".toLowerCase()!==typeof e.cube&&__error("Objct obj.cube is not from type Cube","src/statemachine.js",41);while(!1);e.cube.bling=0}o!==null&&(o.bling=0),o=e.cube;do typeof e.info=="undefined"&&__error("No property info in obj","src/statemachine.js",50);while(!1);do typeof e.info.time=="undefined"&&__error("No property time in obj.info","src/statemachine.js",51);while(!1);markedTime=e.time.total}function d(e){do typeof e.cube=="undefined"&&__error("No property cube in obj","src/statemachine.js",57);while(!1);if(e.cube!==null){do!(e.cube instanceof Cube)&&"Cube".toLowerCase()!==typeof e.cube&&__error("Objct obj.cube is not from type Cube","src/statemachine.js",59);while(!1);return!0}return!1}function v(e,t){switch(s){case 0:s=m(e,t);break;case 2:s=g(e,t);break;case 3:s=y(e,t);break;case 4:s=b(e,t);break;case 1:s=w(e,t);break;default:do __error('assertion failed: false && ("unknown transaction " + trans) = '+!1,"src/statemachine.js",88);while(!1)}}function m(e,t){switch(e){case 0:if(d(t))return p(t),2;break;case 1:case 2:return d(t)?(p(t),3):1}return 0}function g(e,t){switch(e){case 0:if(d(t))return o===t.cube?(markedcube.bling=0,4):(p(t),2);return 0;case 1:case 2:if(d(t)){if(t.cube===o)return 3;p(t)}return 2;case 4:do typeof t.info=="undefined"&&__error("No property info in obj","src/statemachine.js",144);while(!1);return o.bling=(1+Math.sin(markedTime-info.time.total))/2,2}return 2}function y(e,t){switch(e){case 0:return g(0,t);case 1:return 3;case 3:return 0}return 3}function b(e,t){switch(e,t){case 4:do typeof t.info=="undefined"&&__error("No property info in obj","src/statemachine.js",175);while(!1);var n=o,i=t.info;vec3.add(n.vector,vec3.scale(a,i.time.delta*r,f)),movetime+=i.time.delta*r;if(movetime>=1)return vec3.set(vec3.add(startpos,a,f),n.vector),movetime=0,n.bling=0,0}return 4}function w(r,i){switch(r){case 1:case 2:var s=mat4.identity(l),o=vec3.create(n);return vec3.scale(o,-1),mat4.translate(s,o),mat4.rotateY(s,-2*Math.PI*dragEvent.distanceX/e.width/50),mat4.translate(s,n),mat4.multiplyVec3(s,t),1;case 0:return m(r,i);case 4:break;case 3:return 0}return 1}do!(t instanceof Float32Array)&&"Float32Array".toLowerCase()!==typeof t&&__error("Objct cameraPos is not from type Float32Array","src/statemachine.js",21);while(!1);do!(n instanceof Float32Array)&&"Float32Array".toLowerCase()!==typeof n&&__error("Objct cameraDir is not from type Float32Array","src/statemachine.js",22);while(!1);do t.length!==3&&__error("assertion failed: cameraPos.length === 3 = "+(t.length===3),"src/statemachine.js",23);while(!1);do n.length!==3&&__error("assertion failed: cameraDir.length === 3 = "+(n.length===3),"src/statemachine.js",24);while(!1);var r=2,i=100,s=0,o=null,u=0,a=vec3.create(),f=vec3.create(),l=mat4.create(),c={x:0,y:0},h=0;this.tap=function(e,t){var n=s;v(0,t),console.log("DEBUG (src/statemachine.js:229)","Tap",n,"->",s)},this.dragStart=function(e,t){var n=s;v(2,t),console.log("DEBUG (src/statemachine.js:235)","DragStart",n,"->",s)},this.drag=function(e,t){var n=s;v(1,t),console.log("DEBUG (src/statemachine.js:241)","Drag",n,"->",s)},this.dragEnd=function(e,t){var n=s;v(3,t),console.log("DEBUG (src/statemachine.js:247)","DragEnd",n,"->",s)},this.tick=function(e,t){var n=s;v(4,t)}}}(),function(){"use strict";function A(e){do e||__error("assertion failed: img = "+e,"src/main.js",88);while(!1);var t=c.createTexture();return c.bindTexture(GL_TEXTURE_2D,t),c.pixelStorei(GL_UNPACK_FLIP_Y_WEBGL,1),c.texImage2D(GL_TEXTURE_2D,0,GL_RGBA,GL_RGBA,GL_UNSIGNED_BYTE,e),c.texParameteri(GL_TEXTURE_2D,GL_TEXTURE_MAG_FILTER,GL_NEAREST),c.texParameteri(GL_TEXTURE_2D,GL_TEXTURE_MIN_FILTER,GL_NEAREST),c.bindTexture(GL_TEXTURE_2D,null),t}function O(){m=mat4.lookAt(p,d,v)}function M(){c.enable(GL_DEPTH_TEST),c.enable(GL_SCISSOR_TEST),c.enable(GL_CULL_FACE),c.lineWidth(4.5),c.clearColor(0,0,0,0),o=c.createBuffer(),c.bindBuffer(GL_ARRAY_BUFFER,o),c.bufferData(GL_ARRAY_BUFFER,e.rawData,GL_STATIC_DRAW),u=c.createBuffer(),c.bindBuffer(GL_ARRAY_BUFFER,u),c.bufferData(GL_ARRAY_BUFFER,t.rawData,GL_STATIC_DRAW),a=c.createBuffer(),c.bindBuffer(GL_ARRAY_BUFFER,a),c.bufferData(GL_ARRAY_BUFFER,n.rawData,GL_STATIC_DRAW),f=c.createBuffer(),c.bindBuffer(GL_ARRAY_BUFFER,f),c.bufferData(GL_ARRAY_BUFFER,x,GL_STATIC_DRAW);var r=new Hammer(l);r.ontap=function(e){T=!0,N=e;var t=e.position[0].x,n=l.height-e.position[0].y;L.x=t,L.y=n},r.ondrag=function(e){C=!0,k=e;var t=e.position.x,n=l.height-e.position.y;L.x=t,L.y=n}}function _(e){P(e),H(e),GLT.requestGameFrame(_)}function P(e){var t=0,n=0,r=0,i=0,s=0,o=0,u=!1,a=!1;T&&console.log(D(p,d)),T=!1,C=!1;for(var f=0;f!=S.length;f++){var l=S[f];l.tick(e)}}function H(e){c.disable(GL_DEPTH_TEST),c.disable(GL_CULL_FACE),I(r),c.enable(GL_DEPTH_TEST),c.enable(GL_CULL_FACE),c.clearDepth(1),c.clear(GL_DEPTH_BUFFER_BIT);var t=c.getParameter(GL_VIEWPORT),n=t[0],s=t[1],o=t[2],u=t[3];c.scissor(o-180-15,15,180,135),c.viewport(o-180-15,15,180,135),q(i),j(r),c.clearDepth(0),c.clear(GL_DEPTH_BUFFER_BIT),c.scissor(n,s,o,u),c.viewport(n,s,o,u),j(r),F(r)}function B(e){for(var t=0;t!=S.length;t++){var n=S[t];if(n.id.asNumber()===e)return n}return console.error("ERROR (src/main.js:269)","id",e,"not found."),null}function j(t){c.useProgram(t);var n=c.getUniformLocation(t,"uModelviewprojection"),r=c.getUniformLocation(t,"uIdColor"),i=c.getUniformLocation(t,"uTexture"),s=c.getUniformLocation(t,"uBling"),u=c.getAttribLocation(t,"aVertex"),a=c.getAttribLocation(t,"aTextureuv"),f=c.getAttribLocation(t,"aNormal"),l=g;c.bindBuffer(GL_ARRAY_BUFFER,o),c.vertexAttribPointer(u,4,GL_FLOAT,!1,e.stride,e.voffset),c.enableVertexAttribArray(u),a!==-1&&(c.vertexAttribPointer(a,4,GL_FLOAT,!1,e.stride,e.toffset),c.enableVertexAttribArray(a)),f!==-1&&(c.vertexAttribPointer(f,4,GL_FLOAT,!1,e.stride,e.noffset),c.enableVertexAttribArray(f)),i&&(c.bindTexture(GL_TEXTURE_2D,y),c.uniform1i(i,0));for(var p=0;p!=S.length;p++){var d=S[p];r&&c.uniform3fv(r,d.id.asColor()),s&&c.uniform1f(s,d.bling),mat4.multiply(h,m,l),mat4.translate(l,d.vector),c.uniformMatrix4fv(n,!1,l),c.drawArrays(GL_TRIANGLES,0,e.numVertices)}}function F(e){c.useProgram(e);var n=c.getUniformLocation(e,"uModelviewprojection"),r=c.getUniformLocation(e,"uTexture"),i=c.getAttribLocation(e,"aVertex"),s=c.getAttribLocation(e,"aTextureuv"),o=g;c.bindBuffer(GL_ARRAY_BUFFER,u),c.vertexAttribPointer(i,4,GL_FLOAT,!1,t.stride,t.voffset),c.enableVertexAttribArray(i),s!==-1&&(c.vertexAttribPointer(s,4,GL_FLOAT,!1,t.stride,t.toffset),c.enableVertexAttribArray(s)),r&&(c.bindTexture(GL_TEXTURE_2D,y),c.uniform1i(r,0)),mat4.multiply(h,m,o),c.uniformMatrix4fv(n,!1,o),c.drawArrays(GL_TRIANGLES,0,t.numVertices)}function I(e){c.useProgram(e);var t=c.getUniformLocation(e,"uModelviewprojection"),r=c.getUniformLocation(e,"uTexture"),i=c.getAttribLocation(e,"aVertex"),s=c.getAttribLocation(e,"aTextureuv"),o=g;do t||__error("assertion failed: uModelviewprojection = "+t,"src/main.js",372);while(!1);do r||__error("assertion failed: uTexture = "+r,"src/main.js",373);while(!1);do s===-1&&__error("assertion failed: aTextureuv !== -1 = "+(s!==-1),"src/main.js",374);while(!1);do i===-1&&__error("assertion failed: aVertex !== -1 = "+(i!==-1),"src/main.js",375);while(!1);c.bindBuffer(GL_ARRAY_BUFFER,a),c.vertexAttribPointer(i,4,GL_FLOAT,!1,n.stride,n.voffset),c.enableVertexAttribArray(i),c.vertexAttribPointer(s,4,GL_FLOAT,!1,n.stride,n.toffset),c.enableVertexAttribArray(s),c.bindTexture(GL_TEXTURE_2D,b),c.uniform1i(r,0),mat4.multiply(h,m,o),mat4.translate(o,p),c.uniformMatrix4fv(t,!1,o),c.drawArrays(GL_TRIANGLES,0,n.numVertices)}function q(e){c.useProgram(e);var t=c.getAttribLocation(e,"aVertex");do t===-1&&__error("assertion failed: aVertex !== -1 = "+(t!==-1),"src/main.js",401);while(!1);c.bindBuffer(GL_ARRAY_BUFFER,f),c.vertexAttribPointer(t,2,GL_FLOAT,!1,0,0),c.enableVertexAttribArray(t),c.drawArrays(GL_LINE_LOOP,0,4)}var e,t,n,r,i,s,o,u,a,f,l=document.getElementsByTagName("canvas")[0],c=GLT.createContext(l),h=mat4.perspective(60,4/3,.1,1e3),p=vec3.create(),d=vec3.create(),v=vec3.create([0,1,0]),m=mat4.identity(),g=mat4.create(),y=null,b=null,w=[vec3.create([0,0,0]),vec3.create([1,0,0]),vec3.create([0,1,0]),vec3.create([0,0,1]),vec3.create([0,0,-1]),vec3.create([0,-1,0]),vec3.create([-1,0,0])],E=[[0,0,0,0],[2,3,4,5],[0,0,0,0],[2,6,1,5],[2,1,6,5],[0,0,0,0],[2,4,3,5]],S=[],x=new Float32Array([-1,-1,1,-1,1,1,-1,1]),T=!1,N=null,C=!1,k=null,L={x:0,y:0},D=function(){var e=vec3.create([1,0,0]),t=vec3.create([-1,0,0]),n=vec3.create([0,1,0]),r=vec3.create([0,-1,0]),i=vec3.create([0,0,1]),s=vec3.create([0,0,-1]),o=[e,t,n,r,i,s],u=vec3.create(),a=vec3.create();return function(e,t){vec3.subtract(e,t,u),console.log("Pos",e,"dir",t),vec3.normalize(u);var n=99999,r=-1;for(var i=0;i!==6;i++){var s=o[i];vec3.subtract(u,s,a);var f=vec3.length(a);n>f&&(n=f,r=i)}return o[[1,0,3,2,5,4][r]]}}();GLT.loadmanager.loadFiles({files:["cube.obj","sphere.obj","diffuse.shader","id.shader","cube.png","skybox3.obj","skybox.png","border.shader","map1.json"],error:function(e,t){console.error("ERROR (src/main.js:414)",e,t)},finished:function(o){e=o["cube.obj"],n=o["skybox3.obj"],t=o["sphere.obj"],r=GLT.shader.compileProgram(c,o["diffuse.shader"]),s=GLT.shader.compileProgram(c,o["id.shader"]),i=GLT.shader.compileProgram(c,o["border.shader"]),y=A(o["cube.png"]),b=A(o["skybox.png"]);var u=o["map1.json"],a=new Id.Generator;for(var f=0;f!=u.cubes.length;f++){var l=u.cubes[f];S.push(new Cube({x:l[0],y:l[1],z:l[2]},a.next()))}d[0]=8,d[1]=8,d[2]=8,vec3.set(d,p),p[0]+=2,M(),O(),GLT.requestGameFrame(_)}}),console.log("DEBUG. Build:","Sep  1 2012","14:13:44")}();